// @bun
var a7=Object.create;var{defineProperty:P1,getPrototypeOf:e7,getOwnPropertyNames:JX}=Object;var zX=Object.prototype.hasOwnProperty;var C$=($,X,Z)=>{for(let Q of JX(X))if(!zX.call($,Q)&&Q!=="default")P1($,Q,{get:()=>X[Q],enumerable:!0});if(Z){for(let Q of JX(X))if(!zX.call(Z,Q)&&Q!=="default")P1(Z,Q,{get:()=>X[Q],enumerable:!0});return Z}},G$=($,X,Z)=>{Z=$!=null?a7(e7($)):{};const Q=X||!$||!$.__esModule?P1(Z,"default",{value:$,enumerable:!0}):Z;for(let W of JX($))if(!zX.call(Q,W))P1(Q,W,{get:()=>$[W],enumerable:!0});return Q};var f8=($,X)=>()=>(X||$((X={exports:{}}).exports,X),X.exports);var y8=($,X)=>{for(var Z in X)P1($,Z,{get:X[Z],enumerable:!0,configurable:!0,set:(Q)=>X[Z]=()=>Q})};var $Q=f8((xG,BX)=>{var _1=function(){},XY=function($,X,Z){this.fn=$,this.context=X,this.once=Z||!1},eZ=function($,X,Z,Q,W){if(typeof Z!=="function")throw new TypeError("The listener must be a function");var Y=new XY(Z,Q||$,W),J=r0?r0+X:X;if(!$._events[J])$._events[J]=Y,$._eventsCount++;else if(!$._events[J].fn)$._events[J].push(Y);else $._events[J]=[$._events[J],Y];return $},H6=function($,X){if(--$._eventsCount===0)$._events=new _1;else delete $._events[X]},l0=function(){this._events=new _1,this._eventsCount=0},$Y=Object.prototype.hasOwnProperty,r0="~";if(Object.create){if(_1.prototype=Object.create(null),!new _1().__proto__)r0=!1}l0.prototype.eventNames=function $(){var X=[],Z,Q;if(this._eventsCount===0)return X;for(Q in Z=this._events)if($Y.call(Z,Q))X.push(r0?Q.slice(1):Q);if(Object.getOwnPropertySymbols)return X.concat(Object.getOwnPropertySymbols(Z));return X};l0.prototype.listeners=function $(X){var Z=r0?r0+X:X,Q=this._events[Z];if(!Q)return[];if(Q.fn)return[Q.fn];for(var W=0,Y=Q.length,J=new Array(Y);W<Y;W++)J[W]=Q[W].fn;return J};l0.prototype.listenerCount=function $(X){var Z=r0?r0+X:X,Q=this._events[Z];if(!Q)return 0;if(Q.fn)return 1;return Q.length};l0.prototype.emit=function $(X,Z,Q,W,Y,J){var z=r0?r0+X:X;if(!this._events[z])return!1;var B=this._events[z],M=arguments.length,q,U;if(B.fn){if(B.once)this.removeListener(X,B.fn,void 0,!0);switch(M){case 1:return B.fn.call(B.context),!0;case 2:return B.fn.call(B.context,Z),!0;case 3:return B.fn.call(B.context,Z,Q),!0;case 4:return B.fn.call(B.context,Z,Q,W),!0;case 5:return B.fn.call(B.context,Z,Q,W,Y),!0;case 6:return B.fn.call(B.context,Z,Q,W,Y,J),!0}for(U=1,q=new Array(M-1);U<M;U++)q[U-1]=arguments[U];B.fn.apply(B.context,q)}else{var O=B.length,_;for(U=0;U<O;U++){if(B[U].once)this.removeListener(X,B[U].fn,void 0,!0);switch(M){case 1:B[U].fn.call(B[U].context);break;case 2:B[U].fn.call(B[U].context,Z);break;case 3:B[U].fn.call(B[U].context,Z,Q);break;case 4:B[U].fn.call(B[U].context,Z,Q,W);break;default:if(!q)for(_=1,q=new Array(M-1);_<M;_++)q[_-1]=arguments[_];B[U].fn.apply(B[U].context,q)}}}return!0};l0.prototype.on=function $(X,Z,Q){return eZ(this,X,Z,Q,!1)};l0.prototype.once=function $(X,Z,Q){return eZ(this,X,Z,Q,!0)};l0.prototype.removeListener=function $(X,Z,Q,W){var Y=r0?r0+X:X;if(!this._events[Y])return this;if(!Z)return H6(this,Y),this;var J=this._events[Y];if(J.fn){if(J.fn===Z&&(!W||J.once)&&(!Q||J.context===Q))H6(this,Y)}else{for(var z=0,B=[],M=J.length;z<M;z++)if(J[z].fn!==Z||W&&!J[z].once||Q&&J[z].context!==Q)B.push(J[z]);if(B.length)this._events[Y]=B.length===1?B[0]:B;else H6(this,Y)}return this};l0.prototype.removeAllListeners=function $(X){var Z;if(X){if(Z=r0?r0+X:X,this._events[Z])H6(this,Z)}else this._events=new _1,this._eventsCount=0;return this};l0.prototype.off=l0.prototype.removeListener;l0.prototype.addListener=l0.prototype.on;l0.prefixed=r0;l0.EventEmitter=l0;if(typeof BX!=="undefined")BX.exports=l0});var y6=f8((GE,_W)=>{var $U=function($){var X=$.indexOf("%");if(X===-1)return $;var Z=$.length,Q="",W=0,Y=0,J=X,z=LW;while(X>-1&&X<Z){var B=PW($[X+1],4),M=PW($[X+2],0),q=B|M,U=IZ[q];if(z=IZ[256+z+U],Y=Y<<6|q&IZ[364+U],z===LW)Q+=$.slice(W,J),Q+=Y<=65535?String.fromCharCode(Y):String.fromCharCode(55232+(Y>>10),56320+(Y&1023)),Y=0,W=X+3,X=J=$.indexOf("%",W);else if(z===eM)return null;else{if(X+=3,X<Z&&$.charCodeAt(X)===37)continue;return null}}return Q+$.slice(W)},PW=function($,X){var Z=XU[$];return Z===void 0?255:Z<<X},LW=12,eM=0,IZ=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7],XU={"0":0,"1":1,"2":2,"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};_W.exports=$U});var RW=f8((wE,jW)=>{var ZU=function($){const X=new KW;if(typeof $!=="string")return X;let Z=$.length,Q="",W="",Y=-1,J=-1,z=!1,B=!1,M=!1,q=!1,U=!1,O=0;for(let _=0;_<Z+1;_++)if(O=_!==Z?$.charCodeAt(_):38,O===38){if(U=J>Y,!U)J=_;if(Q=$.slice(Y+1,J),U||Q.length>0){if(M)Q=Q.replace(SW," ");if(z)Q=FW(Q)||Q;if(U){if(W=$.slice(J+1,_),q)W=W.replace(SW," ");if(B)W=FW(W)||W}const I=X[Q];if(I===void 0)X[Q]=W;else if(I.pop)I.push(W);else X[Q]=[I,W]}W="",Y=_,J=_,z=!1,B=!1,M=!1,q=!1}else if(O===61)if(J<=Y)J=_;else B=!0;else if(O===43)if(J>Y)q=!0;else M=!0;else if(O===37)if(J>Y)B=!0;else z=!0;return X},FW=y6(),SW=/\+/g,KW=function(){};KW.prototype=Object.create(null);jW.exports=ZU});var bW=f8((DE,CW)=>{var WU=function($){const X=$.length;if(X===0)return"";let Z="",Q=0,W=0;$:for(;W<X;W++){let Y=$.charCodeAt(W);while(Y<128){if(QU[Y]!==1){if(Q<W)Z+=$.slice(Q,W);Q=W+1,Z+=Q$[Y]}if(++W===X)break $;Y=$.charCodeAt(W)}if(Q<W)Z+=$.slice(Q,W);if(Y<2048){Q=W+1,Z+=Q$[192|Y>>6]+Q$[128|Y&63];continue}if(Y<55296||Y>=57344){Q=W+1,Z+=Q$[224|Y>>12]+Q$[128|Y>>6&63]+Q$[128|Y&63];continue}if(++W,W>=X)throw new Error("URI malformed");const J=$.charCodeAt(W)&1023;Q=W+1,Y=65536+((Y&1023)<<10|J),Z+=Q$[240|Y>>18]+Q$[128|Y>>12&63]+Q$[128|Y>>6&63]+Q$[128|Y&63]}if(Q===0)return $;if(Q<X)return Z+$.slice(Q);return Z},Q$=Array.from({length:256},($,X)=>"%"+((X<16?"0":"")+X.toString(16)).toUpperCase()),QU=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);CW.exports={encodeString:WU}});var IW=f8((AE,EW)=>{var VW=function($){const X=typeof $;if(X==="string")return xZ($);else if(X==="bigint")return $.toString();else if(X==="boolean")return $?"true":"false";else if(X==="number"&&Number.isFinite($))return $<1000000000000000000000?""+$:xZ(""+$);return""},YU=function($){let X="";if($===null||typeof $!=="object")return X;const Z="&",Q=Object.keys($),W=Q.length;let Y=0;for(let J=0;J<W;J++){const z=Q[J],B=$[z],M=xZ(z)+"=";if(J)X+=Z;if(Array.isArray(B)){Y=B.length;for(let q=0;q<Y;q++){if(q)X+=Z;X+=M,X+=VW(B[q])}}else X+=M,X+=VW(B)}return X},{encodeString:xZ}=bW();EW.exports=YU});var kZ=f8((HE,M6)=>{var xW=RW(),kW=IW(),TW={parse:xW,stringify:kW};M6.exports=TW;M6.exports.default=TW;M6.exports.parse=xW;M6.exports.stringify=kW});var O1=f8((vE,a6)=>{var iZ=function($,X){const Z=$.charCodeAt(X);return Z>=65&&Z<=90},S7=function($){if(!ZG.test($))return $;const X=$.length;let Z=0,Q=0,W="",Y=!0,J=iZ($,0),z;for(;Q<X;Q++){if(z=iZ($,Q+1),!Y&&J&&!z)W+=$.slice(Z,Q)+"-"+$[Q].toLowerCase(),Z=Q+1;Y=J,J=z}return W+=$.slice(Z,Q),W},_7=function($,...X){const Z=$.length,Q=X.length;let W=0,Y="";for(;W<Z;W++)if(Y+=$[W],W<Q)Y+=X[W];return s6(Y)},K7=function($){return $==="meta"||$==="link"||$==="img"||$==="br"||$==="input"||$==="hr"||$==="area"||$==="base"||$==="col"||$==="command"||$==="embed"||$==="keygen"||$==="param"||$==="source"||$==="track"||$==="wbr"},j7=function($){if(typeof $==="string"){let M=$.indexOf('"');if(M===-1)return $;const q=$.length;let U="",O=0;for(;M<q;M++)if($[M]==='"')U+=$.slice(O,M)+"&#34;",O=M+1;return U+=$.slice(O,M),U}const X=Object.keys($),Z=X.length;let Q,W,Y,J,z=0,B="";for(;z<Z;z++){if(Q=X[z],W=$[Q],W===null||W===void 0)continue;if(B+=S7(Q)+":",typeof W!=="string"){B+=W.toString()+";";continue}if(Y=W.indexOf('"'),Y===-1){B+=W+";";continue}const M=W.length;J=0;for(;Y<M;Y++)if(W[Y]==='"')B+=W.slice(J,Y)+"&#34;",J=Y+1;B+=W.slice(J,Y)+";"}return B},oZ=function($){const X=Object.keys($),Z=X.length;let Q,W,Y,J,z,B,M,q="",U=0;for(;U<Z;U++){if(Q=X[U],Q==="children"||Q==="safe")continue;if(W=$[Q],Q==="className"){if($.class!==void 0)continue;Q="class"}else if(Q==="class"&&Array.isArray(W)){B=W,M=W.length,W="";for(let O=0;O<M;O++)if(B[O]&&B[O].length>0)if(W)W+=" "+B[O].trim();else W+=B[O].trim();if(W.length===0)continue}else if(Q==="style"){q+=' style="'+j7(W)+'"';continue}else if(Q==="attrs"){if(typeof W==="string")q+=" "+W;else q+=oZ(W);continue}if(Y=typeof W,Y==="boolean"){if(W)q+=" "+Q;continue}if(W===null||W===void 0)continue;if(q+=" "+Q,Y!=="string"){if(Y!=="object"){q+='="'+W.toString()+'"';continue}if(W instanceof Date){q+='="'+W.toISOString()+'"';continue}W=W.toString()}if(J=W.indexOf('"'),J===-1){q+='="'+W+'"';continue}q+='="',M=W.length,z=0;for(;J<M;J++)if(W[J]==='"')q+=W.slice(z,J)+"&#34;",z=J+1;q+=W.slice(z,J)+'"'}return q},lZ=function($,X){let Z=$.length,Q="",W,Y=0;for(;Y<Z;Y++){if(W=$[Y],typeof W!=="string"){if(!W&&W!==0)continue;if(W.then)return Promise.all($.slice(Y)).then(function J(z){return z.unshift(Q),lZ(z,X)});if(Array.isArray(W)){$.splice(Y--,1,...W),Z+=W.length-1;continue}}Q+=W}if(X===!0)return s6(Q);return Q},F7=function($,X,...Z){const Q=X!==null;if(typeof $==="function"){if(!Q)X={children:Z.length>1?Z:Z[0]};else if(X.children===void 0)X.children=Z.length>1?Z:Z[0];return $(X)}if(Q&&$==="tag")$=String(X.of),delete X.of;const W=Q?oZ(X):"";if(Z.length===0&&K7($))return"<"+$+W+"/>";const Y=lZ(Z,Q&&X.safe);if(typeof Y==="string")return"<"+$+W+">"+Y+"</"+$+">";return Y.then(function J(z){return"<"+$+W+">"+z+"</"+$+">"})},QG=function($){return r6.contentsToString([$.children])},WG=function($,X=!0,Z="/*\0*/"){if(typeof $!=="function")throw new Error("The first argument must be a function.");const Q=new Set,W=$(new Proxy({},{get(q,U){Q.add(U);const O=U==="children";let _=`args[${Z}\`${U.toString()}\`${Z}]`;if(O)_=`Array.isArray(${_}) ? ${_}.join(${Z}\`\`${Z}) : ${_}`;return`\`${Z} + (${_} || ${X&&!O?`throwPropertyNotFound(${Z}\`${U.toString()}\`${Z})`:`${Z}\`\`${Z}`}) + ${Z}\``}}));if(typeof W!=="string")throw new Error("You cannot use compile() with async components.");const Y=Z.length,J=W.length;let z="",B=0,M=0;for(;M<J;M++)if(W[M]==="`"&&W.slice(M-Y,M)!==Z&&W.slice(M+1,M+Y+1)!==Z){z+=W.slice(B,M)+"\\`",B=M+1;continue}if(z+=W.slice(B),X)return Function("args",'if (args === undefined) { throw new Error("The arguments object was not provided.") };\nfunction throwPropertyNotFound(name) { throw new Error("Property " + name + " was not provided.") };\n'+`return \`${z}\``);return Function("args","if (args === undefined) { args = Object.create(null) };\n"+`return \`${z}\``)},XG=/[<"'&]/,ZG=/[a-z][A-Z]/,s6=function($){if(typeof $!=="string")$=$.toString();if(!XG.test($))return $;const X=$.length;let Z="",Q=0,W=0;for(;W<X;W++)switch($[W]){case"&":Z+=$.slice(Q,W)+"&amp;",Q=W+1;continue;case"<":Z+=$.slice(Q,W)+"&lt;",Q=W+1;continue;case'"':Z+=$.slice(Q,W)+"&#34;",Q=W+1;continue;case"'":Z+=$.slice(Q,W)+"&#39;",Q=W+1;continue}return Z+=$.slice(Q,W),Z};if(typeof Bun!=="undefined")s6=Bun.escapeHTML;var r6={escape:_7,e:_7,escapeHtml:s6,isVoidElement:K7,attributesToString:oZ,toKebabCase:S7,isUpper:iZ,styleToString:j7,createElement:F7,h:F7,contentsToString:lZ,compile:WG,Fragment:QG};a6.exports=r6;a6.exports.Html=r6;a6.exports.default=r6});var k7=f8(()=>{var a$;try{a$=Function("return this")()}catch($){a$=window}if(!a$.Html)a$.Html=O1();if(a$.Html.default)a$.Html=a$.Html.default});var f7=f8((WI,XX)=>{var OG=function(){function $(q,U){return U!=null&&q instanceof U}var X;try{X=Map}catch(q){X=function(){}}var Z;try{Z=Set}catch(q){Z=function(){}}var Q;try{Q=Promise}catch(q){Q=function(){}}function W(q,U,O,_,I){if(typeof U==="object")O=U.depth,_=U.prototype,I=U.includeNonEnumerable,U=U.circular;var b=[],D=[],F=typeof Buffer!="undefined";if(typeof U=="undefined")U=!0;if(typeof O=="undefined")O=Infinity;function j(P,f){if(P===null)return null;if(f===0)return P;var x,q0;if(typeof P!="object")return P;if($(P,X))x=new X;else if($(P,Z))x=new Z;else if($(P,Q))x=new Q(function(P8,G0){P.then(function($8){P8(j($8,f-1))},function($8){G0(j($8,f-1))})});else if(W.__isArray(P))x=[];else if(W.__isRegExp(P)){if(x=new RegExp(P.source,M(P)),P.lastIndex)x.lastIndex=P.lastIndex}else if(W.__isDate(P))x=new Date(P.getTime());else if(F&&Buffer.isBuffer(P)){if(Buffer.allocUnsafe)x=Buffer.allocUnsafe(P.length);else x=new Buffer(P.length);return P.copy(x),x}else if($(P,Error))x=Object.create(P);else if(typeof _=="undefined")q0=Object.getPrototypeOf(P),x=Object.create(q0);else x=Object.create(_),q0=_;if(U){var _0=b.indexOf(P);if(_0!=-1)return D[_0];b.push(P),D.push(x)}if($(P,X))P.forEach(function(P8,G0){var $8=j(G0,f-1),T8=j(P8,f-1);x.set($8,T8)});if($(P,Z))P.forEach(function(P8){var G0=j(P8,f-1);x.add(G0)});for(var M0 in P){var U0;if(q0)U0=Object.getOwnPropertyDescriptor(q0,M0);if(U0&&U0.set==null)continue;x[M0]=j(P[M0],f-1)}if(Object.getOwnPropertySymbols){var $0=Object.getOwnPropertySymbols(P);for(var M0=0;M0<$0.length;M0++){var m=$0[M0],k0=Object.getOwnPropertyDescriptor(P,m);if(k0&&!k0.enumerable&&!I)continue;if(x[m]=j(P[m],f-1),!k0.enumerable)Object.defineProperty(x,m,{enumerable:!1})}}if(I){var M$=Object.getOwnPropertyNames(P);for(var M0=0;M0<M$.length;M0++){var k8=M$[M0],k0=Object.getOwnPropertyDescriptor(P,k8);if(k0&&k0.enumerable)continue;x[k8]=j(P[k8],f-1),Object.defineProperty(x,k8,{enumerable:!1})}}return x}return j(q,O)}W.clonePrototype=function q(U){if(U===null)return null;var O=function(){};return O.prototype=U,new O};function Y(q){return Object.prototype.toString.call(q)}W.__objToStr=Y;function J(q){return typeof q==="object"&&Y(q)==="[object Date]"}W.__isDate=J;function z(q){return typeof q==="object"&&Y(q)==="[object Array]"}W.__isArray=z;function B(q){return typeof q==="object"&&Y(q)==="[object RegExp]"}W.__isRegExp=B;function M(q){var U="";if(q.global)U+="g";if(q.ignoreCase)U+="i";if(q.multiline)U+="m";return U}return W.__getRegExpFlags=M,W}();if(typeof XX==="object"&&WI)XX.exports=OG});var v7=f8((y7,d7)=>{(function(){var $,X,Z,Q=[].splice,W=function(J,z){if(!(J instanceof z))throw new Error("Bound instance method accessed before binding")},Y=[].indexOf;Z=f7(),$=import.meta.require("events").EventEmitter,d7.exports=X=function(){class J extends ${constructor(z={}){super();if(this.get=this.get.bind(this),this.mget=this.mget.bind(this),this.set=this.set.bind(this),this.mset=this.mset.bind(this),this.del=this.del.bind(this),this.take=this.take.bind(this),this.ttl=this.ttl.bind(this),this.getTtl=this.getTtl.bind(this),this.keys=this.keys.bind(this),this.has=this.has.bind(this),this.getStats=this.getStats.bind(this),this.flushAll=this.flushAll.bind(this),this.flushStats=this.flushStats.bind(this),this.close=this.close.bind(this),this._checkData=this._checkData.bind(this),this._check=this._check.bind(this),this._isInvalidKey=this._isInvalidKey.bind(this),this._wrap=this._wrap.bind(this),this._getValLength=this._getValLength.bind(this),this._error=this._error.bind(this),this._initErrors=this._initErrors.bind(this),this.options=z,this._initErrors(),this.data={},this.options=Object.assign({forceString:!1,objectValueSize:80,promiseValueSize:80,arrayValueSize:40,stdTTL:0,checkperiod:600,useClones:!0,deleteOnExpire:!0,enableLegacyCallbacks:!1,maxKeys:-1},this.options),this.options.enableLegacyCallbacks)console.warn("WARNING! node-cache legacy callback support will drop in v6.x"),["get","mget","set","del","ttl","getTtl","keys","has"].forEach((B)=>{var M=this[B];this[B]=function(...q){var U,O,_,I;if(_=q,[...q]=_,[U]=Q.call(q,-1),typeof U==="function")try{I=M(...q),U(null,I)}catch(b){O=b,U(O)}else return M(...q,U)}});this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this.validKeyTypes=["string","number"],this._checkData();return}get(z){var B,M;if(W(this,J),(M=this._isInvalidKey(z))!=null)throw M;if(this.data[z]!=null&&this._check(z,this.data[z]))return this.stats.hits++,B=this._unwrap(this.data[z]),B;else{this.stats.misses++;return}}mget(z){var B,M,q,U,O,_;if(W(this,J),!Array.isArray(z))throw B=this._error("EKEYSTYPE"),B;_={};for(q=0,O=z.length;q<O;q++){if(U=z[q],(M=this._isInvalidKey(U))!=null)throw M;if(this.data[U]!=null&&this._check(U,this.data[U]))this.stats.hits++,_[U]=this._unwrap(this.data[U]);else this.stats.misses++}return _}set(z,B,M){var q,U,O;if(W(this,J),this.options.maxKeys>-1&&this.stats.keys>=this.options.maxKeys)throw q=this._error("ECACHEFULL"),q;if(this.options.forceString&&!1==="string")B=JSON.stringify(B);if(M==null)M=this.options.stdTTL;if((U=this._isInvalidKey(z))!=null)throw U;if(O=!1,this.data[z])O=!0,this.stats.vsize-=this._getValLength(this._unwrap(this.data[z],!1));if(this.data[z]=this._wrap(B,M),this.stats.vsize+=this._getValLength(B),!O)this.stats.ksize+=this._getKeyLength(z),this.stats.keys++;return this.emit("set",z,B),!0}mset(z){var B,M,q,U,O,_,I,b,D,F;if(W(this,J),this.options.maxKeys>-1&&this.stats.keys+z.length>=this.options.maxKeys)throw B=this._error("ECACHEFULL"),B;for(q=0,I=z.length;q<I;q++){if(_=z[q],{key:O,val:F,ttl:D}=_,D&&typeof D!=="number")throw B=this._error("ETTLTYPE"),B;if((M=this._isInvalidKey(O))!=null)throw M}for(U=0,b=z.length;U<b;U++)_=z[U],{key:O,val:F,ttl:D}=_,this.set(O,F,D);return!0}del(z){var B,M,q,U,O,_;if(W(this,J),!Array.isArray(z))z=[z];B=0;for(q=0,O=z.length;q<O;q++){if(U=z[q],(M=this._isInvalidKey(U))!=null)throw M;if(this.data[U]!=null)this.stats.vsize-=this._getValLength(this._unwrap(this.data[U],!1)),this.stats.ksize-=this._getKeyLength(U),this.stats.keys--,B++,_=this.data[U],delete this.data[U],this.emit("del",U,_.v)}return B}take(z){var B;if(W(this,J),B=this.get(z),B!=null)this.del(z);return B}ttl(z,B){var M;if(W(this,J),B||(B=this.options.stdTTL),!z)return!1;if((M=this._isInvalidKey(z))!=null)throw M;if(this.data[z]!=null&&this._check(z,this.data[z])){if(B>=0)this.data[z]=this._wrap(this.data[z].v,B,!1);else this.del(z);return!0}else return!1}getTtl(z){var B,M;if(W(this,J),!z)return;if((M=this._isInvalidKey(z))!=null)throw M;if(this.data[z]!=null&&this._check(z,this.data[z]))return B=this.data[z].t,B;else return}keys(){var z;return W(this,J),z=Object.keys(this.data),z}has(z){var B;return W(this,J),B=this.data[z]!=null&&this._check(z,this.data[z]),B}getStats(){return W(this,J),this.stats}flushAll(z=!0){W(this,J),this.data={},this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this._killCheckPeriod(),this._checkData(z),this.emit("flush")}flushStats(){W(this,J),this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this.emit("flush_stats")}close(){W(this,J),this._killCheckPeriod()}_checkData(z=!0){var B,M,q;W(this,J),M=this.data;for(B in M)q=M[B],this._check(B,q);if(z&&this.options.checkperiod>0){if(this.checkTimeout=setTimeout(this._checkData,this.options.checkperiod*1000,z),this.checkTimeout!=null&&this.checkTimeout.unref!=null)this.checkTimeout.unref()}}_killCheckPeriod(){if(this.checkTimeout!=null)return clearTimeout(this.checkTimeout)}_check(z,B){var M;if(W(this,J),M=!0,B.t!==0&&B.t<Date.now()){if(this.options.deleteOnExpire)M=!1,this.del(z);this.emit("expired",z,this._unwrap(B))}return M}_isInvalidKey(z){var B;if(W(this,J),B=typeof z,Y.call(this.validKeyTypes,B)<0)return this._error("EKEYTYPE",{type:typeof z})}_wrap(z,B,M=!0){var q,U,O,_;if(W(this,J),!this.options.useClones)M=!1;if(U=Date.now(),q=0,_=1000,B===0)q=0;else if(B)q=U+B*_;else if(this.options.stdTTL===0)q=this.options.stdTTL;else q=U+this.options.stdTTL*_;return O={t:q,v:M?Z(z):z}}_unwrap(z,B=!0){if(!this.options.useClones)B=!1;if(z.v!=null)if(B)return Z(z.v);else return z.v;return null}_getKeyLength(z){return z.toString().length}_getValLength(z){if(W(this,J),typeof z==="string")return z.length;else if(this.options.forceString)return JSON.stringify(z).length;else if(Array.isArray(z))return this.options.arrayValueSize*z.length;else if(typeof z==="number")return 8;else if(typeof(z!=null?z.then:void 0)==="function")return this.options.promiseValueSize;else if(typeof Buffer!=="undefined"&&Buffer!==null?Buffer.isBuffer(z):void 0)return z.length;else if(z!=null&&typeof z==="object")return this.options.objectValueSize*Object.keys(z).length;else if(typeof z==="boolean")return 8;else return 0}_error(z,B={}){var M;return W(this,J),M=new Error,M.name=z,M.errorcode=z,M.message=this.ERRORS[z]!=null?this.ERRORS[z](B):"-",M.data=B,M}_initErrors(){var z,B,M;W(this,J),this.ERRORS={},M=this._ERRORS;for(B in M)z=M[B],this.ERRORS[B]=this.createErrorMessage(z)}createErrorMessage(z){return function(B){return z.replace("__key",B.type)}}}return J.prototype._ERRORS={ENOTFOUND:"Key `__key` not found",ECACHEFULL:"Cache max keys amount exceeded",EKEYTYPE:"The key argument has to be of type `string` or `number`. Found: `__key`",EKEYSTYPE:"The keys argument has to be an array.",ETTLTYPE:"The ttl argument has to be a number."},J}.call(this)}).call(y7)});var h7=f8((p7,m7)=>{(function(){var $=m7.exports=v7();$.version="5.1.2"}).call(p7)});var XQ=G$($Q(),1);var ZQ=XQ.default;function N6($){return h0($)&&Symbol.asyncIterator in $}function O6($){return h0($)&&Symbol.iterator in $}function A0($){return h0($)&&!d($)&&F1($.constructor)&&$.constructor.name==="Object"}function L6($){return $ instanceof Promise}function B8($){return $ instanceof Date&&Number.isFinite($.getTime())}function F8($){return ArrayBuffer.isView($)}function $1($){return $ instanceof globalThis.Uint8Array}function u($,X){return X in $}function h0($){return $!==null&&typeof $==="object"}function d($){return Array.isArray($)&&!ArrayBuffer.isView($)}function F0($){return $===void 0}function w$($){return $===null}function l8($){return typeof $==="boolean"}function T($){return typeof $==="number"}function P6($){return T($)&&Number.isInteger($)}function u0($){return typeof $==="bigint"}function h($){return typeof $==="string"}function F1($){return typeof $==="function"}function Z8($){return typeof $==="symbol"}function q8($){return u0($)||l8($)||w$($)||T($)||h($)||Z8($)||F0($)}var V0;(function($){$.ExactOptionalPropertyTypes=!1,$.AllowArrayObject=!1,$.AllowNaN=!1,$.AllowNullVoid=!1;function X(J,z){return $.ExactOptionalPropertyTypes?z in J:J[z]!==void 0}$.IsExactOptionalProperty=X;function Z(J){const z=h0(J);return $.AllowArrayObject?z:z&&!d(J)}$.IsObjectLike=Z;function Q(J){return Z(J)&&!(J instanceof Date)&&!(J instanceof Uint8Array)}$.IsRecordLike=Q;function W(J){const z=T(J);return $.AllowNaN?z:z&&Number.isFinite(J)}$.IsNumberLike=W;function Y(J){const z=F0(J);return $.AllowNullVoid?z||J===null:z}$.IsVoidLike=Y})(V0||(V0={}));var R0={};y8(R0,{Set:()=>{{return JY}},Has:()=>{{return YY}},Get:()=>{{return zY}},Entries:()=>{{return ZY}},Delete:()=>{{return WY}},Clear:()=>{{return QY}}});function ZY(){return new Map(X1)}function QY(){return X1.clear()}function WY($){return X1.delete($)}function YY($){return X1.has($)}function JY($,X){X1.set($,X)}function zY($){return X1.get($)}var X1=new Map;var E0={};y8(E0,{Set:()=>{{return GY}},Has:()=>{{return UY}},Get:()=>{{return wY}},Entries:()=>{{return BY}},Delete:()=>{{return MY}},Clear:()=>{{return qY}}});function BY(){return new Map(Z1)}function qY(){return Z1.clear()}function MY($){return Z1.delete($)}function UY($){return Z1.has($)}function GY($,X){Z1.set($,X)}function wY($){return Z1.get($)}var Z1=new Map;var I0=Symbol.for("TypeBox.Transform"),n8=Symbol.for("TypeBox.Readonly"),n0=Symbol.for("TypeBox.Optional"),M8=Symbol.for("TypeBox.Hint"),H=Symbol.for("TypeBox.Kind");function S1($={}){return{...$,[H]:$[H]??"Unsafe"}}class v extends Error{constructor($){super($)}}class qX extends v{constructor($){super(`Duplicate type kind '${$}' detected`)}}class MX extends v{constructor($){super(`Duplicate string format '${$}' detected`)}}var t8;(function($){function X(Q,W){if(E0.Has(Q))throw new qX(Q);return E0.Set(Q,W),(Y={})=>S1({...Y,[H]:Q})}$.Type=X;function Z(Q,W){if(R0.Has(Q))throw new MX(Q);return R0.Set(Q,W),Q}$.Format=Z})(t8||(t8={}));function n($){return{[H]:"MappedResult",properties:$}}var W8={};y8(W8,{IsUndefined:()=>{{return S0}},IsUint8Array:()=>{{return T$}},IsSymbol:()=>{{return HX}},IsString:()=>{{return N0}},IsRegExp:()=>{{return AX}},IsObject:()=>{{return H0}},IsNumber:()=>{{return d8}},IsNull:()=>{{return DX}},IsIterator:()=>{{return wX}},IsFunction:()=>{{return GX}},IsDate:()=>{{return j1}},IsBoolean:()=>{{return b$}},IsBigInt:()=>{{return K1}},IsAsyncIterator:()=>{{return UX}},IsArray:()=>{{return Q8}}});function UX($){return H0($)&&!Q8($)&&!T$($)&&Symbol.asyncIterator in $}function Q8($){return Array.isArray($)}function K1($){return typeof $==="bigint"}function b$($){return typeof $==="boolean"}function j1($){return $ instanceof globalThis.Date}function GX($){return typeof $==="function"}function wX($){return H0($)&&!Q8($)&&!T$($)&&Symbol.iterator in $}function DX($){return $===null}function d8($){return typeof $==="number"}function H0($){return typeof $==="object"&&$!==null}function AX($){return $ instanceof globalThis.RegExp}function N0($){return typeof $==="string"}function HX($){return typeof $==="symbol"}function T$($){return $ instanceof globalThis.Uint8Array}function S0($){return $===void 0}var DY=function($){return $.map((X)=>_6(X))},AY=function($){return new Date($.getTime())},HY=function($){return new Uint8Array($)},NY=function($){return new RegExp($.source,$.flags)},OY=function($){const X={};for(let Z of Object.getOwnPropertyNames($))X[Z]=_6($[Z]);for(let Z of Object.getOwnPropertySymbols($))X[Z]=_6($[Z]);return X},_6=function($){return Q8($)?DY($):j1($)?AY($):T$($)?HY($):AX($)?NY($):H0($)?OY($):$};function QQ($){return _6($)}function C0($){return $.map((X)=>S(X))}function S($,X={}){return{...QQ($),...X}}var LY=function($,X){const{[X]:Z,...Q}=$;return Q};function b0($,X){return X.reduce((Z,Q)=>LY(Z,Q),$)}function R1($,X={}){return{...X,[H]:"Array",type:"array",items:S($)}}function C1($,X={}){return{...X,[H]:"AsyncIterator",type:"AsyncIterator",items:S($)}}function b1($,X,Z){return{...Z,[H]:"Constructor",type:"Constructor",parameters:C0($),returns:S(X)}}function D$($,X,Z){return{...Z,[H]:"Function",type:"Function",parameters:C0($),returns:S(X)}}function Q0($={}){return{...$,[H]:"Never",not:{}}}function WQ($){return H0($)&&$[n8]==="Readonly"}function s8($){return H0($)&&$[n0]==="Optional"}function PY($){return t($,"Any")}function A$($){return t($,"Array")}function V1($){return t($,"AsyncIterator")}function NX($){return t($,"BigInt")}function OX($){return t($,"Boolean")}function E1($){return t($,"Constructor")}function _Y($){return t($,"Date")}function I1($){return t($,"Function")}function g$($){return t($,"Integer")}function x0($){return t($,"Intersect")}function x1($){return t($,"Iterator")}function t($,X){return H0($)&&H in $&&$[H]===X}function H$($){return t($,"Literal")}function U8($){return t($,"MappedKey")}function P0($){return t($,"MappedResult")}function Q1($){return t($,"Never")}function FY($){return t($,"Not")}function SY($){return t($,"Null")}function f$($){return t($,"Number")}function f0($){return t($,"Object")}function y$($){return t($,"Promise")}function LX($){return t($,"Record")}function PX($){return t($,"Ref")}function _X($){return t($,"RegExp")}function k1($){return t($,"String")}function KY($){return t($,"Symbol")}function G8($){return t($,"TemplateLiteral")}function jY($){return t($,"This")}function W1($){return H0($)&&I0 in $}function v8($){return t($,"Tuple")}function RY($){return t($,"Undefined")}function r($){return t($,"Union")}function CY($){return t($,"Uint8Array")}function bY($){return t($,"Unknown")}function VY($){return t($,"Unsafe")}function EY($){return t($,"Void")}function IY($){return H0($)&&H in $&&N0($[H])}function w8($){return PY($)||A$($)||OX($)||NX($)||V1($)||E1($)||_Y($)||I1($)||g$($)||x0($)||x1($)||H$($)||U8($)||P0($)||Q1($)||FY($)||SY($)||f$($)||f0($)||y$($)||LX($)||PX($)||_X($)||k1($)||KY($)||G8($)||jY($)||v8($)||RY($)||r($)||CY($)||bY($)||VY($)||EY($)||IY($)}var kY=function($){return b0(S($),[n0])},TY=function($){return{...S($),[n0]:"Optional"}},gY=function($,X){return X===!1?kY($):TY($)};function a0($,X){const Z=X??!0;return P0($)?YQ($,Z):gY($,Z)}var fY=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames($))Z[Q]=a0($[Q],X);return Z},yY=function($,X){return fY($.properties,X)};function YQ($,X){const Z=yY($,X);return n(Z)}function T1($,X){const Z=$.every((W)=>f0(W)),Q=w8(X.unevaluatedProperties)?{unevaluatedProperties:S(X.unevaluatedProperties)}:{};return X.unevaluatedProperties===!1||w8(X.unevaluatedProperties)||Z?{...X,...Q,[H]:"Intersect",type:"object",allOf:C0($)}:{...X,...Q,[H]:"Intersect",allOf:C0($)}}var dY=function($){return $.every((X)=>s8(X))},vY=function($){return b0($,[n0])},JQ=function($){return $.map((X)=>s8(X)?vY(X):X)},pY=function($,X){return dY($)?a0(T1(JQ($),X)):T1(JQ($),X)};function F6($,X={}){if($.length===0)return Q0(X);if($.length===1)return S($[0],X);if($.some((Z)=>W1(Z)))throw new Error("Cannot intersect transform types");return pY($,X)}function e0($,X={}){if($.length===0)return Q0(X);if($.length===1)return S($[0],X);if($.some((Z)=>W1(Z)))throw new Error("Cannot intersect transform types");return T1($,X)}function g1($,X){return{...X,[H]:"Union",anyOf:C0($)}}var mY=function($){return $.some((X)=>s8(X))},zQ=function($){return $.map((X)=>s8(X)?hY(X):X)},hY=function($){return b0($,[n0])},uY=function($,X){return mY($)?a0(g1(zQ($),X)):g1(zQ($),X)};function r8($,X={}){return $.length===0?Q0(X):$.length===1?S($[0],X):uY($,X)}function W0($,X={}){return $.length===0?Q0(X):$.length===1?S($[0],X):g1($,X)}var cY=function($){return $.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")},SX=function($,X,Z){return $[X]===Z&&$.charCodeAt(X-1)!==92},N$=function($,X){return SX($,X,"(")},f1=function($,X){return SX($,X,")")},BQ=function($,X){return SX($,X,"|")},iY=function($){if(!(N$($,0)&&f1($,$.length-1)))return!1;let X=0;for(let Z=0;Z<$.length;Z++){if(N$($,Z))X+=1;if(f1($,Z))X-=1;if(X===0&&Z!==$.length-1)return!1}return!0},oY=function($){return $.slice(1,$.length-1)},lY=function($){let X=0;for(let Z=0;Z<$.length;Z++){if(N$($,Z))X+=1;if(f1($,Z))X-=1;if(BQ($,Z)&&X===0)return!0}return!1},nY=function($){for(let X=0;X<$.length;X++)if(N$($,X))return!0;return!1},tY=function($){let[X,Z]=[0,0];const Q=[];for(let Y=0;Y<$.length;Y++){if(N$($,Y))X+=1;if(f1($,Y))X-=1;if(BQ($,Y)&&X===0){const J=$.slice(Z,Y);if(J.length>0)Q.push(Y1(J));Z=Y+1}}const W=$.slice(Z);if(W.length>0)Q.push(Y1(W));if(Q.length===0)return{type:"const",const:""};if(Q.length===1)return Q[0];return{type:"or",expr:Q}},sY=function($){function X(W,Y){if(!N$(W,Y))throw new FX("TemplateLiteralParser: Index must point to open parens");let J=0;for(let z=Y;z<W.length;z++){if(N$(W,z))J+=1;if(f1(W,z))J-=1;if(J===0)return[Y,z]}throw new FX("TemplateLiteralParser: Unclosed group parens in expression")}function Z(W,Y){for(let J=Y;J<W.length;J++)if(N$(W,J))return[Y,J];return[Y,W.length]}const Q=[];for(let W=0;W<$.length;W++)if(N$($,W)){const[Y,J]=X($,W),z=$.slice(Y,J+1);Q.push(Y1(z)),W=J}else{const[Y,J]=Z($,W),z=$.slice(Y,J);if(z.length>0)Q.push(Y1(z));W=J-1}return Q.length===0?{type:"const",const:""}:Q.length===1?Q[0]:{type:"and",expr:Q}};function Y1($){return iY($)?Y1(oY($)):lY($)?tY($):nY($)?sY($):{type:"const",const:cY($)}}function J1($){return Y1($.slice(1,$.length-1))}class FX extends v{}var rY=function($){return $.type==="or"&&$.expr.length===2&&$.expr[0].type==="const"&&$.expr[0].const==="0"&&$.expr[1].type==="const"&&$.expr[1].const==="[1-9][0-9]*"},aY=function($){return $.type==="or"&&$.expr.length===2&&$.expr[0].type==="const"&&$.expr[0].const==="true"&&$.expr[1].type==="const"&&$.expr[1].const==="false"},eY=function($){return $.type==="const"&&$.const===".*"};function d$($){return rY($)||eY($)?!1:aY($)?!0:$.type==="and"?$.expr.every((X)=>d$(X)):$.type==="or"?$.expr.every((X)=>d$(X)):$.type==="const"?!0:(()=>{throw new qQ("Unknown expression type")})()}function S6($){const X=J1($.pattern);return d$(X)}class qQ extends v{}function*UQ($){if($.length===1)return yield*$[0];for(let X of $[0])for(let Z of UQ($.slice(1)))yield`${X}${Z}`}function*$9($){return yield*UQ($.expr.map((X)=>[...y1(X)]))}function*X9($){for(let X of $.expr)yield*y1(X)}function*Z9($){return yield $.const}function*y1($){return $.type==="and"?yield*$9($):$.type==="or"?yield*X9($):$.type==="const"?yield*Z9($):(()=>{throw new MQ("Unknown expression")})()}function z1($){const X=J1($.pattern);return d$(X)?[...y1(X)]:[]}class MQ extends v{}function a($,X={}){return{...X,[H]:"Literal",const:$,type:typeof $}}function d1($={}){return{...$,[H]:"Boolean",type:"boolean"}}function v$($={}){return{...$,[H]:"BigInt",type:"bigint"}}function p8($={}){return{...$,[H]:"Number",type:"number"}}function D8($={}){return{...$,[H]:"String",type:"string"}}function*Q9($){const X=$.trim().replace(/"|'/g,"");return X==="boolean"?yield d1():X==="number"?yield p8():X==="bigint"?yield v$():X==="string"?yield D8():yield(()=>{const Z=X.split("|").map((Q)=>a(Q.trim()));return Z.length===0?Q0():Z.length===1?Z[0]:r8(Z)})()}function*W9($){if($[1]!=="{"){const X=a("$"),Z=KX($.slice(1));return yield*[X,...Z]}for(let X=2;X<$.length;X++)if($[X]==="}"){const Z=Q9($.slice(2,X)),Q=KX($.slice(X+1));return yield*[...Z,...Q]}yield a($)}function*KX($){for(let X=0;X<$.length;X++)if($[X]==="$"){const Z=a($.slice(0,X)),Q=W9($.slice(X));return yield*[Z,...Q]}yield a($)}function GQ($){return[...KX($)]}var wQ="(true|false)",K6="(0|[1-9][0-9]*)",DQ="(.*)";var O$="^(0|[1-9][0-9]*)$",V$="^(.*)$";var Y9=function($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},HQ=function($,X){return G8($)?$.pattern.slice(1,$.pattern.length-1):r($)?`(${$.anyOf.map((Z)=>HQ(Z,X)).join("|")})`:f$($)?`${X}${K6}`:g$($)?`${X}${K6}`:NX($)?`${X}${K6}`:k1($)?`${X}${DQ}`:H$($)?`${X}${Y9($.const.toString())}`:OX($)?`${X}${wQ}`:(()=>{throw new AQ(`Unexpected Kind '${$[H]}'`)})()};function jX($){return`^${$.map((X)=>HQ(X,"")).join("")}$`}class AQ extends v{}function p$($){const Z=z1($).map((Q)=>a(Q));return r8(Z)}function v1($,X={}){const Z=N0($)?jX(GQ($)):jX($);return{...X,[H]:"TemplateLiteral",type:"string",pattern:Z}}var J9=function($){return z1($).map((Z)=>Z.toString())},z9=function($){const X=[];for(let Z of $)X.push(...Y8(Z));return X},B9=function($){return[$.toString()]};function Y8($){return[...new Set(G8($)?J9($):r($)?z9($.anyOf):H$($)?B9($.const):f$($)?["[number]"]:g$($)?["[number]"]:[])]}var q9=function($,X,Z){const Q={};for(let W of Object.getOwnPropertyNames(X))Q[W]=m8($,Y8(X[W]),Z);return Q},M9=function($,X,Z){return q9($,X.properties,Z)};function NQ($,X,Z){const Q=M9($,X,Z);return n(Q)}var LQ=function($,X){return $.map((Z)=>PQ(Z,X))},U9=function($){return $.filter((X)=>!Q1(X))},G9=function($,X){return F6(U9(LQ($,X)))},w9=function($){return $.some((X)=>Q1(X))?[]:$},D9=function($,X){return r8(w9(LQ($,X)))},A9=function($,X){return X in $?$[X]:X==="[number]"?r8($):Q0()},H9=function($,X){return X==="[number]"?$:Q0()},N9=function($,X){return X in $?$[X]:Q0()};function PQ($,X){return x0($)?G9($.allOf,X):r($)?D9($.anyOf,X):v8($)?A9($.items??[],X):A$($)?H9($.items,X):f0($)?N9($.properties,X):Q0()}function RX($,X){return X.map((Z)=>PQ($,Z))}var OQ=function($,X){return r8(RX($,X))};function m8($,X,Z={}){return P0(X)?S(NQ($,X,Z)):U8(X)?S(_Q($,X,Z)):w8(X)?S(OQ($,Y8(X)),Z):S(OQ($,X),Z)}var O9=function($,X,Z){return{[X]:m8($,[X],Z)}},L9=function($,X,Z){return X.reduce((Q,W)=>{return{...Q,...O9($,W,Z)}},{})},P9=function($,X,Z){return L9($,X.keys,Z)};function _Q($,X,Z){const Q=P9($,X,Z);return n(Q)}function p1($,X={}){return{...X,[H]:"Iterator",type:"Iterator",items:S($)}}var _9=function($,X={}){const Z=globalThis.Object.getOwnPropertyNames($),Q=Z.filter((z)=>s8($[z])),W=Z.filter((z)=>!Q.includes(z)),Y=w8(X.additionalProperties)?{additionalProperties:S(X.additionalProperties)}:{},J={};for(let z of Z)J[z]=S($[z]);return W.length>0?{...X,...Y,[H]:"Object",type:"object",properties:J,required:W}:{...X,...Y,[H]:"Object",type:"object",properties:J}},Y0=_9;function m1($,X={}){return{...X,[H]:"Promise",type:"Promise",item:S($)}}var F9=function($){return b0(S($),[n8])},S9=function($){return{...S($),[n8]:"Readonly"}},K9=function($,X){return X===!1?F9($):S9($)};function A8($,X){const Z=X??!0;return P0($)?FQ($,Z):K9($,Z)}var j9=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames($))Z[Q]=A8($[Q],X);return Z},R9=function($,X){return j9($.properties,X)};function FQ($,X){const Z=R9($,X);return n(Z)}function h8($,X={}){const[Z,Q,W]=[!1,$.length,$.length];return $.length>0?{...X,[H]:"Tuple",type:"array",items:C0($),additionalItems:Z,minItems:Q,maxItems:W}:{...X,[H]:"Tuple",type:"array",minItems:Q,maxItems:W}}function SQ($,X){return $.includes(X)}function KQ($){return[...new Set($)]}function C9($,X){return $.filter((Z)=>X.includes(Z))}var b9=function($,X){return $.reduce((Z,Q)=>{return C9(Z,Q)},X)};function jQ($){return $.length===1?$[0]:$.length>1?b9($.slice(1),$[0]):[]}function RQ($){const X=[];for(let Z of $)X.push(...Z);return X}var CQ=function($,X){return $ in X?S8($,X[$]):n(X)},V9=function($){return{[$]:a($)}},E9=function($){const X={};for(let Z of $)X[Z]=a(Z);return X},I9=function($,X){return SQ(X,$)?V9($):E9(X)},x9=function($,X){const Z=I9($,X);return CQ($,Z)},h1=function($,X){return X.map((Z)=>S8($,Z))},k9=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames(X))Z[Q]=S8($,X[Q]);return Z},S8=function($,X){return s8(X)?a0(S8($,b0(X,[n0]))):WQ(X)?A8(S8($,b0(X,[n8]))):P0(X)?CQ($,X.properties):U8(X)?x9($,X.keys):E1(X)?b1(h1($,X.parameters),S8($,X.returns)):I1(X)?D$(h1($,X.parameters),S8($,X.returns)):V1(X)?C1(S8($,X.items)):x1(X)?p1(S8($,X.items)):x0(X)?e0(h1($,X.allOf)):r(X)?W0(h1($,X.anyOf)):v8(X)?h8(h1($,X.items??[])):f0(X)?Y0(k9($,X.properties)):A$(X)?R1(S8($,X.items)):y$(X)?m1(S8($,X.item)):X};function T9($,X){const Z={};for(let Q of $)Z[Q]=S8(Q,X);return Z}function CX($,X,Z={}){const Q=w8($)?Y8($):$,W=X({[H]:"MappedKey",keys:Q}),Y=T9(Q,W);return S(Y0(Y),Z)}var bQ=function($){const X=[];for(let Z of $)X.push(J8(Z));return X},g9=function($){const X=bQ($);return RQ(X)},f9=function($){const X=bQ($);return jQ(X)},y9=function($){return $.map((X,Z)=>Z.toString())},d9=function($){return["[number]"]},v9=function($){return globalThis.Object.getOwnPropertyNames($)},p9=function($){if(!bX)return[];return globalThis.Object.getOwnPropertyNames($).map((Z)=>{return Z[0]==="^"&&Z[Z.length-1]==="$"?Z.slice(1,Z.length-1):Z})};function J8($){return x0($)?g9($.allOf):r($)?f9($.anyOf):v8($)?y9($.items??[]):A$($)?d9($.items):f0($)?v9($.properties):LX($)?p9($.patternProperties):[]}function L$($){bX=!0;const X=J8($);return bX=!1,`^(${X.map((Q)=>`(${Q})`).join("|")})\$`}var bX=!1;function m9($){return $.map((X)=>X==="[number]"?p8():a(X))}function u1($,X={}){if(P0($))return VQ($,X);else{const Z=J8($),Q=m9(Z),W=r8(Q);return S(W,X)}}var h9=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames($))Z[Q]=u1($[Q],X);return Z},u9=function($,X){return h9($.properties,X)};function VQ($,X){const Z=u9($,X);return n(Z)}var c9=function($){return $.allOf.every((X)=>P$(X))},i9=function($){return $.anyOf.some((X)=>P$(X))},o9=function($){return!P$($.not)};function P$($){return $[H]==="Intersect"?c9($):$[H]==="Union"?i9($):$[H]==="Not"?o9($):$[H]==="Undefined"?!0:!1}function l9($){switch($.errorType){case N.ArrayContains:return"Expected array to contain at least one matching value";case N.ArrayMaxContains:return`Expected array to contain no more than ${$.schema.maxContains} matching values`;case N.ArrayMinContains:return`Expected array to contain at least ${$.schema.minContains} matching values`;case N.ArrayMaxItems:return`Expected array length to be less or equal to ${$.schema.maxItems}`;case N.ArrayMinItems:return`Expected array length to be greater or equal to ${$.schema.minItems}`;case N.ArrayUniqueItems:return"Expected array elements to be unique";case N.Array:return"Expected array";case N.AsyncIterator:return"Expected AsyncIterator";case N.BigIntExclusiveMaximum:return`Expected bigint to be less than ${$.schema.exclusiveMaximum}`;case N.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${$.schema.exclusiveMinimum}`;case N.BigIntMaximum:return`Expected bigint to be less or equal to ${$.schema.maximum}`;case N.BigIntMinimum:return`Expected bigint to be greater or equal to ${$.schema.minimum}`;case N.BigIntMultipleOf:return`Expected bigint to be a multiple of ${$.schema.multipleOf}`;case N.BigInt:return"Expected bigint";case N.Boolean:return"Expected boolean";case N.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${$.schema.exclusiveMinimumTimestamp}`;case N.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${$.schema.exclusiveMaximumTimestamp}`;case N.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${$.schema.minimumTimestamp}`;case N.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${$.schema.maximumTimestamp}`;case N.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${$.schema.multipleOfTimestamp}`;case N.Date:return"Expected Date";case N.Function:return"Expected function";case N.IntegerExclusiveMaximum:return`Expected integer to be less than ${$.schema.exclusiveMaximum}`;case N.IntegerExclusiveMinimum:return`Expected integer to be greater than ${$.schema.exclusiveMinimum}`;case N.IntegerMaximum:return`Expected integer to be less or equal to ${$.schema.maximum}`;case N.IntegerMinimum:return`Expected integer to be greater or equal to ${$.schema.minimum}`;case N.IntegerMultipleOf:return`Expected integer to be a multiple of ${$.schema.multipleOf}`;case N.Integer:return"Expected integer";case N.IntersectUnevaluatedProperties:return"Unexpected property";case N.Intersect:return"Expected all values to match";case N.Iterator:return"Expected Iterator";case N.Literal:return`Expected ${typeof $.schema.const==="string"?`'${$.schema.const}'`:$.schema.const}`;case N.Never:return"Never";case N.Not:return"Value should not match";case N.Null:return"Expected null";case N.NumberExclusiveMaximum:return`Expected number to be less than ${$.schema.exclusiveMaximum}`;case N.NumberExclusiveMinimum:return`Expected number to be greater than ${$.schema.exclusiveMinimum}`;case N.NumberMaximum:return`Expected number to be less or equal to ${$.schema.maximum}`;case N.NumberMinimum:return`Expected number to be greater or equal to ${$.schema.minimum}`;case N.NumberMultipleOf:return`Expected number to be a multiple of ${$.schema.multipleOf}`;case N.Number:return"Expected number";case N.Object:return"Expected object";case N.ObjectAdditionalProperties:return"Unexpected property";case N.ObjectMaxProperties:return`Expected object to have no more than ${$.schema.maxProperties} properties`;case N.ObjectMinProperties:return`Expected object to have at least ${$.schema.minProperties} properties`;case N.ObjectRequiredProperty:return"Required property";case N.Promise:return"Expected Promise";case N.RegExp:return"Expected string to match regular expression";case N.StringFormatUnknown:return`Unknown format '${$.schema.format}'`;case N.StringFormat:return`Expected string to match '${$.schema.format}' format`;case N.StringMaxLength:return`Expected string length less or equal to ${$.schema.maxLength}`;case N.StringMinLength:return`Expected string length greater or equal to ${$.schema.minLength}`;case N.StringPattern:return`Expected string to match '${$.schema.pattern}'`;case N.String:return"Expected string";case N.Symbol:return"Expected symbol";case N.TupleLength:return`Expected tuple to have ${$.schema.maxItems||0} elements`;case N.Tuple:return"Expected tuple";case N.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${$.schema.maxByteLength}`;case N.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${$.schema.minByteLength}`;case N.Uint8Array:return"Expected Uint8Array";case N.Undefined:return"Expected undefined";case N.Union:return"Expected union value";case N.Void:return"Expected void";case N.Kind:return`Expected kind '${$.schema[H]}'`;default:return"Unknown error type"}}function EQ(){return n9}var n9=l9;function X0($,X){const Z=X.findIndex((Q)=>Q.$id===$.$ref);if(Z===-1)throw new IQ($);return X[Z]}class IQ extends v{schema;constructor($){super(`Unable to dereference schema with \$id '${$.$id}'`);this.schema=$}}function*a9($){const X=$===0?1:Math.ceil(Math.floor(Math.log2($)+1)/8);for(let Z=0;Z<X;Z++)yield $>>8*(X-1-Z)&255}var e9=function($){t0(H8.Array);for(let X of $)q1(X)},$5=function($){t0(H8.Boolean),t0($?1:0)},X5=function($){t0(H8.BigInt),TQ.setBigInt64(0,$);for(let X of gQ)t0(X)},Z5=function($){t0(H8.Date),q1($.getTime())},Q5=function($){t0(H8.Null)},W5=function($){t0(H8.Number),TQ.setFloat64(0,$);for(let X of gQ)t0(X)},Y5=function($){t0(H8.Object);for(let X of globalThis.Object.getOwnPropertyNames($).sort())q1(X),q1($[X])},J5=function($){t0(H8.String);for(let X=0;X<$.length;X++)for(let Z of a9($.charCodeAt(X)))t0(Z)},z5=function($){t0(H8.Symbol),q1($.description)},B5=function($){t0(H8.Uint8Array);for(let X=0;X<$.length;X++)t0($[X])},q5=function($){return t0(H8.Undefined)},q1=function($){if(d($))return e9($);if(l8($))return $5($);if(u0($))return X5($);if(B8($))return Z5($);if(w$($))return Q5($);if(T($))return W5($);if(A0($))return Y5($);if(h($))return J5($);if(Z8($))return z5($);if($1($))return B5($);if(F0($))return q5($);throw new xQ($)},t0=function($){B1=B1^r9[$],B1=B1*t9%s9};function E$($){return B1=BigInt("14695981039346656037"),q1($),B1}class xQ extends v{value;constructor($){super("Unable to hash value");this.value=$}}var H8;(function($){$[$.Undefined=0]="Undefined",$[$.Null=1]="Null",$[$.Boolean=2]="Boolean",$[$.Number=3]="Number",$[$.String=4]="String",$[$.Object=5]="Object",$[$.Array=6]="Array",$[$.Date=7]="Date",$[$.Uint8Array=8]="Uint8Array",$[$.Symbol=9]="Symbol",$[$.BigInt=10]="BigInt"})(H8||(H8={}));var B1=BigInt("14695981039346656037"),[t9,s9]=[BigInt("1099511628211"),BigInt("2")**BigInt("64")],r9=Array.from({length:256}).map(($,X)=>BigInt(X)),kQ=new Float64Array(1),TQ=new DataView(kQ.buffer),gQ=new Uint8Array(kQ.buffer);var _$=function($){return $.replace(/~/g,"~0").replace(/\//g,"~1")},c=function($){return $!==void 0},R=function($,X,Z,Q){return{type:$,schema:X,path:Z,value:Q,message:EQ()({errorType:$,path:Z,schema:X,value:Q})}};function*M5($,X,Z,Q){}function*U5($,X,Z,Q){if(!d(Q))return yield R(N.Array,$,Z,Q);if(c($.minItems)&&!(Q.length>=$.minItems))yield R(N.ArrayMinItems,$,Z,Q);if(c($.maxItems)&&!(Q.length<=$.maxItems))yield R(N.ArrayMaxItems,$,Z,Q);for(let J=0;J<Q.length;J++)yield*c0($.items,X,`${Z}/${J}`,Q[J]);if($.uniqueItems===!0&&!function(){const J=new Set;for(let z of Q){const B=E$(z);if(J.has(B))return!1;else J.add(B)}return!0}())yield R(N.ArrayUniqueItems,$,Z,Q);if(!(c($.contains)||c($.minContains)||c($.maxContains)))return;const W=c($.contains)?$.contains:Q0(),Y=Q.reduce((J,z,B)=>c0(W,X,`${Z}${B}`,z).next().done===!0?J+1:J,0);if(Y===0)yield R(N.ArrayContains,$,Z,Q);if(T($.minContains)&&Y<$.minContains)yield R(N.ArrayMinContains,$,Z,Q);if(T($.maxContains)&&Y>$.maxContains)yield R(N.ArrayMaxContains,$,Z,Q)}function*G5($,X,Z,Q){if(!N6(Q))yield R(N.AsyncIterator,$,Z,Q)}function*w5($,X,Z,Q){if(!u0(Q))return yield R(N.BigInt,$,Z,Q);if(c($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield R(N.BigIntExclusiveMaximum,$,Z,Q);if(c($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield R(N.BigIntExclusiveMinimum,$,Z,Q);if(c($.maximum)&&!(Q<=$.maximum))yield R(N.BigIntMaximum,$,Z,Q);if(c($.minimum)&&!(Q>=$.minimum))yield R(N.BigIntMinimum,$,Z,Q);if(c($.multipleOf)&&Q%$.multipleOf!==BigInt(0))yield R(N.BigIntMultipleOf,$,Z,Q)}function*D5($,X,Z,Q){if(!l8(Q))yield R(N.Boolean,$,Z,Q)}function*A5($,X,Z,Q){yield*c0($.returns,X,Z,Q.prototype)}function*H5($,X,Z,Q){if(!B8(Q))return yield R(N.Date,$,Z,Q);if(c($.exclusiveMaximumTimestamp)&&!(Q.getTime()<$.exclusiveMaximumTimestamp))yield R(N.DateExclusiveMaximumTimestamp,$,Z,Q);if(c($.exclusiveMinimumTimestamp)&&!(Q.getTime()>$.exclusiveMinimumTimestamp))yield R(N.DateExclusiveMinimumTimestamp,$,Z,Q);if(c($.maximumTimestamp)&&!(Q.getTime()<=$.maximumTimestamp))yield R(N.DateMaximumTimestamp,$,Z,Q);if(c($.minimumTimestamp)&&!(Q.getTime()>=$.minimumTimestamp))yield R(N.DateMinimumTimestamp,$,Z,Q);if(c($.multipleOfTimestamp)&&Q.getTime()%$.multipleOfTimestamp!==0)yield R(N.DateMultipleOfTimestamp,$,Z,Q)}function*N5($,X,Z,Q){if(!F1(Q))yield R(N.Function,$,Z,Q)}function*O5($,X,Z,Q){if(!P6(Q))return yield R(N.Integer,$,Z,Q);if(c($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield R(N.IntegerExclusiveMaximum,$,Z,Q);if(c($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield R(N.IntegerExclusiveMinimum,$,Z,Q);if(c($.maximum)&&!(Q<=$.maximum))yield R(N.IntegerMaximum,$,Z,Q);if(c($.minimum)&&!(Q>=$.minimum))yield R(N.IntegerMinimum,$,Z,Q);if(c($.multipleOf)&&Q%$.multipleOf!==0)yield R(N.IntegerMultipleOf,$,Z,Q)}function*L5($,X,Z,Q){for(let W of $.allOf){const Y=c0(W,X,Z,Q).next();if(!Y.done)yield R(N.Intersect,$,Z,Q),yield Y.value}if($.unevaluatedProperties===!1){const W=new RegExp(L$($));for(let Y of Object.getOwnPropertyNames(Q))if(!W.test(Y))yield R(N.IntersectUnevaluatedProperties,$,`${Z}/${Y}`,Q)}if(typeof $.unevaluatedProperties==="object"){const W=new RegExp(L$($));for(let Y of Object.getOwnPropertyNames(Q))if(!W.test(Y)){const J=c0($.unevaluatedProperties,X,`${Z}/${Y}`,Q[Y]).next();if(!J.done)yield J.value}}}function*P5($,X,Z,Q){if(!O6(Q))yield R(N.Iterator,$,Z,Q)}function*_5($,X,Z,Q){if(Q!==$.const)yield R(N.Literal,$,Z,Q)}function*F5($,X,Z,Q){yield R(N.Never,$,Z,Q)}function*S5($,X,Z,Q){if(c0($.not,X,Z,Q).next().done===!0)yield R(N.Not,$,Z,Q)}function*K5($,X,Z,Q){if(!w$(Q))yield R(N.Null,$,Z,Q)}function*j5($,X,Z,Q){if(!V0.IsNumberLike(Q))return yield R(N.Number,$,Z,Q);if(c($.exclusiveMaximum)&&!(Q<$.exclusiveMaximum))yield R(N.NumberExclusiveMaximum,$,Z,Q);if(c($.exclusiveMinimum)&&!(Q>$.exclusiveMinimum))yield R(N.NumberExclusiveMinimum,$,Z,Q);if(c($.maximum)&&!(Q<=$.maximum))yield R(N.NumberMaximum,$,Z,Q);if(c($.minimum)&&!(Q>=$.minimum))yield R(N.NumberMinimum,$,Z,Q);if(c($.multipleOf)&&Q%$.multipleOf!==0)yield R(N.NumberMultipleOf,$,Z,Q)}function*R5($,X,Z,Q){if(!V0.IsObjectLike(Q))return yield R(N.Object,$,Z,Q);if(c($.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=$.minProperties))yield R(N.ObjectMinProperties,$,Z,Q);if(c($.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=$.maxProperties))yield R(N.ObjectMaxProperties,$,Z,Q);const W=Array.isArray($.required)?$.required:[],Y=Object.getOwnPropertyNames($.properties),J=Object.getOwnPropertyNames(Q);for(let z of W){if(J.includes(z))continue;yield R(N.ObjectRequiredProperty,$.properties[z],`${Z}/${_$(z)}`,void 0)}if($.additionalProperties===!1){for(let z of J)if(!Y.includes(z))yield R(N.ObjectAdditionalProperties,$,`${Z}/${_$(z)}`,Q[z])}if(typeof $.additionalProperties==="object")for(let z of J){if(Y.includes(z))continue;yield*c0($.additionalProperties,X,`${Z}/${_$(z)}`,Q[z])}for(let z of Y){const B=$.properties[z];if($.required&&$.required.includes(z)){if(yield*c0(B,X,`${Z}/${_$(z)}`,Q[z]),P$($)&&!(z in Q))yield R(N.ObjectRequiredProperty,B,`${Z}/${_$(z)}`,void 0)}else if(V0.IsExactOptionalProperty(Q,z))yield*c0(B,X,`${Z}/${_$(z)}`,Q[z])}}function*C5($,X,Z,Q){if(!L6(Q))yield R(N.Promise,$,Z,Q)}function*b5($,X,Z,Q){if(!V0.IsRecordLike(Q))return yield R(N.Object,$,Z,Q);if(c($.minProperties)&&!(Object.getOwnPropertyNames(Q).length>=$.minProperties))yield R(N.ObjectMinProperties,$,Z,Q);if(c($.maxProperties)&&!(Object.getOwnPropertyNames(Q).length<=$.maxProperties))yield R(N.ObjectMaxProperties,$,Z,Q);const[W,Y]=Object.entries($.patternProperties)[0],J=new RegExp(W);for(let[z,B]of Object.entries(Q))if(J.test(z))yield*c0(Y,X,`${Z}/${_$(z)}`,B);if(typeof $.additionalProperties==="object"){for(let[z,B]of Object.entries(Q))if(!J.test(z))yield*c0($.additionalProperties,X,`${Z}/${_$(z)}`,B)}if($.additionalProperties===!1)for(let[z,B]of Object.entries(Q)){if(J.test(z))continue;return yield R(N.ObjectAdditionalProperties,$,`${Z}/${_$(z)}`,B)}}function*V5($,X,Z,Q){yield*c0(X0($,X),X,Z,Q)}function*E5($,X,Z,Q){if(!h(Q))return yield R(N.String,$,Z,Q);if(c($.minLength)&&!(Q.length>=$.minLength))yield R(N.StringMinLength,$,Z,Q);if(c($.maxLength)&&!(Q.length<=$.maxLength))yield R(N.StringMaxLength,$,Z,Q);if(!new RegExp($.source,$.flags).test(Q))return yield R(N.RegExp,$,Z,Q)}function*I5($,X,Z,Q){if(!h(Q))return yield R(N.String,$,Z,Q);if(c($.minLength)&&!(Q.length>=$.minLength))yield R(N.StringMinLength,$,Z,Q);if(c($.maxLength)&&!(Q.length<=$.maxLength))yield R(N.StringMaxLength,$,Z,Q);if(h($.pattern)){if(!new RegExp($.pattern).test(Q))yield R(N.StringPattern,$,Z,Q)}if(h($.format)){if(!R0.Has($.format))yield R(N.StringFormatUnknown,$,Z,Q);else if(!R0.Get($.format)(Q))yield R(N.StringFormat,$,Z,Q)}}function*x5($,X,Z,Q){if(!Z8(Q))yield R(N.Symbol,$,Z,Q)}function*k5($,X,Z,Q){if(!h(Q))return yield R(N.String,$,Z,Q);if(!new RegExp($.pattern).test(Q))yield R(N.StringPattern,$,Z,Q)}function*T5($,X,Z,Q){yield*c0(X0($,X),X,Z,Q)}function*g5($,X,Z,Q){if(!d(Q))return yield R(N.Tuple,$,Z,Q);if($.items===void 0&&Q.length!==0)return yield R(N.TupleLength,$,Z,Q);if(Q.length!==$.maxItems)return yield R(N.TupleLength,$,Z,Q);if(!$.items)return;for(let W=0;W<$.items.length;W++)yield*c0($.items[W],X,`${Z}/${W}`,Q[W])}function*f5($,X,Z,Q){if(!F0(Q))yield R(N.Undefined,$,Z,Q)}function*y5($,X,Z,Q){let W=0;for(let Y of $.anyOf){const J=[...c0(Y,X,Z,Q)];if(J.length===0)return;W+=J.length}if(W>0)yield R(N.Union,$,Z,Q)}function*d5($,X,Z,Q){if(!$1(Q))return yield R(N.Uint8Array,$,Z,Q);if(c($.maxByteLength)&&!(Q.length<=$.maxByteLength))yield R(N.Uint8ArrayMaxByteLength,$,Z,Q);if(c($.minByteLength)&&!(Q.length>=$.minByteLength))yield R(N.Uint8ArrayMinByteLength,$,Z,Q)}function*v5($,X,Z,Q){}function*p5($,X,Z,Q){if(!V0.IsVoidLike(Q))yield R(N.Void,$,Z,Q)}function*m5($,X,Z,Q){if(!E0.Get($[H])($,Q))yield R(N.Kind,$,Z,Q)}function*c0($,X,Z,Q){const W=c($.$id)?[...X,$]:X,Y=$;switch(Y[H]){case"Any":return yield*M5(Y,W,Z,Q);case"Array":return yield*U5(Y,W,Z,Q);case"AsyncIterator":return yield*G5(Y,W,Z,Q);case"BigInt":return yield*w5(Y,W,Z,Q);case"Boolean":return yield*D5(Y,W,Z,Q);case"Constructor":return yield*A5(Y,W,Z,Q);case"Date":return yield*H5(Y,W,Z,Q);case"Function":return yield*N5(Y,W,Z,Q);case"Integer":return yield*O5(Y,W,Z,Q);case"Intersect":return yield*L5(Y,W,Z,Q);case"Iterator":return yield*P5(Y,W,Z,Q);case"Literal":return yield*_5(Y,W,Z,Q);case"Never":return yield*F5(Y,W,Z,Q);case"Not":return yield*S5(Y,W,Z,Q);case"Null":return yield*K5(Y,W,Z,Q);case"Number":return yield*j5(Y,W,Z,Q);case"Object":return yield*R5(Y,W,Z,Q);case"Promise":return yield*C5(Y,W,Z,Q);case"Record":return yield*b5(Y,W,Z,Q);case"Ref":return yield*V5(Y,W,Z,Q);case"RegExp":return yield*E5(Y,W,Z,Q);case"String":return yield*I5(Y,W,Z,Q);case"Symbol":return yield*x5(Y,W,Z,Q);case"TemplateLiteral":return yield*k5(Y,W,Z,Q);case"This":return yield*T5(Y,W,Z,Q);case"Tuple":return yield*g5(Y,W,Z,Q);case"Undefined":return yield*f5(Y,W,Z,Q);case"Union":return yield*y5(Y,W,Z,Q);case"Uint8Array":return yield*d5(Y,W,Z,Q);case"Unknown":return yield*v5(Y,W,Z,Q);case"Void":return yield*p5(Y,W,Z,Q);default:if(!E0.Has(Y[H]))throw new fQ($);return yield*m5(Y,W,Z,Q)}}function c1(...$){const X=$.length===3?c0($[0],$[1],"",$[2]):c0($[0],[],"",$[1]);return new j6(X)}var N;(function($){$[$.ArrayContains=0]="ArrayContains",$[$.ArrayMaxContains=1]="ArrayMaxContains",$[$.ArrayMaxItems=2]="ArrayMaxItems",$[$.ArrayMinContains=3]="ArrayMinContains",$[$.ArrayMinItems=4]="ArrayMinItems",$[$.ArrayUniqueItems=5]="ArrayUniqueItems",$[$.Array=6]="Array",$[$.AsyncIterator=7]="AsyncIterator",$[$.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",$[$.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",$[$.BigIntMaximum=10]="BigIntMaximum",$[$.BigIntMinimum=11]="BigIntMinimum",$[$.BigIntMultipleOf=12]="BigIntMultipleOf",$[$.BigInt=13]="BigInt",$[$.Boolean=14]="Boolean",$[$.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",$[$.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",$[$.DateMaximumTimestamp=17]="DateMaximumTimestamp",$[$.DateMinimumTimestamp=18]="DateMinimumTimestamp",$[$.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",$[$.Date=20]="Date",$[$.Function=21]="Function",$[$.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",$[$.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",$[$.IntegerMaximum=24]="IntegerMaximum",$[$.IntegerMinimum=25]="IntegerMinimum",$[$.IntegerMultipleOf=26]="IntegerMultipleOf",$[$.Integer=27]="Integer",$[$.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",$[$.Intersect=29]="Intersect",$[$.Iterator=30]="Iterator",$[$.Kind=31]="Kind",$[$.Literal=32]="Literal",$[$.Never=33]="Never",$[$.Not=34]="Not",$[$.Null=35]="Null",$[$.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",$[$.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",$[$.NumberMaximum=38]="NumberMaximum",$[$.NumberMinimum=39]="NumberMinimum",$[$.NumberMultipleOf=40]="NumberMultipleOf",$[$.Number=41]="Number",$[$.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",$[$.ObjectMaxProperties=43]="ObjectMaxProperties",$[$.ObjectMinProperties=44]="ObjectMinProperties",$[$.ObjectRequiredProperty=45]="ObjectRequiredProperty",$[$.Object=46]="Object",$[$.Promise=47]="Promise",$[$.RegExp=48]="RegExp",$[$.StringFormatUnknown=49]="StringFormatUnknown",$[$.StringFormat=50]="StringFormat",$[$.StringMaxLength=51]="StringMaxLength",$[$.StringMinLength=52]="StringMinLength",$[$.StringPattern=53]="StringPattern",$[$.String=54]="String",$[$.Symbol=55]="Symbol",$[$.TupleLength=56]="TupleLength",$[$.Tuple=57]="Tuple",$[$.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",$[$.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",$[$.Uint8Array=60]="Uint8Array",$[$.Undefined=61]="Undefined",$[$.Union=62]="Union",$[$.Void=63]="Void"})(N||(N={}));class fQ extends v{schema;constructor($){super("Unknown type");this.schema=$}}class j6{iterator;constructor($){this.iterator=$}[Symbol.iterator](){return this.iterator}First(){const $=this.iterator.next();return $.done?void 0:$.value}}function F$($={}){return{...$,[H]:"Any"}}function a8($={}){return{...$,[H]:"Unknown"}}var w={};y8(w,{TypeGuardUnknownTypeError:()=>{{return yQ}},IsVoid:()=>{{return _2}},IsUnsafe:()=>{{return P2}},IsUnknown:()=>{{return L2}},IsUnionLiteral:()=>{{return t5}},IsUnion:()=>{{return xX}},IsUndefined:()=>{{return N2}},IsUint8Array:()=>{{return O2}},IsTuple:()=>{{return H2}},IsTransform:()=>{{return O0}},IsThis:()=>{{return A2}},IsTemplateLiteral:()=>{{return D2}},IsSymbol:()=>{{return w2}},IsString:()=>{{return G2}},IsSchema:()=>{{return p}},IsRegExp:()=>{{return U2}},IsRef:()=>{{return M2}},IsRecursive:()=>{{return n5}},IsRecord:()=>{{return q2}},IsReadonly:()=>{{return i5}},IsProperties:()=>{{return IX}},IsPromise:()=>{{return B2}},IsOptional:()=>{{return o5}},IsObject:()=>{{return z2}},IsNumber:()=>{{return J2}},IsNull:()=>{{return Y2}},IsNot:()=>{{return W2}},IsNever:()=>{{return Q2}},IsMappedResult:()=>{{return Z2}},IsMappedKey:()=>{{return X2}},IsLiteralValue:()=>{{return $2}},IsLiteralString:()=>{{return aQ}},IsLiteralNumber:()=>{{return eQ}},IsLiteralBoolean:()=>{{return l5}},IsLiteral:()=>{{return o1}},IsKindOf:()=>{{return l}},IsKind:()=>{{return F2}},IsIterator:()=>{{return rQ}},IsIntersect:()=>{{return sQ}},IsInteger:()=>{{return tQ}},IsFunction:()=>{{return nQ}},IsDate:()=>{{return lQ}},IsConstructor:()=>{{return oQ}},IsBoolean:()=>{{return iQ}},IsBigInt:()=>{{return cQ}},IsAsyncIterator:()=>{{return uQ}},IsArray:()=>{{return hQ}},IsAny:()=>{{return mQ}}});var dQ=function($){try{return new RegExp($),!0}catch{return!1}},VX=function($){if(!N0($))return!1;for(let X=0;X<$.length;X++){const Z=$.charCodeAt(X);if(Z>=7&&Z<=13||Z===27||Z===127)return!1}return!0},vQ=function($){return EX($)||p($)},i1=function($){return S0($)||K1($)},D0=function($){return S0($)||d8($)},EX=function($){return S0($)||b$($)},J0=function($){return S0($)||N0($)},u5=function($){return S0($)||N0($)&&VX($)&&dQ($)},c5=function($){return S0($)||N0($)&&VX($)},pQ=function($){return S0($)||p($)};function i5($){return H0($)&&$[n8]==="Readonly"}function o5($){return H0($)&&$[n0]==="Optional"}function mQ($){return l($,"Any")&&J0($.$id)}function hQ($){return l($,"Array")&&$.type==="array"&&J0($.$id)&&p($.items)&&D0($.minItems)&&D0($.maxItems)&&EX($.uniqueItems)&&pQ($.contains)&&D0($.minContains)&&D0($.maxContains)}function uQ($){return l($,"AsyncIterator")&&$.type==="AsyncIterator"&&J0($.$id)&&p($.items)}function cQ($){return l($,"BigInt")&&$.type==="bigint"&&J0($.$id)&&i1($.exclusiveMaximum)&&i1($.exclusiveMinimum)&&i1($.maximum)&&i1($.minimum)&&i1($.multipleOf)}function iQ($){return l($,"Boolean")&&$.type==="boolean"&&J0($.$id)}function oQ($){return l($,"Constructor")&&$.type==="Constructor"&&J0($.$id)&&Q8($.parameters)&&$.parameters.every((X)=>p(X))&&p($.returns)}function lQ($){return l($,"Date")&&$.type==="Date"&&J0($.$id)&&D0($.exclusiveMaximumTimestamp)&&D0($.exclusiveMinimumTimestamp)&&D0($.maximumTimestamp)&&D0($.minimumTimestamp)&&D0($.multipleOfTimestamp)}function nQ($){return l($,"Function")&&$.type==="Function"&&J0($.$id)&&Q8($.parameters)&&$.parameters.every((X)=>p(X))&&p($.returns)}function tQ($){return l($,"Integer")&&$.type==="integer"&&J0($.$id)&&D0($.exclusiveMaximum)&&D0($.exclusiveMinimum)&&D0($.maximum)&&D0($.minimum)&&D0($.multipleOf)}function IX($){return H0($)&&Object.entries($).every(([X,Z])=>VX(X)&&p(Z))}function sQ($){return l($,"Intersect")&&(N0($.type)&&$.type!=="object"?!1:!0)&&Q8($.allOf)&&$.allOf.every((X)=>p(X)&&!O0(X))&&J0($.type)&&(EX($.unevaluatedProperties)||pQ($.unevaluatedProperties))&&J0($.$id)}function rQ($){return l($,"Iterator")&&$.type==="Iterator"&&J0($.$id)&&p($.items)}function l($,X){return H0($)&&H in $&&$[H]===X}function aQ($){return o1($)&&N0($.const)}function eQ($){return o1($)&&d8($.const)}function l5($){return o1($)&&b$($.const)}function o1($){return l($,"Literal")&&J0($.$id)&&$2($.const)}function $2($){return b$($)||d8($)||N0($)}function X2($){return l($,"MappedKey")&&Q8($.keys)&&$.keys.every((X)=>d8(X)||N0(X))}function Z2($){return l($,"MappedResult")&&IX($.properties)}function Q2($){return l($,"Never")&&H0($.not)&&Object.getOwnPropertyNames($.not).length===0}function W2($){return l($,"Not")&&p($.not)}function Y2($){return l($,"Null")&&$.type==="null"&&J0($.$id)}function J2($){return l($,"Number")&&$.type==="number"&&J0($.$id)&&D0($.exclusiveMaximum)&&D0($.exclusiveMinimum)&&D0($.maximum)&&D0($.minimum)&&D0($.multipleOf)}function z2($){return l($,"Object")&&$.type==="object"&&J0($.$id)&&IX($.properties)&&vQ($.additionalProperties)&&D0($.minProperties)&&D0($.maxProperties)}function B2($){return l($,"Promise")&&$.type==="Promise"&&J0($.$id)&&p($.item)}function q2($){return l($,"Record")&&$.type==="object"&&J0($.$id)&&vQ($.additionalProperties)&&H0($.patternProperties)&&((X)=>{const Z=Object.getOwnPropertyNames(X.patternProperties);return Z.length===1&&dQ(Z[0])&&H0(X.patternProperties)&&p(X.patternProperties[Z[0]])})($)}function n5($){return H0($)&&M8 in $&&$[M8]==="Recursive"}function M2($){return l($,"Ref")&&J0($.$id)&&N0($.$ref)}function U2($){return l($,"RegExp")&&J0($.$id)&&N0($.source)&&N0($.flags)&&D0($.maxLength)&&D0($.minLength)}function G2($){return l($,"String")&&$.type==="string"&&J0($.$id)&&D0($.minLength)&&D0($.maxLength)&&u5($.pattern)&&c5($.format)}function w2($){return l($,"Symbol")&&$.type==="symbol"&&J0($.$id)}function D2($){return l($,"TemplateLiteral")&&$.type==="string"&&N0($.pattern)&&$.pattern[0]==="^"&&$.pattern[$.pattern.length-1]==="$"}function A2($){return l($,"This")&&J0($.$id)&&N0($.$ref)}function O0($){return H0($)&&I0 in $}function H2($){return l($,"Tuple")&&$.type==="array"&&J0($.$id)&&d8($.minItems)&&d8($.maxItems)&&$.minItems===$.maxItems&&(S0($.items)&&S0($.additionalItems)&&$.minItems===0||Q8($.items)&&$.items.every((X)=>p(X)))}function N2($){return l($,"Undefined")&&$.type==="undefined"&&J0($.$id)}function t5($){return xX($)&&$.anyOf.every((X)=>aQ(X)||eQ(X))}function xX($){return l($,"Union")&&J0($.$id)&&H0($)&&Q8($.anyOf)&&$.anyOf.every((X)=>p(X))}function O2($){return l($,"Uint8Array")&&$.type==="Uint8Array"&&J0($.$id)&&D0($.minByteLength)&&D0($.maxByteLength)}function L2($){return l($,"Unknown")&&J0($.$id)}function P2($){return l($,"Unsafe")}function _2($){return l($,"Void")&&$.type==="void"&&J0($.$id)}function F2($){return H0($)&&H in $&&N0($[H])&&!h5.includes($[H])}function p($){return H0($)&&(mQ($)||hQ($)||iQ($)||cQ($)||uQ($)||oQ($)||lQ($)||nQ($)||tQ($)||sQ($)||rQ($)||o1($)||X2($)||Z2($)||Q2($)||W2($)||Y2($)||J2($)||z2($)||B2($)||q2($)||M2($)||U2($)||G2($)||w2($)||D2($)||A2($)||H2($)||N2($)||xX($)||O2($)||L2($)||P2($)||_2($)||F2($))}class yQ extends v{}var h5=["Any","Array","AsyncIterator","BigInt","Boolean","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];var K8=function($){return $===L.False?$:L.True},M1=function($){throw new C2($)},T0=function($){return w.IsNever($)||w.IsIntersect($)||w.IsUnion($)||w.IsUnknown($)||w.IsAny($)},g0=function($,X){return w.IsNever(X)?E2($,X):w.IsIntersect(X)?R6($,X):w.IsUnion(X)?yX($,X):w.IsUnknown(X)?T2($,X):w.IsAny(X)?fX($,X):M1("StructuralRight")},fX=function($,X){return L.True},s5=function($,X){return w.IsIntersect(X)?R6($,X):w.IsUnion(X)&&X.anyOf.some((Z)=>w.IsAny(Z)||w.IsUnknown(Z))?L.True:w.IsUnion(X)?L.Union:w.IsUnknown(X)?L.True:w.IsAny(X)?L.True:L.Union},r5=function($,X){return w.IsUnknown($)?L.False:w.IsAny($)?L.Union:w.IsNever($)?L.True:L.False},a5=function($,X){return w.IsObject(X)&&C6(X)?L.True:T0(X)?g0($,X):!w.IsArray(X)?L.False:K8(z0($.items,X.items))},e5=function($,X){return T0(X)?g0($,X):!w.IsAsyncIterator(X)?L.False:K8(z0($.items,X.items))},$J=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsBigInt(X)?L.True:L.False},b2=function($,X){return w.IsLiteralBoolean($)?L.True:w.IsBoolean($)?L.True:L.False},XJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsBoolean(X)?L.True:L.False},ZJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):!w.IsConstructor(X)?L.False:$.parameters.length>X.parameters.length?L.False:!$.parameters.every((Z,Q)=>K8(z0(X.parameters[Q],Z))===L.True)?L.False:K8(z0($.returns,X.returns))},QJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsDate(X)?L.True:L.False},WJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):!w.IsFunction(X)?L.False:$.parameters.length>X.parameters.length?L.False:!$.parameters.every((Z,Q)=>K8(z0(X.parameters[Q],Z))===L.True)?L.False:K8(z0($.returns,X.returns))},V2=function($,X){return w.IsLiteral($)&&W8.IsNumber($.const)?L.True:w.IsNumber($)||w.IsInteger($)?L.True:L.False},YJ=function($,X){return w.IsInteger(X)||w.IsNumber(X)?L.True:T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):L.False},R6=function($,X){return X.allOf.every((Z)=>z0($,Z)===L.True)?L.True:L.False},JJ=function($,X){return $.allOf.some((Z)=>z0(Z,X)===L.True)?L.True:L.False},zJ=function($,X){return T0(X)?g0($,X):!w.IsIterator(X)?L.False:K8(z0($.items,X.items))},BJ=function($,X){return w.IsLiteral(X)&&X.const===$.const?L.True:T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsString(X)?k2($,X):w.IsNumber(X)?I2($,X):w.IsInteger(X)?V2($,X):w.IsBoolean(X)?b2($,X):L.False},E2=function($,X){return L.False},qJ=function($,X){return L.True},S2=function($){let[X,Z]=[$,0];while(!0){if(!w.IsNot(X))break;X=X.not,Z+=1}return Z%2===0?X:a8()},MJ=function($,X){return w.IsNot($)?z0(S2($),X):w.IsNot(X)?z0($,S2(X)):M1("Invalid fallthrough for Not")},UJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsNull(X)?L.True:L.False},I2=function($,X){return w.IsLiteralNumber($)?L.True:w.IsNumber($)||w.IsInteger($)?L.True:L.False},GJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsInteger(X)||w.IsNumber(X)?L.True:L.False},z8=function($,X){return Object.getOwnPropertyNames($.properties).length===X},K2=function($){return C6($)},j2=function($){return z8($,0)||z8($,1)&&"description"in $.properties&&w.IsUnion($.properties.description)&&$.properties.description.anyOf.length===2&&(w.IsString($.properties.description.anyOf[0])&&w.IsUndefined($.properties.description.anyOf[1])||w.IsString($.properties.description.anyOf[1])&&w.IsUndefined($.properties.description.anyOf[0]))},kX=function($){return z8($,0)},R2=function($){return z8($,0)},wJ=function($){return z8($,0)},DJ=function($){return z8($,0)},AJ=function($){return C6($)},HJ=function($){const X=p8();return z8($,0)||z8($,1)&&"length"in $.properties&&K8(z0($.properties.length,X))===L.True},NJ=function($){return z8($,0)},C6=function($){const X=p8();return z8($,0)||z8($,1)&&"length"in $.properties&&K8(z0($.properties.length,X))===L.True},OJ=function($){const X=D$([F$()],F$());return z8($,0)||z8($,1)&&"then"in $.properties&&K8(z0($.properties.then,X))===L.True},x2=function($,X){return z0($,X)===L.False?L.False:w.IsOptional($)&&!w.IsOptional(X)?L.False:L.True},s0=function($,X){return w.IsUnknown($)?L.False:w.IsAny($)?L.Union:w.IsNever($)||w.IsLiteralString($)&&K2(X)||w.IsLiteralNumber($)&&kX(X)||w.IsLiteralBoolean($)&&R2(X)||w.IsSymbol($)&&j2(X)||w.IsBigInt($)&&wJ(X)||w.IsString($)&&K2(X)||w.IsSymbol($)&&j2(X)||w.IsNumber($)&&kX(X)||w.IsInteger($)&&kX(X)||w.IsBoolean($)&&R2(X)||w.IsUint8Array($)&&AJ(X)||w.IsDate($)&&DJ(X)||w.IsConstructor($)&&NJ(X)||w.IsFunction($)&&HJ(X)?L.True:w.IsRecord($)&&w.IsString(TX($))?(()=>{return X[M8]==="Record"?L.True:L.False})():w.IsRecord($)&&w.IsNumber(TX($))?(()=>{return z8(X,0)?L.True:L.False})():L.False},LJ=function($,X){return T0(X)?g0($,X):w.IsRecord(X)?j8($,X):!w.IsObject(X)?L.False:(()=>{for(let Z of Object.getOwnPropertyNames(X.properties)){if(!(Z in $.properties)&&!w.IsOptional(X.properties[Z]))return L.False;if(w.IsOptional(X.properties[Z]))return L.True;if(x2($.properties[Z],X.properties[Z])===L.False)return L.False}return L.True})()},PJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)&&OJ(X)?L.True:!w.IsPromise(X)?L.False:K8(z0($.item,X.item))},TX=function($){return O$ in $.patternProperties?p8():(V$ in $.patternProperties)?D8():M1("Unknown record key pattern")},gX=function($){return O$ in $.patternProperties?$.patternProperties[O$]:(V$ in $.patternProperties)?$.patternProperties[V$]:M1("Unable to get record value schema")},j8=function($,X){const[Z,Q]=[TX(X),gX(X)];return w.IsLiteralString($)&&w.IsNumber(Z)&&K8(z0($,Q))===L.True?L.True:w.IsUint8Array($)&&w.IsNumber(Z)?z0($,Q):w.IsString($)&&w.IsNumber(Z)?z0($,Q):w.IsArray($)&&w.IsNumber(Z)?z0($,Q):w.IsObject($)?(()=>{for(let W of Object.getOwnPropertyNames($.properties))if(x2(Q,$.properties[W])===L.False)return L.False;return L.True})():L.False},_J=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):!w.IsRecord(X)?L.False:z0(gX($),gX(X))},FJ=function($,X){const Z=w.IsRegExp($)?D8():$,Q=w.IsRegExp(X)?D8():X;return z0(Z,Q)},k2=function($,X){return w.IsLiteral($)&&W8.IsString($.const)?L.True:w.IsString($)?L.True:L.False},SJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsString(X)?L.True:L.False},KJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsSymbol(X)?L.True:L.False},jJ=function($,X){return w.IsTemplateLiteral($)?z0(p$($),X):w.IsTemplateLiteral(X)?z0($,p$(X)):M1("Invalid fallthrough for TemplateLiteral")},RJ=function($,X){return w.IsArray(X)&&$.items!==void 0&&$.items.every((Z)=>z0(Z,X.items)===L.True)},CJ=function($,X){return w.IsNever($)?L.True:w.IsUnknown($)?L.False:w.IsAny($)?L.Union:L.False},bJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)&&C6(X)?L.True:w.IsArray(X)&&RJ($,X)?L.True:!w.IsTuple(X)?L.False:W8.IsUndefined($.items)&&!W8.IsUndefined(X.items)||!W8.IsUndefined($.items)&&W8.IsUndefined(X.items)?L.False:W8.IsUndefined($.items)&&!W8.IsUndefined(X.items)?L.True:$.items.every((Z,Q)=>z0(Z,X.items[Q])===L.True)?L.True:L.False},VJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsUint8Array(X)?L.True:L.False},EJ=function($,X){return T0(X)?g0($,X):w.IsObject(X)?s0($,X):w.IsRecord(X)?j8($,X):w.IsVoid(X)?kJ($,X):w.IsUndefined(X)?L.True:L.False},yX=function($,X){return X.anyOf.some((Z)=>z0($,Z)===L.True)?L.True:L.False},IJ=function($,X){return $.anyOf.every((Z)=>z0(Z,X)===L.True)?L.True:L.False},T2=function($,X){return L.True},xJ=function($,X){return w.IsNever(X)?E2($,X):w.IsIntersect(X)?R6($,X):w.IsUnion(X)?yX($,X):w.IsAny(X)?fX($,X):w.IsString(X)?k2($,X):w.IsNumber(X)?I2($,X):w.IsInteger(X)?V2($,X):w.IsBoolean(X)?b2($,X):w.IsArray(X)?r5($,X):w.IsTuple(X)?CJ($,X):w.IsObject(X)?s0($,X):w.IsUnknown(X)?L.True:L.False},kJ=function($,X){return w.IsUndefined($)?L.True:w.IsUndefined($)?L.True:L.False},TJ=function($,X){return w.IsIntersect(X)?R6($,X):w.IsUnion(X)?yX($,X):w.IsUnknown(X)?T2($,X):w.IsAny(X)?fX($,X):w.IsObject(X)?s0($,X):w.IsVoid(X)?L.True:L.False},z0=function($,X){return w.IsTemplateLiteral($)||w.IsTemplateLiteral(X)?jJ($,X):w.IsRegExp($)||w.IsRegExp(X)?FJ($,X):w.IsNot($)||w.IsNot(X)?MJ($,X):w.IsAny($)?s5($,X):w.IsArray($)?a5($,X):w.IsBigInt($)?$J($,X):w.IsBoolean($)?XJ($,X):w.IsAsyncIterator($)?e5($,X):w.IsConstructor($)?ZJ($,X):w.IsDate($)?QJ($,X):w.IsFunction($)?WJ($,X):w.IsInteger($)?YJ($,X):w.IsIntersect($)?JJ($,X):w.IsIterator($)?zJ($,X):w.IsLiteral($)?BJ($,X):w.IsNever($)?qJ($,X):w.IsNull($)?UJ($,X):w.IsNumber($)?GJ($,X):w.IsObject($)?LJ($,X):w.IsRecord($)?_J($,X):w.IsString($)?SJ($,X):w.IsSymbol($)?KJ($,X):w.IsTuple($)?bJ($,X):w.IsPromise($)?PJ($,X):w.IsUint8Array($)?VJ($,X):w.IsUndefined($)?EJ($,X):w.IsUnion($)?IJ($,X):w.IsUnknown($)?xJ($,X):w.IsVoid($)?TJ($,X):M1(`Unknown left type operand '${$[H]}'`)};function I$($,X){return z0($,X)}class C2 extends v{}var L;(function($){$[$.Union=0]="Union",$[$.True=1]="True",$[$.False=2]="False"})(L||(L={}));var gJ=function($,X,Z,Q,W){const Y={};for(let J of globalThis.Object.getOwnPropertyNames($))Y[J]=m$($[J],X,Z,Q,W);return Y},fJ=function($,X,Z,Q,W){return gJ($.properties,X,Z,Q,W)};function g2($,X,Z,Q,W){const Y=fJ($,X,Z,Q,W);return n(Y)}var yJ=function($,X,Z,Q){const W=I$($,X);return W===L.Union?W0([Z,Q]):W===L.True?Z:Q};function m$($,X,Z,Q,W={}){return P0($)?g2($,X,Z,Q,W):U8($)?S(f2($,X,Z,Q,W)):S(yJ($,X,Z,Q),W)}var dJ=function($,X,Z,Q,W){return{[$]:m$(a($),X,Z,Q,W)}},vJ=function($,X,Z,Q,W){return $.reduce((Y,J)=>{return{...Y,...dJ(J,X,Z,Q,W)}},{})},pJ=function($,X,Z,Q,W){return vJ($.keys,X,Z,Q,W)};function f2($,X,Z,Q,W){const Y=pJ($,X,Z,Q,W);return n(Y)}var mJ=function($){return $[H]==="Any"||$[H]==="Unknown"},i=function($){return $!==void 0},hJ=function($,X,Z){return!0},uJ=function($,X,Z){if(!d(Z))return!1;if(i($.minItems)&&!(Z.length>=$.minItems))return!1;if(i($.maxItems)&&!(Z.length<=$.maxItems))return!1;if(!Z.every((Y)=>i0($.items,X,Y)))return!1;if($.uniqueItems===!0&&!function(){const Y=new Set;for(let J of Z){const z=E$(J);if(Y.has(z))return!1;else Y.add(z)}return!0}())return!1;if(!(i($.contains)||T($.minContains)||T($.maxContains)))return!0;const Q=i($.contains)?$.contains:Q0(),W=Z.reduce((Y,J)=>i0(Q,X,J)?Y+1:Y,0);if(W===0)return!1;if(T($.minContains)&&W<$.minContains)return!1;if(T($.maxContains)&&W>$.maxContains)return!1;return!0},cJ=function($,X,Z){return N6(Z)},iJ=function($,X,Z){if(!u0(Z))return!1;if(i($.exclusiveMaximum)&&!(Z<$.exclusiveMaximum))return!1;if(i($.exclusiveMinimum)&&!(Z>$.exclusiveMinimum))return!1;if(i($.maximum)&&!(Z<=$.maximum))return!1;if(i($.minimum)&&!(Z>=$.minimum))return!1;if(i($.multipleOf)&&Z%$.multipleOf!==BigInt(0))return!1;return!0},oJ=function($,X,Z){return l8(Z)},lJ=function($,X,Z){return i0($.returns,X,Z.prototype)},nJ=function($,X,Z){if(!B8(Z))return!1;if(i($.exclusiveMaximumTimestamp)&&!(Z.getTime()<$.exclusiveMaximumTimestamp))return!1;if(i($.exclusiveMinimumTimestamp)&&!(Z.getTime()>$.exclusiveMinimumTimestamp))return!1;if(i($.maximumTimestamp)&&!(Z.getTime()<=$.maximumTimestamp))return!1;if(i($.minimumTimestamp)&&!(Z.getTime()>=$.minimumTimestamp))return!1;if(i($.multipleOfTimestamp)&&Z.getTime()%$.multipleOfTimestamp!==0)return!1;return!0},tJ=function($,X,Z){return F1(Z)},sJ=function($,X,Z){if(!P6(Z))return!1;if(i($.exclusiveMaximum)&&!(Z<$.exclusiveMaximum))return!1;if(i($.exclusiveMinimum)&&!(Z>$.exclusiveMinimum))return!1;if(i($.maximum)&&!(Z<=$.maximum))return!1;if(i($.minimum)&&!(Z>=$.minimum))return!1;if(i($.multipleOf)&&Z%$.multipleOf!==0)return!1;return!0},rJ=function($,X,Z){const Q=$.allOf.every((W)=>i0(W,X,Z));if($.unevaluatedProperties===!1){const W=new RegExp(L$($)),Y=Object.getOwnPropertyNames(Z).every((J)=>W.test(J));return Q&&Y}else if(p($.unevaluatedProperties)){const W=new RegExp(L$($)),Y=Object.getOwnPropertyNames(Z).every((J)=>W.test(J)||i0($.unevaluatedProperties,X,Z[J]));return Q&&Y}else return Q},aJ=function($,X,Z){return O6(Z)},eJ=function($,X,Z){return Z===$.const},$z=function($,X,Z){return!1},Xz=function($,X,Z){return!i0($.not,X,Z)},Zz=function($,X,Z){return w$(Z)},Qz=function($,X,Z){if(!V0.IsNumberLike(Z))return!1;if(i($.exclusiveMaximum)&&!(Z<$.exclusiveMaximum))return!1;if(i($.exclusiveMinimum)&&!(Z>$.exclusiveMinimum))return!1;if(i($.minimum)&&!(Z>=$.minimum))return!1;if(i($.maximum)&&!(Z<=$.maximum))return!1;if(i($.multipleOf)&&Z%$.multipleOf!==0)return!1;return!0},Wz=function($,X,Z){if(!V0.IsObjectLike(Z))return!1;if(i($.minProperties)&&!(Object.getOwnPropertyNames(Z).length>=$.minProperties))return!1;if(i($.maxProperties)&&!(Object.getOwnPropertyNames(Z).length<=$.maxProperties))return!1;const Q=Object.getOwnPropertyNames($.properties);for(let W of Q){const Y=$.properties[W];if($.required&&$.required.includes(W)){if(!i0(Y,X,Z[W]))return!1;if((P$(Y)||mJ(Y))&&!(W in Z))return!1}else if(V0.IsExactOptionalProperty(Z,W)&&!i0(Y,X,Z[W]))return!1}if($.additionalProperties===!1){const W=Object.getOwnPropertyNames(Z);if($.required&&$.required.length===Q.length&&W.length===Q.length)return!0;else return W.every((Y)=>Q.includes(Y))}else if(typeof $.additionalProperties==="object")return Object.getOwnPropertyNames(Z).every((Y)=>Q.includes(Y)||i0($.additionalProperties,X,Z[Y]));else return!0},Yz=function($,X,Z){return L6(Z)},Jz=function($,X,Z){if(!V0.IsRecordLike(Z))return!1;if(i($.minProperties)&&!(Object.getOwnPropertyNames(Z).length>=$.minProperties))return!1;if(i($.maxProperties)&&!(Object.getOwnPropertyNames(Z).length<=$.maxProperties))return!1;const[Q,W]=Object.entries($.patternProperties)[0],Y=new RegExp(Q),J=Object.entries(Z).every(([M,q])=>{return Y.test(M)?i0(W,X,q):!0}),z=typeof $.additionalProperties==="object"?Object.entries(Z).every(([M,q])=>{return!Y.test(M)?i0($.additionalProperties,X,q):!0}):!0,B=$.additionalProperties===!1?Object.getOwnPropertyNames(Z).every((M)=>{return Y.test(M)}):!0;return J&&z&&B},zz=function($,X,Z){return i0(X0($,X),X,Z)},Bz=function($,X,Z){const Q=new RegExp($.source,$.flags);if(i($.minLength)){if(!(Z.length>=$.minLength))return!1}if(i($.maxLength)){if(!(Z.length<=$.maxLength))return!1}return Q.test(Z)},qz=function($,X,Z){if(!h(Z))return!1;if(i($.minLength)){if(!(Z.length>=$.minLength))return!1}if(i($.maxLength)){if(!(Z.length<=$.maxLength))return!1}if(i($.pattern)){if(!new RegExp($.pattern).test(Z))return!1}if(i($.format)){if(!R0.Has($.format))return!1;return R0.Get($.format)(Z)}return!0},Mz=function($,X,Z){return Z8(Z)},Uz=function($,X,Z){return h(Z)&&new RegExp($.pattern).test(Z)},Gz=function($,X,Z){return i0(X0($,X),X,Z)},wz=function($,X,Z){if(!d(Z))return!1;if($.items===void 0&&Z.length!==0)return!1;if(Z.length!==$.maxItems)return!1;if(!$.items)return!0;for(let Q=0;Q<$.items.length;Q++)if(!i0($.items[Q],X,Z[Q]))return!1;return!0},Dz=function($,X,Z){return F0(Z)},Az=function($,X,Z){return $.anyOf.some((Q)=>i0(Q,X,Z))},Hz=function($,X,Z){if(!$1(Z))return!1;if(i($.maxByteLength)&&!(Z.length<=$.maxByteLength))return!1;if(i($.minByteLength)&&!(Z.length>=$.minByteLength))return!1;return!0},Nz=function($,X,Z){return!0},Oz=function($,X,Z){return V0.IsVoidLike(Z)},Lz=function($,X,Z){if(!E0.Has($[H]))return!1;return E0.Get($[H])($,Z)},i0=function($,X,Z){const Q=i($.$id)?[...X,$]:X,W=$;switch(W[H]){case"Any":return hJ(W,Q,Z);case"Array":return uJ(W,Q,Z);case"AsyncIterator":return cJ(W,Q,Z);case"BigInt":return iJ(W,Q,Z);case"Boolean":return oJ(W,Q,Z);case"Constructor":return lJ(W,Q,Z);case"Date":return nJ(W,Q,Z);case"Function":return tJ(W,Q,Z);case"Integer":return sJ(W,Q,Z);case"Intersect":return rJ(W,Q,Z);case"Iterator":return aJ(W,Q,Z);case"Literal":return eJ(W,Q,Z);case"Never":return $z(W,Q,Z);case"Not":return Xz(W,Q,Z);case"Null":return Zz(W,Q,Z);case"Number":return Qz(W,Q,Z);case"Object":return Wz(W,Q,Z);case"Promise":return Yz(W,Q,Z);case"Record":return Jz(W,Q,Z);case"Ref":return zz(W,Q,Z);case"RegExp":return Bz(W,Q,Z);case"String":return qz(W,Q,Z);case"Symbol":return Mz(W,Q,Z);case"TemplateLiteral":return Uz(W,Q,Z);case"This":return Gz(W,Q,Z);case"Tuple":return wz(W,Q,Z);case"Undefined":return Dz(W,Q,Z);case"Union":return Az(W,Q,Z);case"Uint8Array":return Hz(W,Q,Z);case"Unknown":return Nz(W,Q,Z);case"Void":return Oz(W,Q,Z);default:if(!E0.Has(W[H]))throw new y2(W);return Lz(W,Q,Z)}};function Z0(...$){return $.length===3?i0($[0],$[1],$[2]):i0($[0],[],$[1])}class y2 extends v{schema;constructor($){super("Unknown type");this.schema=$}}var Pz=function($){const X={};for(let Z of Object.getOwnPropertyNames($))X[Z]=B0($[Z]);for(let Z of Object.getOwnPropertySymbols($))X[Z]=B0($[Z]);return X},_z=function($){return $.map((X)=>B0(X))},Fz=function($){return $.slice()},Sz=function($){return new Date($.toISOString())},Kz=function($){return $};function B0($){if(d($))return _z($);if(B8($))return Sz($);if(A0($))return Pz($);if(F8($))return Fz($);if(q8($))return Kz($);throw new Error("ValueClone: Unable to clone value")}var s=function($){return typeof $==="function"?$:B0($)},jz=function($,X){if(u($,"default"))return s($.default);else return{}},Rz=function($,X){if($.uniqueItems===!0&&!u($,"default"))throw new R8($,"Array with the uniqueItems constraint requires a default value");else if("contains"in $&&!u($,"default"))throw new R8($,"Array with the contains constraint requires a default value");else if("default"in $)return s($.default);else if($.minItems!==void 0)return Array.from({length:$.minItems}).map((Z)=>{return N8($.items,X)});else return[]},Cz=function($,X){if(u($,"default"))return s($.default);else return async function*(){}()},bz=function($,X){if(u($,"default"))return s($.default);else return BigInt(0)},Vz=function($,X){if(u($,"default"))return s($.default);else return!1},Ez=function($,X){if(u($,"default"))return s($.default);else{const Z=N8($.returns,X);if(typeof Z==="object"&&!Array.isArray(Z))return class{constructor(){for(let[Q,W]of Object.entries(Z)){const Y=this;Y[Q]=W}}};else return class{}}},Iz=function($,X){if(u($,"default"))return s($.default);else if($.minimumTimestamp!==void 0)return new Date($.minimumTimestamp);else return new Date},xz=function($,X){if(u($,"default"))return s($.default);else return()=>N8($.returns,X)},kz=function($,X){if(u($,"default"))return s($.default);else if($.minimum!==void 0)return $.minimum;else return 0},Tz=function($,X){if(u($,"default"))return s($.default);else{const Z=$.allOf.reduce((Q,W)=>{const Y=N8(W,X);return typeof Y==="object"?{...Q,...Y}:Y},{});if(!Z0($,X,Z))throw new R8($,"Intersect produced invalid value. Consider using a default value.");return Z}},gz=function($,X){if(u($,"default"))return s($.default);else return function*(){}()},fz=function($,X){if(u($,"default"))return s($.default);else return $.const},yz=function($,X){if(u($,"default"))return s($.default);else throw new R8($,"Never types cannot be created. Consider using a default value.")},dz=function($,X){if(u($,"default"))return s($.default);else throw new R8($,"Not types must have a default value")},vz=function($,X){if(u($,"default"))return s($.default);else return null},pz=function($,X){if(u($,"default"))return s($.default);else if($.minimum!==void 0)return $.minimum;else return 0},mz=function($,X){if(u($,"default"))return s($.default);else{const Z=new Set($.required),Q={};for(let[W,Y]of Object.entries($.properties)){if(!Z.has(W))continue;Q[W]=N8(Y,X)}return Q}},hz=function($,X){if(u($,"default"))return s($.default);else return Promise.resolve(N8($.item,X))},uz=function($,X){const[Z,Q]=Object.entries($.patternProperties)[0];if(u($,"default"))return s($.default);else if(!(Z===V$||Z===O$)){const W=Z.slice(1,Z.length-1).split("|"),Y={};for(let J of W)Y[J]=N8(Q,X);return Y}else return{}},cz=function($,X){if(u($,"default"))return s($.default);else return N8(X0($,X),X)},iz=function($,X){if(u($,"default"))return s($.default);else throw new R8($,"RegExp types cannot be created. Consider using a default value.")},oz=function($,X){if($.pattern!==void 0)if(!u($,"default"))throw new R8($,"String types with patterns must specify a default value");else return s($.default);else if($.format!==void 0)if(!u($,"default"))throw new R8($,"String types with formats must specify a default value");else return s($.default);else if(u($,"default"))return s($.default);else if($.minLength!==void 0)return Array.from({length:$.minLength}).map(()=>" ").join("");else return""},lz=function($,X){if(u($,"default"))return s($.default);else if("value"in $)return Symbol.for($.value);else return Symbol()},nz=function($,X){if(u($,"default"))return s($.default);if(!S6($))throw new R8($,"Can only create template literals that produce a finite variants. Consider using a default value.");return z1($)[0]},tz=function($,X){if(d2++>Q4)throw new R8($,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(u($,"default"))return s($.default);else return N8(X0($,X),X)},sz=function($,X){if(u($,"default"))return s($.default);if($.items===void 0)return[];else return Array.from({length:$.minItems}).map((Z,Q)=>N8($.items[Q],X))},rz=function($,X){if(u($,"default"))return s($.default);else return},az=function($,X){if(u($,"default"))return s($.default);else if($.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return N8($.anyOf[0],X)},ez=function($,X){if(u($,"default"))return s($.default);else if($.minByteLength!==void 0)return new Uint8Array($.minByteLength);else return new Uint8Array(0)},$4=function($,X){if(u($,"default"))return s($.default);else return{}},X4=function($,X){if(u($,"default"))return s($.default);else return},Z4=function($,X){if(u($,"default"))return s($.default);else throw new Error("User defined types must specify a default value")},N8=function($,X){const Z=h($.$id)?[...X,$]:X,Q=$;switch(Q[H]){case"Any":return jz(Q,Z);case"Array":return Rz(Q,Z);case"AsyncIterator":return Cz(Q,Z);case"BigInt":return bz(Q,Z);case"Boolean":return Vz(Q,Z);case"Constructor":return Ez(Q,Z);case"Date":return Iz(Q,Z);case"Function":return xz(Q,Z);case"Integer":return kz(Q,Z);case"Intersect":return Tz(Q,Z);case"Iterator":return gz(Q,Z);case"Literal":return fz(Q,Z);case"Never":return yz(Q,Z);case"Not":return dz(Q,Z);case"Null":return vz(Q,Z);case"Number":return pz(Q,Z);case"Object":return mz(Q,Z);case"Promise":return hz(Q,Z);case"Record":return uz(Q,Z);case"Ref":return cz(Q,Z);case"RegExp":return iz(Q,Z);case"String":return oz(Q,Z);case"Symbol":return lz(Q,Z);case"TemplateLiteral":return nz(Q,Z);case"This":return tz(Q,Z);case"Tuple":return sz(Q,Z);case"Undefined":return rz(Q,Z);case"Union":return az(Q,Z);case"Uint8Array":return ez(Q,Z);case"Unknown":return $4(Q,Z);case"Void":return X4(Q,Z);default:if(!E0.Has(Q[H]))throw new R8(Q,"Unknown type");return Z4(Q,Z)}};function O8(...$){return d2=0,$.length===2?N8($[0],$[1]):N8($[0],[])}class R8 extends v{schema;constructor($,X){super(X);this.schema=$}}var Q4=512,d2=0;var W4=function($,X,Z){if($[H]==="Object"&&typeof Z==="object"&&!w$(Z)){const Q=$,W=Object.getOwnPropertyNames(Z),Y=Object.entries(Q.properties),[J,z]=[1/Y.length,Y.length];return Y.reduce((B,[M,q])=>{const U=q[H]==="Literal"&&q.const===Z[M]?z:0,O=Z0(q,X,Z[M])?J:0,_=W.includes(M)?J:0;return B+(U+O+_)},0)}else return Z0($,X,Z)?1:0},Y4=function($,X,Z){let[Q,W]=[$.anyOf[0],0];for(let Y of $.anyOf){const J=W4(Y,X,Z);if(J>W)Q=Y,W=J}return Q},J4=function($,X,Z){if("default"in $)return typeof Z==="function"?$.default:B0($.default);else{const Q=Y4($,X,Z);return b6(Q,X,Z)}},z4=function($,X,Z){return Z0($,X,Z)?B0(Z):O8($,X)},B4=function($,X,Z){return Z0($,X,Z)?Z:O8($,X)},q4=function($,X,Z){if(Z0($,X,Z))return B0(Z);const Q=d(Z)?B0(Z):O8($,X),W=T($.minItems)&&Q.length<$.minItems?[...Q,...Array.from({length:$.minItems-Q.length},()=>null)]:Q,J=(T($.maxItems)&&W.length>$.maxItems?W.slice(0,$.maxItems):W).map((B)=>e8($.items,X,B));if($.uniqueItems!==!0)return J;const z=[...new Set(J)];if(!Z0($,X,z))throw new dX($,"Array cast produced invalid data due to uniqueItems constraint");return z},M4=function($,X,Z){if(Z0($,X,Z))return O8($,X);const Q=new Set($.returns.required||[]),W=function(){};for(let[Y,J]of Object.entries($.returns.properties)){if(!Q.has(Y)&&Z.prototype[Y]===void 0)continue;W.prototype[Y]=e8(J,X,Z.prototype[Y])}return W},U4=function($,X,Z){const Q=O8($,X),W=A0(Q)&&A0(Z)?{...Q,...Z}:Z;return Z0($,X,W)?W:O8($,X)},G4=function($,X,Z){throw new dX($,"Never types cannot be cast")},w4=function($,X,Z){if(Z0($,X,Z))return Z;if(Z===null||typeof Z!=="object")return O8($,X);const Q=new Set($.required||[]),W={};for(let[Y,J]of Object.entries($.properties)){if(!Q.has(Y)&&Z[Y]===void 0)continue;W[Y]=e8(J,X,Z[Y])}if(typeof $.additionalProperties==="object"){const Y=Object.getOwnPropertyNames($.properties);for(let J of Object.getOwnPropertyNames(Z)){if(Y.includes(J))continue;W[J]=e8($.additionalProperties,X,Z[J])}}return W},D4=function($,X,Z){if(Z0($,X,Z))return B0(Z);if(Z===null||typeof Z!=="object"||Array.isArray(Z)||Z instanceof Date)return O8($,X);const Q=Object.getOwnPropertyNames($.patternProperties)[0],W=$.patternProperties[Q],Y={};for(let[J,z]of Object.entries(Z))Y[J]=e8(W,X,z);return Y},A4=function($,X,Z){return e8(X0($,X),X,Z)},H4=function($,X,Z){return e8(X0($,X),X,Z)},N4=function($,X,Z){if(Z0($,X,Z))return B0(Z);if(!d(Z))return O8($,X);if($.items===void 0)return[];return $.items.map((Q,W)=>e8(Q,X,Z[W]))},O4=function($,X,Z){return Z0($,X,Z)?B0(Z):J4($,X,Z)},e8=function($,X,Z){const Q=h($.$id)?[...X,$]:X,W=$;switch($[H]){case"Array":return q4(W,Q,Z);case"Constructor":return M4(W,Q,Z);case"Intersect":return U4(W,Q,Z);case"Never":return G4(W,Q,Z);case"Object":return w4(W,Q,Z);case"Record":return D4(W,Q,Z);case"Ref":return A4(W,Q,Z);case"This":return H4(W,Q,Z);case"Tuple":return N4(W,Q,Z);case"Union":return O4(W,Q,Z);case"Date":case"Symbol":case"Uint8Array":return z4($,X,Z);default:return B4(W,Q,Z)}};function b6(...$){return $.length===3?e8($[0],$[1],$[2]):e8($[0],[],$[1])}class dX extends v{schema;constructor($,X){super(X);this.schema=$}}var L4=function($){return p($)&&$[H]!=="Unsafe"},P4=function($,X,Z){if(!d(Z))return Z;return Z.map((Q)=>L8($.items,X,Q))},_4=function($,X,Z){const Q=$.unevaluatedProperties,Y=$.allOf.map((z)=>L8(z,X,B0(Z))).reduce((z,B)=>h0(B)?{...z,...B}:B,{});if(!h0(Z)||!h0(Y)||!p(Q))return Y;const J=J8($);for(let z of Object.getOwnPropertyNames(Z)){if(J.includes(z))continue;if(Z0(Q,X,Z[z]))Y[z]=L8(Q,X,Z[z])}return Y},F4=function($,X,Z){if(!h0(Z)||d(Z))return Z;const Q=$.additionalProperties;for(let W of Object.getOwnPropertyNames(Z)){if(W in $.properties){Z[W]=L8($.properties[W],X,Z[W]);continue}if(p(Q)&&Z0(Q,X,Z[W])){Z[W]=L8(Q,X,Z[W]);continue}delete Z[W]}return Z},S4=function($,X,Z){if(!h0(Z))return Z;const Q=$.additionalProperties,W=Object.getOwnPropertyNames(Z),[Y,J]=Object.entries($.patternProperties)[0],z=new RegExp(Y);for(let B of W){if(z.test(B)){Z[B]=L8(J,X,Z[B]);continue}if(p(Q)&&Z0(Q,X,Z[B])){Z[B]=L8(Q,X,Z[B]);continue}delete Z[B]}return Z},K4=function($,X,Z){return L8(X0($,X),X,Z)},j4=function($,X,Z){return L8(X0($,X),X,Z)},R4=function($,X,Z){if(!d(Z))return Z;if(F0($.items))return[];const Q=Math.min(Z.length,$.items.length);for(let W=0;W<Q;W++)Z[W]=L8($.items[W],X,Z[W]);return Z.length>Q?Z.slice(0,Q):Z},C4=function($,X,Z){for(let Q of $.anyOf)if(L4(Q)&&Z0(Q,X,Z))return L8(Q,X,Z);return Z},L8=function($,X,Z){const Q=h($.$id)?[...X,$]:X,W=$;switch(W[H]){case"Array":return P4(W,Q,Z);case"Intersect":return _4(W,Q,Z);case"Object":return F4(W,Q,Z);case"Record":return S4(W,Q,Z);case"Ref":return K4(W,Q,Z);case"This":return j4(W,Q,Z);case"Tuple":return R4(W,Q,Z);case"Union":return C4(W,Q,Z);default:return Z}};function vX(...$){return $.length===3?L8($[0],$[1],$[2]):L8($[0],[],$[1])}var V6=function($){return h($)&&!isNaN($)&&!isNaN(parseFloat($))},b4=function($){return u0($)||l8($)||T($)},l1=function($){return $===!0||T($)&&$===1||u0($)&&$===BigInt("1")||h($)&&($.toLowerCase()==="true"||$==="1")},n1=function($){return $===!1||T($)&&($===0||Object.is($,-0))||u0($)&&$===BigInt("0")||h($)&&($.toLowerCase()==="false"||$==="0"||$==="-0")},V4=function($){return h($)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test($)},E4=function($){return h($)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test($)},I4=function($){return h($)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test($)},x4=function($){return h($)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test($)},k4=function($){return h($)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test($)},T4=function($,X){const Z=p2($);return Z===X?Z:$},g4=function($,X){const Z=m2($);return Z===X?Z:$},f4=function($,X){const Z=v2($);return Z===X?Z:$},y4=function($,X){return h($.const)?T4(X,$.const):T($.const)?g4(X,$.const):l8($.const)?f4(X,$.const):B0(X)},v2=function($){return l1($)?!0:n1($)?!1:$},d4=function($){return V6($)?BigInt(parseInt($)):T($)?BigInt($|0):n1($)?BigInt(0):l1($)?BigInt(1):$},p2=function($){return b4($)?$.toString():Z8($)&&$.description!==void 0?$.description.toString():$},m2=function($){return V6($)?parseFloat($):l1($)?1:n1($)?0:$},v4=function($){return V6($)?parseInt($):T($)?$|0:l1($)?1:n1($)?0:$},p4=function($){return h($)&&$.toLowerCase()==="null"?null:$},m4=function($){return h($)&&$==="undefined"?void 0:$},h4=function($){return B8($)?$:T($)?new Date($):l1($)?new Date(1):n1($)?new Date(0):V6($)?new Date(parseInt($)):E4($)?new Date(`1970-01-01T${$}.000Z`):V4($)?new Date(`1970-01-01T${$}`):x4($)?new Date(`${$}.000Z`):I4($)?new Date($):k4($)?new Date(`${$}T00:00:00.000Z`):$},u4=function($){return $},c4=function($,X,Z){return(d(Z)?Z:[Z]).map((W)=>$$($.items,X,W))},i4=function($,X,Z){return d4(Z)},o4=function($,X,Z){return v2(Z)},l4=function($,X,Z){return h4(Z)},n4=function($,X,Z){return v4(Z)},t4=function($,X,Z){return $.allOf.reduce((Q,W)=>$$(W,X,Q),Z)},s4=function($,X,Z){return y4($,Z)},r4=function($,X,Z){return p4(Z)},a4=function($,X,Z){return m2(Z)},e4=function($,X,Z){if(!h0(Z))return Z;const W={};for(let Y of Object.keys(Z))W[Y]=u($.properties,Y)?$$($.properties[Y],X,Z[Y]):Z[Y];return W},$B=function($,X,Z){const Q=Object.getOwnPropertyNames($.patternProperties)[0],W=$.patternProperties[Q],Y={};for(let[J,z]of Object.entries(Z))Y[J]=$$(W,X,z);return Y},XB=function($,X,Z){return $$(X0($,X),X,Z)},ZB=function($,X,Z){return p2(Z)},QB=function($,X,Z){return h(Z)||T(Z)?Symbol(Z):Z},WB=function($,X,Z){return $$(X0($,X),X,Z)},YB=function($,X,Z){if(!(d(Z)&&!F0($.items)))return Z;return Z.map((W,Y)=>{return Y<$.items.length?$$($.items[Y],X,W):W})},JB=function($,X,Z){return m4(Z)},zB=function($,X,Z){for(let Q of $.anyOf){const W=$$(Q,X,Z);if(!Z0(Q,X,W))continue;return W}return Z},$$=function($,X,Z){const Q=h($.$id)?[...X,$]:X,W=$;switch($[H]){case"Array":return c4(W,Q,Z);case"BigInt":return i4(W,Q,Z);case"Boolean":return o4(W,Q,Z);case"Date":return l4(W,Q,Z);case"Integer":return n4(W,Q,Z);case"Intersect":return t4(W,Q,Z);case"Literal":return s4(W,Q,Z);case"Null":return r4(W,Q,Z);case"Number":return a4(W,Q,Z);case"Object":return e4(W,Q,Z);case"Record":return $B(W,Q,Z);case"Ref":return XB(W,Q,Z);case"String":return ZB(W,Q,Z);case"Symbol":return QB(W,Q,Z);case"This":return WB(W,Q,Z);case"Tuple":return YB(W,Q,Z);case"Undefined":return JB(W,Q,Z);case"Union":return zB(W,Q,Z);default:return u4(Z)}};function pX(...$){return $.length===3?$$($[0],$[1],$[2]):$$($[0],[],$[1])}var x$=function($,X){return X===void 0&&"default"in $?B0($.default):X},BB=function($){return p($)&&$[H]!=="Unsafe"},E6=function($){return p($)&&"default"in $},qB=function($,X,Z){const Q=x$($,Z);if(!d(Q))return Q;for(let W=0;W<Q.length;W++)Q[W]=C8($.items,X,Q[W]);return Q},MB=function($,X,Z){const Q=x$($,Z);return $.allOf.reduce((W,Y)=>{const J=C8(Y,X,Q);return h0(J)?{...W,...J}:J},{})},UB=function($,X,Z){const Q=x$($,Z);if(!h0(Q))return Q;const W=$.additionalProperties,Y=Object.getOwnPropertyNames($.properties);for(let J of Y){if(!E6($.properties[J]))continue;Q[J]=C8($.properties[J],X,Q[J])}if(!E6(W))return Q;for(let J of Object.getOwnPropertyNames(Q)){if(Y.includes(J))continue;Q[J]=C8(W,X,Q[J])}return Q},GB=function($,X,Z){const Q=x$($,Z);if(!h0(Q))return Q;const W=$.additionalProperties,[Y,J]=Object.entries($.patternProperties)[0],z=new RegExp(Y);for(let B of Object.getOwnPropertyNames(Q)){if(!(z.test(B)&&E6(J)))continue;Q[B]=C8(J,X,Q[B])}if(!E6(W))return Q;for(let B of Object.getOwnPropertyNames(Q)){if(z.test(B))continue;Q[B]=C8(W,X,Q[B])}return Q},wB=function($,X,Z){return C8(X0($,X),X,x$($,Z))},DB=function($,X,Z){return C8(X0($,X),X,Z)},AB=function($,X,Z){const Q=x$($,Z);if(!d(Q)||F0($.items))return Q;const[W,Y]=[$.items,Math.max($.items.length,Q.length)];for(let J=0;J<Y;J++)if(J<W.length)Q[J]=C8(W[J],X,Q[J]);return Q},HB=function($,X,Z){const Q=x$($,Z);for(let W of $.anyOf){const Y=C8(W,X,Q);if(BB(W)&&Z0(W,Y))return Y}return Q},C8=function($,X,Z){const Q=h($.$id)?[...X,$]:X,W=$;switch(W[H]){case"Array":return qB(W,Q,Z);case"Intersect":return MB(W,Q,Z);case"Object":return UB(W,Q,Z);case"Record":return GB(W,Q,Z);case"Ref":return wB(W,Q,Z);case"This":return DB(W,Q,Z);case"Tuple":return AB(W,Q,Z);case"Union":return HB(W,Q,Z);default:return x$(W,Z)}};function mX(...$){return $.length===3?C8($[0],$[1],$[2]):C8($[0],[],$[1])}var u8={};y8(u8,{ValuePointerRootSetError:()=>{{return hX}},ValuePointerRootDeleteError:()=>{{return uX}},Set:()=>{{return NB}},Has:()=>{{return LB}},Get:()=>{{return PB}},Format:()=>{{return t1}},Delete:()=>{{return OB}}});var h2=function($){return $.indexOf("~")===-1?$:$.replace(/~1/g,"/").replace(/~0/g,"~")};function*t1($){if($==="")return;let[X,Z]=[0,0];for(let Q=0;Q<$.length;Q++)if($.charAt(Q)==="/")if(Q===0)X=Q+1;else Z=Q,yield h2($.slice(X,Z)),X=Q+1;else Z=Q;yield h2($.slice(X))}function NB($,X,Z){if(X==="")throw new hX($,X,Z);let[Q,W,Y]=[null,$,""];for(let J of t1(X)){if(W[J]===void 0)W[J]={};Q=W,W=W[J],Y=J}Q[Y]=Z}function OB($,X){if(X==="")throw new uX($,X);let[Z,Q,W]=[null,$,""];for(let Y of t1(X)){if(Q[Y]===void 0||Q[Y]===null)return;Z=Q,Q=Q[Y],W=Y}if(Array.isArray(Z)){const Y=parseInt(W);Z.splice(Y,1)}else delete Z[W]}function LB($,X){if(X==="")return!0;let[Z,Q,W]=[null,$,""];for(let Y of t1(X)){if(Q[Y]===void 0)return!1;Z=Q,Q=Q[Y],W=Y}return Object.getOwnPropertyNames(Z).includes(W)}function PB($,X){if(X==="")return $;let Z=$;for(let Q of t1(X)){if(Z[Q]===void 0)return;Z=Z[Q]}return Z}class hX extends v{value;path;update;constructor($,X,Z){super("Cannot set root value");this.value=$,this.path=X,this.update=Z}}class uX extends v{value;path;constructor($,X){super("Cannot delete root value");this.value=$,this.path=X}}var r1=function($,X){return{type:"update",path:$,value:X}},u2=function($,X){return{type:"insert",path:$,value:X}},c2=function($){return{type:"delete",path:$}};function*KB($,X,Z){if(!A0(Z))return yield r1($,Z);const Q=[...globalThis.Object.keys(X),...globalThis.Object.getOwnPropertySymbols(X)],W=[...globalThis.Object.keys(Z),...globalThis.Object.getOwnPropertySymbols(Z)];for(let Y of Q){if(Z8(Y))throw new s1(Y);if(F0(Z[Y])&&W.includes(Y))yield r1(`${$}/${globalThis.String(Y)}`,void 0)}for(let Y of W){if(F0(X[Y])||F0(Z[Y]))continue;if(Z8(Y))throw new s1(Y);yield*I6(`${$}/${globalThis.String(Y)}`,X[Y],Z[Y])}for(let Y of W){if(Z8(Y))throw new s1(Y);if(F0(X[Y]))yield u2(`${$}/${globalThis.String(Y)}`,Z[Y])}for(let Y of Q.reverse()){if(Z8(Y))throw new s1(Y);if(F0(Z[Y])&&!W.includes(Y))yield c2(`${$}/${globalThis.String(Y)}`)}}function*jB($,X,Z){if(!d(Z))return yield r1($,Z);for(let Q=0;Q<Math.min(X.length,Z.length);Q++)yield*I6(`${$}/${Q}`,X[Q],Z[Q]);for(let Q=0;Q<Z.length;Q++){if(Q<X.length)continue;yield u2(`${$}/${Q}`,Z[Q])}for(let Q=X.length-1;Q>=0;Q--){if(Q<Z.length)continue;yield c2(`${$}/${Q}`)}}function*RB($,X,Z){if(!F8(Z)||X.length!==Z.length||globalThis.Object.getPrototypeOf(X).constructor.name!==globalThis.Object.getPrototypeOf(Z).constructor.name)return yield r1($,Z);for(let Q=0;Q<Math.min(X.length,Z.length);Q++)yield*I6(`${$}/${Q}`,X[Q],Z[Q])}function*CB($,X,Z){if(X===Z)return;yield r1($,Z)}function*I6($,X,Z){if(A0(X))return yield*KB($,X,Z);if(d(X))return yield*jB($,X,Z);if(F8(X))return yield*RB($,X,Z);if(q8(X))return yield*CB($,X,Z);throw new cX(X,"Unable to create diff edits for unknown value")}function i2($,X){return[...I6("",$,X)]}var bB=function($){return $.length>0&&$[0].path===""&&$[0].type==="update"},VB=function($){return $.length===0};function o2($,X){if(bB(X))return B0(X[0].value);if(VB(X))return B0($);const Z=B0($);for(let Q of X)switch(Q.type){case"insert":{u8.Set(Z,Q.path,Q.value);break}case"update":{u8.Set(Z,Q.path,Q.value);break}case"delete":{u8.Delete(Z,Q.path);break}}return Z}var _B=Y0({type:a("insert"),path:D8(),value:a8()}),FB=Y0({type:a("update"),path:D8(),value:a8()}),SB=Y0({type:a("delete"),path:D8()}),IP=W0([_B,FB,SB]);class cX extends v{value;constructor($,X){super(X);this.value=$}}class s1 extends cX{value;constructor($){super($,"Cannot diff objects with symbol keys");this.value=$}}var EB=function($,X){if(!A0(X))return!1;const Z=[...Object.keys($),...Object.getOwnPropertySymbols($)],Q=[...Object.keys(X),...Object.getOwnPropertySymbols(X)];if(Z.length!==Q.length)return!1;return Z.every((W)=>a1($[W],X[W]))},IB=function($,X){return B8(X)&&$.getTime()===X.getTime()},xB=function($,X){if(!d(X)||$.length!==X.length)return!1;return $.every((Z,Q)=>a1(Z,X[Q]))},kB=function($,X){if(!F8(X)||$.length!==X.length||Object.getPrototypeOf($).constructor.name!==Object.getPrototypeOf(X).constructor.name)return!1;return $.every((Z,Q)=>a1(Z,X[Q]))},TB=function($,X){return $===X};function a1($,X){if(A0($))return EB($,X);if(B8($))return IB($,X);if(F8($))return kB($,X);if(d($))return xB($,X);if(q8($))return TB($,X);throw new Error("ValueEquals: Unable to compare value")}var gB=function($,X,Z,Q){if(!A0(Z))u8.Set($,X,B0(Q));else{const W=Object.getOwnPropertyNames(Z),Y=Object.getOwnPropertyNames(Q);for(let J of W)if(!Y.includes(J))delete Z[J];for(let J of Y)if(!W.includes(J))Z[J]=null;for(let J of Y)oX($,`${X}/${J}`,Z[J],Q[J])}},fB=function($,X,Z,Q){if(!d(Z))u8.Set($,X,B0(Q));else{for(let W=0;W<Q.length;W++)oX($,`${X}/${W}`,Z[W],Q[W]);Z.splice(Q.length)}},yB=function($,X,Z,Q){if(F8(Z)&&Z.length===Q.length)for(let W=0;W<Z.length;W++)Z[W]=Q[W];else u8.Set($,X,B0(Q))},dB=function($,X,Z,Q){if(Z===Q)return;u8.Set($,X,Q)},oX=function($,X,Z,Q){if(d(Q))return fB($,X,Z,Q);if(F8(Q))return yB($,X,Z,Q);if(A0(Q))return gB($,X,Z,Q);if(q8(Q))return dB($,X,Z,Q)},l2=function($){return F8($)||q8($)},vB=function($,X){return A0($)&&d(X)||d($)&&A0(X)};function n2($,X){if(l2($)||l2(X))throw new iX("Only object and array types can be mutated at the root level");if(vB($,X))throw new iX("Cannot assign due type mismatch of assignable values");oX($,"",$,X)}class iX extends v{constructor($){super($)}}var K0=function($,X,Z){try{return O0($)?$[I0].Decode(Z):Z}catch(Q){throw new t2($,X,Z,Q)}},pB=function($,X,Z,Q){return d(Q)?K0($,Z,Q.map((W,Y)=>X$($.items,X,`${Z}/${Y}`,W))):K0($,Z,Q)},mB=function($,X,Z,Q){if(!A0(Q)||q8(Q))return K0($,Z,Q);const W=J8($),Y={...Q};for(let M of W)if(M in Y)Y[M]=X$(m8($,[M]),X,`${Z}/${M}`,Y[M]);if(!O0($.unevaluatedProperties))return K0($,Z,Y);const J=Object.getOwnPropertyNames(Y),z=$.unevaluatedProperties,B={...Y};for(let M of J)if(!W.includes(M))B[M]=K0(z,`${Z}/${M}`,B[M]);return K0($,Z,B)},hB=function($,X,Z,Q){return K0($,Z,X$($.not,X,Z,Q))},uB=function($,X,Z,Q){if(!A0(Q))return K0($,Z,Q);const W=J8($),Y={...Q};for(let M of W)if(M in Y)Y[M]=X$($.properties[M],X,`${Z}/${M}`,Y[M]);if(!p($.additionalProperties))return K0($,Z,Y);const J=Object.getOwnPropertyNames(Y),z=$.additionalProperties,B={...Y};for(let M of J)if(!W.includes(M))B[M]=K0(z,`${Z}/${M}`,B[M]);return K0($,Z,B)},cB=function($,X,Z,Q){if(!A0(Q))return K0($,Z,Q);const W=Object.getOwnPropertyNames($.patternProperties)[0],Y=new RegExp(W),J={...Q};for(let q of Object.getOwnPropertyNames(Q))if(Y.test(q))J[q]=X$($.patternProperties[W],X,`${Z}/${q}`,J[q]);if(!p($.additionalProperties))return K0($,Z,J);const z=Object.getOwnPropertyNames(J),B=$.additionalProperties,M={...J};for(let q of z)if(!Y.test(q))M[q]=K0(B,`${Z}/${q}`,M[q]);return K0($,Z,M)},iB=function($,X,Z,Q){const W=X0($,X);return K0($,Z,X$(W,X,Z,Q))},oB=function($,X,Z,Q){const W=X0($,X);return K0($,Z,X$(W,X,Z,Q))},lB=function($,X,Z,Q){return d(Q)&&d($.items)?K0($,Z,$.items.map((W,Y)=>X$(W,X,`${Z}/${Y}`,Q[Y]))):K0($,Z,Q)},nB=function($,X,Z,Q){for(let W of $.anyOf){if(!Z0(W,X,Q))continue;const Y=X$(W,X,Z,Q);return K0($,Z,Y)}return K0($,Z,Q)},X$=function($,X,Z,Q){const W=typeof $.$id==="string"?[...X,$]:X,Y=$;switch($[H]){case"Array":return pB(Y,W,Z,Q);case"Intersect":return mB(Y,W,Z,Q);case"Not":return hB(Y,W,Z,Q);case"Object":return uB(Y,W,Z,Q);case"Record":return cB(Y,W,Z,Q);case"Ref":return iB(Y,W,Z,Q);case"Symbol":return K0(Y,Z,Q);case"This":return oB(Y,W,Z,Q);case"Tuple":return lB(Y,W,Z,Q);case"Union":return nB(Y,W,Z,Q);default:return K0(Y,Z,Q)}};function x6($,X,Z){return X$($,X,"",Z)}class e1 extends v{schema;value;error;constructor($,X,Z){super("Unable to decode value as it does not match the expected schema");this.schema=$,this.value=X,this.error=Z}}class t2 extends v{schema;path;value;error;constructor($,X,Z,Q){super(Q instanceof Error?Q.message:"Unknown error");this.schema=$,this.path=X,this.value=Z,this.error=Q}}var d0=function($,X,Z){try{return O0($)?$[I0].Encode(Z):Z}catch(Q){throw new s2($,X,Z,Q)}},tB=function($,X,Z,Q){const W=d0($,Z,Q);return d(W)?W.map((Y,J)=>Z$($.items,X,`${Z}/${J}`,Y)):W},sB=function($,X,Z,Q){const W=d0($,Z,Q);if(!A0(Q)||q8(Q))return W;const Y=J8($),J={...W};for(let q of Y)if(q in J)J[q]=Z$(m8($,[q]),X,`${Z}/${q}`,J[q]);if(!O0($.unevaluatedProperties))return d0($,Z,J);const z=Object.getOwnPropertyNames(J),B=$.unevaluatedProperties,M={...J};for(let q of z)if(!Y.includes(q))M[q]=d0(B,`${Z}/${q}`,M[q]);return M},rB=function($,X,Z,Q){return d0($.not,Z,d0($,Z,Q))},aB=function($,X,Z,Q){const W=d0($,Z,Q);if(!A0(Q))return W;const Y=J8($),J={...W};for(let q of Y)if(q in Q)J[q]=Z$($.properties[q],X,`${Z}/${q}`,J[q]);if(!p($.additionalProperties))return J;const z=Object.getOwnPropertyNames(J),B=$.additionalProperties,M={...J};for(let q of z)if(!Y.includes(q))M[q]=d0(B,`${Z}/${q}`,M[q]);return M},eB=function($,X,Z,Q){const W=d0($,Z,Q);if(!A0(Q))return W;const Y=Object.getOwnPropertyNames($.patternProperties)[0],J=new RegExp(Y),z={...W};for(let U of Object.getOwnPropertyNames(Q))if(J.test(U))z[U]=Z$($.patternProperties[Y],X,`${Z}/${U}`,z[U]);if(!p($.additionalProperties))return d0($,Z,z);const B=Object.getOwnPropertyNames(z),M=$.additionalProperties,q={...z};for(let U of B)if(!J.test(U))q[U]=d0(M,`${Z}/${U}`,q[U]);return q},$q=function($,X,Z,Q){const W=X0($,X),Y=Z$(W,X,Z,Q);return d0($,Z,Y)},Xq=function($,X,Z,Q){const W=X0($,X),Y=Z$(W,X,Z,Q);return d0($,Z,Y)},Zq=function($,X,Z,Q){const W=d0($,Z,Q);return d($.items)?$.items.map((Y,J)=>Z$(Y,X,`${Z}/${J}`,W[J])):[]},Qq=function($,X,Z,Q){for(let W of $.anyOf){if(!Z0(W,X,Q))continue;const Y=Z$(W,X,Z,Q);return d0($,Z,Y)}for(let W of $.anyOf){const Y=Z$(W,X,Z,Q);if(!Z0($,X,Y))continue;return d0($,Z,Y)}return d0($,Z,Q)},Z$=function($,X,Z,Q){const W=typeof $.$id==="string"?[...X,$]:X,Y=$;switch($[H]){case"Array":return tB(Y,W,Z,Q);case"Intersect":return sB(Y,W,Z,Q);case"Not":return rB(Y,W,Z,Q);case"Object":return aB(Y,W,Z,Q);case"Record":return eB(Y,W,Z,Q);case"Ref":return $q(Y,W,Z,Q);case"This":return Xq(Y,W,Z,Q);case"Tuple":return Zq(Y,W,Z,Q);case"Union":return Qq(Y,W,Z,Q);default:return d0(Y,Z,Q)}};function k6($,X,Z){return Z$($,X,"",Z)}class $6 extends v{schema;value;error;constructor($,X,Z){super("The encoded value does not match the expected schema");this.schema=$,this.value=X,this.error=Z}}class s2 extends v{schema;path;value;error;constructor($,X,Z,Q){super(`${Q instanceof Error?Q.message:"Unknown error"}`);this.schema=$,this.path=X,this.value=Z,this.error=Q}}var Wq=function($,X){return O0($)||v0($.items,X)},Yq=function($,X){return O0($)||v0($.items,X)},Jq=function($,X){return O0($)||v0($.returns,X)||$.parameters.some((Z)=>v0(Z,X))},zq=function($,X){return O0($)||v0($.returns,X)||$.parameters.some((Z)=>v0(Z,X))},Bq=function($,X){return O0($)||O0($.unevaluatedProperties)||$.allOf.some((Z)=>v0(Z,X))},qq=function($,X){return O0($)||v0($.items,X)},Mq=function($,X){return O0($)||v0($.not,X)},Uq=function($,X){return O0($)||Object.values($.properties).some((Z)=>v0(Z,X))||p($.additionalProperties)&&v0($.additionalProperties,X)},Gq=function($,X){return O0($)||v0($.item,X)},wq=function($,X){const Z=Object.getOwnPropertyNames($.patternProperties)[0],Q=$.patternProperties[Z];return O0($)||v0(Q,X)||p($.additionalProperties)&&O0($.additionalProperties)},Dq=function($,X){if(O0($))return!0;return v0(X0($,X),X)},Aq=function($,X){if(O0($))return!0;return v0(X0($,X),X)},Hq=function($,X){return O0($)||!F0($.items)&&$.items.some((Z)=>v0(Z,X))},Nq=function($,X){return O0($)||$.anyOf.some((Z)=>v0(Z,X))},v0=function($,X){const Z=h($.$id)?[...X,$]:X,Q=$;if($.$id&&lX.has($.$id))return!1;if($.$id)lX.add($.$id);switch($[H]){case"Array":return Wq(Q,Z);case"AsyncIterator":return Yq(Q,Z);case"Constructor":return Jq(Q,Z);case"Function":return zq(Q,Z);case"Intersect":return Bq(Q,Z);case"Iterator":return qq(Q,Z);case"Not":return Mq(Q,Z);case"Object":return Uq(Q,Z);case"Promise":return Gq(Q,Z);case"Record":return wq(Q,Z);case"Ref":return Dq(Q,Z);case"This":return Aq(Q,Z);case"Tuple":return Hq(Q,Z);case"Union":return Nq(Q,Z);default:return O0($)}};function r2($,X){return lX.clear(),v0($,X)}var lX=new Set;var w0={};y8(w0,{Patch:()=>{{return Vq}},Mutate:()=>{{return Eq}},Hash:()=>{{return bq}},Errors:()=>{{return tX}},Equal:()=>{{return Rq}},Encode:()=>{{return jq}},Diff:()=>{{return Cq}},Default:()=>{{return Kq}},Decode:()=>{{return Sq}},Create:()=>{{return Lq}},Convert:()=>{{return _q}},Clone:()=>{{return Fq}},Clean:()=>{{return Pq}},Check:()=>{{return nX}},Cast:()=>{{return Oq}}});function Oq(...$){return b6.apply(b6,$)}function Lq(...$){return O8.apply(O8,$)}function nX(...$){return Z0.apply(Z0,$)}function Pq(...$){return vX.apply(vX,$)}function _q(...$){return pX.apply(pX,$)}function Fq($){return B0($)}function Sq(...$){const[X,Z,Q]=$.length===3?[$[0],$[1],$[2]]:[$[0],[],$[1]];if(!nX(X,Z,Q))throw new e1(X,Q,tX(X,Z,Q).First());return x6(X,Z,Q)}function Kq(...$){return mX.apply(mX,$)}function jq(...$){const[X,Z,Q]=$.length===3?[$[0],$[1],$[2]]:[$[0],[],$[1]],W=k6(X,Z,Q);if(!nX(X,Z,W))throw new $6(X,W,tX(X,Z,W).First());return W}function tX(...$){return c1.apply(c1,$)}function Rq($,X){return a1($,X)}function Cq($,X){return i2($,X)}function bq($){return E$($)}function Vq($,X){return o2($,X)}function Eq($,X){n2($,X)}var a2=function($){return $.map((X)=>sX(X))},Iq=function($){return e0(a2($))},xq=function($){return W0(a2($))},kq=function($){return sX($)},sX=function($){return x0($)?Iq($.allOf):r($)?xq($.anyOf):y$($)?kq($.item):$};function rX($,X={}){return S(sX($),X)}var Tq=function($){const X=[];for(let Z of $)X.push(...J8(Z));return KQ(X)},gq=function($){return $.filter((X)=>!Q1(X))},fq=function($,X){const Z=[];for(let Q of $)Z.push(...RX(Q,[X]));return gq(Z)},yq=function($,X){const Z={};for(let Q of X)Z[Q]=F6(fq($,Q));return Z};function aX($,X={}){const Z=Tq($),Q=yq($,Z);return Y0(Q,X)}function X6($={}){return{...$,[H]:"Date",type:"Date"}}function Z6($={}){return{...$,[H]:"Null",type:"null"}}function Q6($){return{...$,[H]:"Symbol",type:"symbol"}}function W6($={}){return{...$,[H]:"Undefined",type:"undefined"}}function Y6($={}){return{...$,[H]:"Uint8Array",type:"Uint8Array"}}var dq=function($){return $.map((X)=>eX(X,!1))},vq=function($){const X={};for(let Z of globalThis.Object.getOwnPropertyNames($))X[Z]=A8(eX($[Z],!1));return X},T6=function($,X){return X===!0?$:A8($)},eX=function($,X){return UX($)?T6(F$(),X):wX($)?T6(F$(),X):Q8($)?A8(h8(dq($))):T$($)?Y6():j1($)?X6():H0($)?T6(Y0(vq($)),X):GX($)?T6(D$([],a8()),X):S0($)?W6():DX($)?Z6():HX($)?Q6():K1($)?v$():d8($)?a($):b$($)?a($):N0($)?a($):Y0({})};function $Z($,X={}){return S(eX($,!0),X)}function XZ($,X={}){return h8(C0($.parameters),{...X})}var J6=function($,X){return $.map((Z)=>b8(Z,X))},pq=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames($))Z[Q]=b8($[Q],X);return Z},mq=function($,X){return $.parameters=J6($.parameters,X),$.returns=b8($.returns,X),$},hq=function($,X){return $.parameters=J6($.parameters,X),$.returns=b8($.returns,X),$},uq=function($,X){return $.allOf=J6($.allOf,X),$},cq=function($,X){return $.anyOf=J6($.anyOf,X),$},iq=function($,X){if(S0($.items))return $;return $.items=J6($.items,X),$},oq=function($,X){return $.items=b8($.items,X),$},lq=function($,X){return $.properties=pq($.properties,X),$},nq=function($,X){return $.item=b8($.item,X),$},tq=function($,X){return $.items=b8($.items,X),$},sq=function($,X){return $.items=b8($.items,X),$},rq=function($,X){const Z=X.find((W)=>W.$id===$.$ref);if(Z===void 0)throw Error(`Unable to dereference schema with \$id ${$.$ref}`);const Q=b0(Z,["$id"]);return b8(Q,X)},aq=function($,X){return E1($)?mq($,X):I1($)?hq($,X):x0($)?uq($,X):r($)?cq($,X):v8($)?iq($,X):A$($)?oq($,X):f0($)?lq($,X):y$($)?nq($,X):V1($)?tq($,X):x1($)?sq($,X):PX($)?rq($,X):$};function b8($,X){return aq(S($),C0(X))}function ZZ($,X={}){if(S0($))throw new Error("Enum undefined or empty");const Z=globalThis.Object.getOwnPropertyNames($).filter((Y)=>isNaN(Y)).map((Y)=>$[Y]),W=[...new Set(Z)].map((Y)=>a(Y));return W0(W,{...X,[M8]:"Enum"})}function e2($,X){return h$(p$($),X)}var eq=function($,X){const Z=$.filter((Q)=>I$(Q,X)===L.False);return Z.length===1?Z[0]:W0(Z)};function h$($,X,Z={}){if(G8($))return S(e2($,X),Z);if(P0($))return S($W($,X),Z);return S(r($)?eq($.anyOf,X):I$($,X)!==L.False?Q0():$,Z)}var $M=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames($))Z[Q]=h$($[Q],X);return Z},XM=function($,X){return $M($.properties,X)};function $W($,X){const Z=XM($,X);return n(Z)}function XW($,X){return u$(p$($),X)}var ZM=function($,X){const Z=$.filter((Q)=>I$(Q,X)!==L.False);return Z.length===1?Z[0]:W0(Z)};function u$($,X,Z={}){if(G8($))return S(XW($,X),Z);if(P0($))return S(ZW($,X),Z);return S(r($)?ZM($.anyOf,X):I$($,X)!==L.False?$:Q0(),Z)}var QM=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames($))Z[Q]=u$($[Q],X);return Z},WM=function($,X){return QM($.properties,X)};function ZW($,X){const Z=WM($,X);return n(Z)}function QZ($,X={}){return S($.returns,X)}function WZ($={}){return{...$,[H]:"Integer",type:"integer"}}var YM=function($,X,Z){return{[$]:c8(a($),X,Z)}},JM=function($,X,Z){return $.reduce((Q,W)=>{return{...Q,...YM(W,X,Z)}},{})},zM=function($,X,Z){return JM($.keys,X,Z)};function QW($,X,Z){const Q=zM($,X,Z);return n(Q)}var BM=function($){const[X,Z]=[$.slice(0,1),$.slice(1)];return[X.toLowerCase(),Z].join("")},qM=function($){const[X,Z]=[$.slice(0,1),$.slice(1)];return[X.toUpperCase(),Z].join("")},MM=function($){return $.toUpperCase()},UM=function($){return $.toLowerCase()},GM=function($,X,Z){const Q=J1($.pattern);if(!d$(Q))return{...$,pattern:WW($.pattern,X)};const J=[...y1(Q)].map((M)=>a(M)),z=YW(J,X),B=W0(z);return v1([B],Z)},WW=function($,X){return typeof $==="string"?X==="Uncapitalize"?BM($):X==="Capitalize"?qM($):X==="Uppercase"?MM($):X==="Lowercase"?UM($):$:$.toString()},YW=function($,X){return $.map((Z)=>c8(Z,X))};function c8($,X,Z={}){return U8($)?QW($,X,Z):G8($)?GM($,X,$):r($)?W0(YW($.anyOf,X),Z):H$($)?a(WW($.const,X),Z):$}function YZ($,X={}){return c8($,"Capitalize",X)}function JZ($,X={}){return c8($,"Lowercase",X)}function zZ($,X={}){return c8($,"Uncapitalize",X)}function BZ($,X={}){return c8($,"Uppercase",X)}function qZ($,X){return{...X,[H]:"Not",not:S($)}}var wM=function($,X,Z){const Q={};for(let W of globalThis.Object.getOwnPropertyNames($))Q[W]=c$($[W],X,Z);return Q},DM=function($,X,Z){return wM($.properties,X,Z)};function JW($,X,Z){const Q=DM($,X,Z);return n(Q)}var AM=function($,X){return $.map((Z)=>MZ(Z,X))},HM=function($,X){return $.map((Z)=>MZ(Z,X))},NM=function($,X){const{[X]:Z,...Q}=$;return Q},OM=function($,X){return X.reduce((Z,Q)=>NM(Z,Q),$)},MZ=function($,X){return x0($)?e0(AM($.allOf,X)):r($)?W0(HM($.anyOf,X)):f0($)?Y0(OM($.properties,X)):Y0({})};function c$($,X,Z={}){if(U8(X))return zW($,X,Z);if(P0($))return JW($,X,Z);const Q=w8(X)?Y8(X):X,W=b0($,[I0,"$id","required"]),Y=S(MZ($,Q),Z);return{...W,...Y}}var LM=function($,X,Z){return{[X]:c$($,[X],Z)}},PM=function($,X,Z){return X.reduce((Q,W)=>{return{...Q,...LM($,W,Z)}},{})},_M=function($,X,Z){return PM($,X.keys,Z)};function zW($,X,Z){const Q=_M($,X,Z);return n(Q)}function UZ($,X={}){return h8(C0($.parameters),{...X})}var BW=function($){return $.map((X)=>qW(X))},FM=function($){const X={};for(let Z of globalThis.Object.getOwnPropertyNames($))X[Z]=a0($[Z]);return X},qW=function($){return x0($)?e0(BW($.allOf)):r($)?W0(BW($.anyOf)):f0($)?Y0(FM($.properties)):Y0({})};function z6($,X={}){if(P0($))return MW($,X);const Z=b0($,[I0,"$id","required"]),Q=S(qW($),X);return{...Z,...Q}}var SM=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames($))Z[Q]=z6($[Q],X);return Z},KM=function($,X){return SM($.properties,X)};function MW($,X){const Z=KM($,X);return n(Z)}var jM=function($,X,Z){const Q={};for(let W of globalThis.Object.getOwnPropertyNames($))Q[W]=i$($[W],X,Z);return Q},RM=function($,X,Z){return jM($.properties,X,Z)};function UW($,X,Z){const Q=RM($,X,Z);return n(Q)}var CM=function($,X){return $.map((Z)=>GZ(Z,X))},bM=function($,X){return $.map((Z)=>GZ(Z,X))},VM=function($,X){const Z={};for(let Q of X)if(Q in $)Z[Q]=$[Q];return Z},GZ=function($,X){return x0($)?e0(CM($.allOf,X)):r($)?W0(bM($.anyOf,X)):f0($)?Y0(VM($.properties,X)):Y0({})};function i$($,X,Z={}){if(U8(X))return GW($,X,Z);if(P0($))return UW($,X,Z);const Q=w8(X)?Y8(X):X,W=b0($,[I0,"$id","required"]),Y=S(GZ($,Q),Z);return{...W,...Y}}var EM=function($,X,Z){return{[X]:i$($,[X],Z)}},IM=function($,X,Z){return X.reduce((Q,W)=>{return{...Q,...EM($,W,Z)}},{})},xM=function($,X,Z){return IM($,X.keys,Z)};function GW($,X,Z){const Q=xM($,X,Z);return n(Q)}function wZ($){return A8(a0($))}var B6=function($,X,Z){return{...Z,[H]:"Record",type:"object",patternProperties:{[$]:S(X)}}},DZ=function($,X,Z){const Q={};for(let W of $)Q[W]=S(X);return Y0(Q,{...Z,[M8]:"Record"})},kM=function($,X,Z){return S6($)?DZ(Y8($),X,Z):B6($.pattern,X,Z)},TM=function($,X,Z){return DZ(Y8(W0($)),X,Z)},gM=function($,X,Z){return DZ([$.toString()],X,Z)},fM=function($,X,Z){return B6($.source,X,Z)},yM=function($,X,Z){const Q=S0($.pattern)?V$:$.pattern;return B6(Q,X,Z)},dM=function($,X,Z){return B6(O$,X,Z)},vM=function($,X,Z){return B6(O$,X,Z)};function AZ($,X,Z={}){return r($)?TM($.anyOf,X,Z):G8($)?kM($,X,Z):H$($)?gM($.const,X,Z):g$($)?dM($,X,Z):f$($)?vM($,X,Z):_X($)?fM($,X,Z):k1($)?yM($,X,Z):Q0(Z)}function HZ($,X={}){if(S0(X.$id))X.$id=`T${pM++}`;const Z=$({[H]:"This",$ref:`${X.$id}`});return Z.$id=X.$id,S({...X,[M8]:"Recursive",...Z})}var pM=0;function NZ($,X={}){if(N0($))return{...X,[H]:"Ref",$ref:$};if(S0($.$id))throw new Error("Reference target type must specify an $id");return{...X,[H]:"Ref",$ref:$.$id}}function OZ($,X={}){const Z=N0($)?new globalThis.RegExp($):$;return{...X,[H]:"RegExp",type:"RegExp",source:Z.source,flags:Z.flags}}var wW=function($){return $.map((X)=>DW(X))},mM=function($){const X={};for(let Z of globalThis.Object.getOwnPropertyNames($))X[Z]=b0($[Z],[n0]);return X},DW=function($){return x0($)?e0(wW($.allOf)):r($)?W0(wW($.anyOf)):f0($)?Y0(mM($.properties)):Y0({})};function q6($,X={}){if(P0($))return AW($,X);else{const Z=b0($,[I0,"$id","required"]),Q=S(DW($),X);return{...Z,...Q}}}var hM=function($,X){const Z={};for(let Q of globalThis.Object.getOwnPropertyNames($))Z[Q]=q6($[Q],X);return Z},uM=function($,X){return hM($.properties,X)};function AW($,X){const Z=uM($,X);return n(Z)}var cM=function($){return x0($)?C0($.allOf):r($)?C0($.anyOf):v8($)?C0($.items??[]):[]};function LZ($){return C0(cM($))}function PZ($,X={}){return S($.returns,X)}function _Z($){return JSON.parse(JSON.stringify($))}function FZ($){return new HW($)}class HW{schema;constructor($){this.schema=$}Decode($){return new NW(this.schema,$)}}class NW{schema;decode;constructor($,X){this.schema=$,this.decode=X}EncodeTransform($,X){const W={Encode:(Y)=>X[I0].Encode($(Y)),Decode:(Y)=>this.decode(X[I0].Decode(Y))};return{...X,[I0]:W}}EncodeSchema($,X){const Z={Decode:this.decode,Encode:$};return{...X,[I0]:Z}}Encode($){const X=S(this.schema);return W1(X)?this.EncodeTransform($,X):this.EncodeSchema($,X)}}function SZ($={}){return{...$,[H]:"Void",type:"void"}}var KZ={};y8(KZ,{Void:()=>{{return SZ}},Uppercase:()=>{{return BZ}},Unsafe:()=>{{return S1}},Unknown:()=>{{return a8}},Union:()=>{{return W0}},Undefined:()=>{{return W6}},Uncapitalize:()=>{{return zZ}},Uint8Array:()=>{{return Y6}},Tuple:()=>{{return h8}},Transform:()=>{{return FZ}},TemplateLiteral:()=>{{return v1}},Symbol:()=>{{return Q6}},String:()=>{{return D8}},Strict:()=>{{return _Z}},ReturnType:()=>{{return PZ}},Rest:()=>{{return LZ}},Required:()=>{{return q6}},RegExp:()=>{{return OZ}},Ref:()=>{{return NZ}},Recursive:()=>{{return HZ}},Record:()=>{{return AZ}},ReadonlyOptional:()=>{{return wZ}},Readonly:()=>{{return A8}},Promise:()=>{{return m1}},Pick:()=>{{return i$}},Partial:()=>{{return z6}},Parameters:()=>{{return UZ}},Optional:()=>{{return a0}},Omit:()=>{{return c$}},Object:()=>{{return Y0}},Number:()=>{{return p8}},Null:()=>{{return Z6}},Not:()=>{{return qZ}},Never:()=>{{return Q0}},Mapped:()=>{{return CX}},Lowercase:()=>{{return JZ}},Literal:()=>{{return a}},KeyOf:()=>{{return u1}},Iterator:()=>{{return p1}},Intersect:()=>{{return e0}},Integer:()=>{{return WZ}},InstanceType:()=>{{return QZ}},Index:()=>{{return m8}},Function:()=>{{return D$}},Extract:()=>{{return u$}},Extends:()=>{{return m$}},Exclude:()=>{{return h$}},Enum:()=>{{return ZZ}},Deref:()=>{{return b8}},Date:()=>{{return X6}},ConstructorParameters:()=>{{return XZ}},Constructor:()=>{{return b1}},Const:()=>{{return $Z}},Composite:()=>{{return aX}},Capitalize:()=>{{return YZ}},Boolean:()=>{{return d1}},BigInt:()=>{{return v$}},Awaited:()=>{{return rX}},AsyncIterator:()=>{{return C1}},Array:()=>{{return R1}},Any:()=>{{return F$}}});var U1=KZ;class bZ{schema;references;checkFunc;code;hasTransform;constructor($,X,Z,Q){this.schema=$,this.references=X,this.checkFunc=Z,this.code=Q,this.hasTransform=r2($,X)}Code(){return this.code}Errors($){return c1(this.schema,this.references,$)}Check($){return this.checkFunc($)}Decode($){if(!this.checkFunc($))throw new e1(this.schema,$,this.Errors($).First());return this.hasTransform?x6(this.schema,this.references,$):$}Encode($){const X=this.hasTransform?k6(this.schema,this.references,$):$;if(!this.checkFunc(X))throw new $6(this.schema,$,this.Errors($).First());return X}}var S$;(function($){function X(Y){return Y===36}$.DollarSign=X;function Z(Y){return Y===95}$.IsUnderscore=Z;function Q(Y){return Y>=65&&Y<=90||Y>=97&&Y<=122}$.IsAlpha=Q;function W(Y){return Y>=48&&Y<=57}$.IsNumeric=W})(S$||(S$={}));var g6;(function($){function X(Y){if(Y.length===0)return!1;return S$.IsNumeric(Y.charCodeAt(0))}function Z(Y){if(X(Y))return!1;for(let J=0;J<Y.length;J++){const z=Y.charCodeAt(J);if(!(S$.IsAlpha(z)||S$.IsNumeric(z)||S$.DollarSign(z)||S$.IsUnderscore(z)))return!1}return!0}function Q(Y){return Y.replace(/'/g,"\\'")}function W(Y,J){return Z(J)?`${Y}.${J}`:`${Y}['${Q(J)}']`}$.Encode=W})(g6||(g6={}));var jZ;(function($){function X(Z){const Q=[];for(let W=0;W<Z.length;W++){const Y=Z.charCodeAt(W);if(S$.IsNumeric(Y)||S$.IsAlpha(Y))Q.push(Z.charAt(W));else Q.push(`_${Y}_`)}return Q.join("").replace(/__/g,"_")}$.Encode=X})(jZ||(jZ={}));var RZ;(function($){function X(Z){return Z.replace(/'/g,"\\'")}$.Escape=X})(RZ||(RZ={}));class OW extends v{schema;constructor($){super("Unknown type");this.schema=$}}class CZ extends v{schema;constructor($){super("Preflight validation check failed to guard for the given schema");this.schema=$}}var o$;(function($){function X(J,z,B){return V0.ExactOptionalPropertyTypes?`('${z}' in ${J} ? ${B} : true)`:`(${g6.Encode(J,z)} !== undefined ? ${B} : true)`}$.IsExactOptionalProperty=X;function Z(J){return!V0.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}))`:`(typeof ${J} === 'object' && ${J} !== null)`}$.IsObjectLike=Z;function Q(J){return!V0.AllowArrayObject?`(typeof ${J} === 'object' && ${J} !== null && !Array.isArray(${J}) && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`:`(typeof ${J} === 'object' && ${J} !== null && !(${J} instanceof Date) && !(${J} instanceof Uint8Array))`}$.IsRecordLike=Q;function W(J){return!V0.AllowNaN?`(typeof ${J} === 'number' && Number.isFinite(${J}))`:`typeof ${J} === 'number'`}$.IsNumberLike=W;function Y(J){return V0.AllowNullVoid?`(${J} === undefined || ${J} === null)`:`${J} === undefined`}$.IsVoidLike=Y})(o$||(o$={}));var G1;(function($){function X(G){return G[H]==="Any"||G[H]==="Unknown"}function*Z(G,C,A){yield"true"}function*Q(G,C,A){yield`Array.isArray(${A})`;const[y,E]=[o("value","any"),o("acc","number")];if(T(G.maxItems))yield`${A}.length <= ${G.maxItems}`;if(T(G.minItems))yield`${A}.length >= ${G.minItems}`;const k=_8(G.items,C,"value");if(yield`${A}.every((${y}) => ${k})`,p(G.contains)||T(G.minContains)||T(G.maxContains)){const L0=p(G.contains)?G.contains:Q0(),X8=_8(L0,C,"value"),U$=T(G.minContains)?[`(count >= ${G.minContains})`]:[],g8=T(G.maxContains)?[`(count <= ${G.maxContains})`]:[],o8=`const count = value.reduce((${E}, ${y}) => ${X8} ? acc + 1 : acc, 0)`,A6=["(count > 0)",...U$,...g8].join(" && ");yield`((${y}) => { ${o8}; return ${A6}})(${A})`}if(G.uniqueItems===!0)yield`((${y}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${A})`}function*W(G,C,A){yield`(typeof value === 'object' && Symbol.asyncIterator in ${A})`}function*Y(G,C,A){if(yield`(typeof ${A} === 'bigint')`,u0(G.exclusiveMaximum))yield`${A} < BigInt(${G.exclusiveMaximum})`;if(u0(G.exclusiveMinimum))yield`${A} > BigInt(${G.exclusiveMinimum})`;if(u0(G.maximum))yield`${A} <= BigInt(${G.maximum})`;if(u0(G.minimum))yield`${A} >= BigInt(${G.minimum})`;if(u0(G.multipleOf))yield`(${A} % BigInt(${G.multipleOf})) === 0`}function*J(G,C,A){yield`(typeof ${A} === 'boolean')`}function*z(G,C,A){yield*T8(G.returns,C,`${A}.prototype`)}function*B(G,C,A){if(yield`(${A} instanceof Date) && Number.isFinite(${A}.getTime())`,T(G.exclusiveMaximumTimestamp))yield`${A}.getTime() < ${G.exclusiveMaximumTimestamp}`;if(T(G.exclusiveMinimumTimestamp))yield`${A}.getTime() > ${G.exclusiveMinimumTimestamp}`;if(T(G.maximumTimestamp))yield`${A}.getTime() <= ${G.maximumTimestamp}`;if(T(G.minimumTimestamp))yield`${A}.getTime() >= ${G.minimumTimestamp}`;if(T(G.multipleOfTimestamp))yield`(${A}.getTime() % ${G.multipleOfTimestamp}) === 0`}function*M(G,C,A){yield`(typeof ${A} === 'function')`}function*q(G,C,A){if(yield`(typeof ${A} === 'number' && Number.isInteger(${A}))`,T(G.exclusiveMaximum))yield`${A} < ${G.exclusiveMaximum}`;if(T(G.exclusiveMinimum))yield`${A} > ${G.exclusiveMinimum}`;if(T(G.maximum))yield`${A} <= ${G.maximum}`;if(T(G.minimum))yield`${A} >= ${G.minimum}`;if(T(G.multipleOf))yield`(${A} % ${G.multipleOf}) === 0`}function*U(G,C,A){const y=G.allOf.map((E)=>_8(E,C,A)).join(" && ");if(G.unevaluatedProperties===!1){const E=K(`${new RegExp(L$(G))};`),k=`Object.getOwnPropertyNames(${A}).every(key => ${E}.test(key))`;yield`(${y} && ${k})`}else if(p(G.unevaluatedProperties)){const E=K(`${new RegExp(L$(G))};`),k=`Object.getOwnPropertyNames(${A}).every(key => ${E}.test(key) || ${_8(G.unevaluatedProperties,C,`${A}[key]`)})`;yield`(${y} && ${k})`}else yield`(${y})`}function*O(G,C,A){yield`(typeof value === 'object' && Symbol.iterator in ${A})`}function*_(G,C,A){if(typeof G.const==="number"||typeof G.const==="boolean")yield`(${A} === ${G.const})`;else yield`(${A} === '${RZ.Escape(G.const)}')`}function*I(G,C,A){yield"false"}function*b(G,C,A){yield`(!${_8(G.not,C,A)})`}function*D(G,C,A){yield`(${A} === null)`}function*F(G,C,A){if(yield o$.IsNumberLike(A),T(G.exclusiveMaximum))yield`${A} < ${G.exclusiveMaximum}`;if(T(G.exclusiveMinimum))yield`${A} > ${G.exclusiveMinimum}`;if(T(G.maximum))yield`${A} <= ${G.maximum}`;if(T(G.minimum))yield`${A} >= ${G.minimum}`;if(T(G.multipleOf))yield`(${A} % ${G.multipleOf}) === 0`}function*j(G,C,A){if(yield o$.IsObjectLike(A),T(G.minProperties))yield`Object.getOwnPropertyNames(${A}).length >= ${G.minProperties}`;if(T(G.maxProperties))yield`Object.getOwnPropertyNames(${A}).length <= ${G.maxProperties}`;const y=Object.getOwnPropertyNames(G.properties);for(let E of y){const k=g6.Encode(A,E),L0=G.properties[E];if(G.required&&G.required.includes(E)){if(yield*T8(L0,C,k),P$(L0)||X(L0))yield`('${E}' in ${A})`}else{const X8=_8(L0,C,k);yield o$.IsExactOptionalProperty(A,E,X8)}}if(G.additionalProperties===!1)if(G.required&&G.required.length===y.length)yield`Object.getOwnPropertyNames(${A}).length === ${y.length}`;else{const E=`[${y.map((k)=>`'${k}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${A}).every(key => ${E}.includes(key))`}if(typeof G.additionalProperties==="object"){const E=_8(G.additionalProperties,C,`${A}[key]`),k=`[${y.map((L0)=>`'${L0}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${A}).every(key => ${k}.includes(key) || ${E}))`}}function*P(G,C,A){yield`(typeof value === 'object' && typeof ${A}.then === 'function')`}function*f(G,C,A){if(yield o$.IsRecordLike(A),T(G.minProperties))yield`Object.getOwnPropertyNames(${A}).length >= ${G.minProperties}`;if(T(G.maxProperties))yield`Object.getOwnPropertyNames(${A}).length <= ${G.maxProperties}`;const[y,E]=Object.entries(G.patternProperties)[0],k=K(`${new RegExp(y)}`),L0=_8(E,C,"value"),X8=p(G.additionalProperties)?_8(G.additionalProperties,C,A):G.additionalProperties===!1?"false":"true",U$=`(${k}.test(key) ? ${L0} : ${X8})`;yield`(Object.entries(${A}).every(([key, value]) => ${U$}))`}function*x(G,C,A){const y=X0(G,C);if(y0.functions.has(G.$ref))return yield`${g(G.$ref)}(${A})`;yield*T8(y,C,A)}function*q0(G,C,A){const y=K(`${new RegExp(G.source,G.flags)};`);if(yield`(typeof ${A} === 'string')`,T(G.maxLength))yield`${A}.length <= ${G.maxLength}`;if(T(G.minLength))yield`${A}.length >= ${G.minLength}`;yield`${y}.test(${A})`}function*_0(G,C,A){if(yield`(typeof ${A} === 'string')`,T(G.maxLength))yield`${A}.length <= ${G.maxLength}`;if(T(G.minLength))yield`${A}.length >= ${G.minLength}`;if(G.pattern!==void 0)yield`${K(`${new RegExp(G.pattern)};`)}.test(${A})`;if(G.format!==void 0)yield`format('${G.format}', ${A})`}function*M0(G,C,A){yield`(typeof ${A} === 'symbol')`}function*U0(G,C,A){yield`(typeof ${A} === 'string')`,yield`${K(`${new RegExp(G.pattern)};`)}.test(${A})`}function*$0(G,C,A){yield`${g(G.$ref)}(${A})`}function*m(G,C,A){if(yield`Array.isArray(${A})`,G.items===void 0)return yield`${A}.length === 0`;yield`(${A}.length === ${G.maxItems})`;for(let y=0;y<G.items.length;y++)yield`${_8(G.items[y],C,`${A}[${y}]`)}`}function*k0(G,C,A){yield`${A} === undefined`}function*M$(G,C,A){yield`(${G.anyOf.map((E)=>_8(E,C,A)).join(" || ")})`}function*k8(G,C,A){if(yield`${A} instanceof Uint8Array`,T(G.maxByteLength))yield`(${A}.length <= ${G.maxByteLength})`;if(T(G.minByteLength))yield`(${A}.length >= ${G.minByteLength})`}function*P8(G,C,A){yield"true"}function*G0(G,C,A){yield o$.IsVoidLike(A)}function*$8(G,C,A){const y=y0.instances.size;y0.instances.set(y,G),yield`kind('${G[H]}', ${y}, ${A})`}function*T8(G,C,A,y=!0){const E=h(G.$id)?[...C,G]:C,k=G;if(y&&h(G.$id)){const L0=g(G.$id);if(y0.functions.has(L0))return yield`${L0}(${A})`;else{const X8=V(L0,G,C,"value",!1);return y0.functions.set(L0,X8),yield`${L0}(${A})`}}switch(k[H]){case"Any":return yield*Z(k,E,A);case"Array":return yield*Q(k,E,A);case"AsyncIterator":return yield*W(k,E,A);case"BigInt":return yield*Y(k,E,A);case"Boolean":return yield*J(k,E,A);case"Constructor":return yield*z(k,E,A);case"Date":return yield*B(k,E,A);case"Function":return yield*M(k,E,A);case"Integer":return yield*q(k,E,A);case"Intersect":return yield*U(k,E,A);case"Iterator":return yield*O(k,E,A);case"Literal":return yield*_(k,E,A);case"Never":return yield*I(k,E,A);case"Not":return yield*b(k,E,A);case"Null":return yield*D(k,E,A);case"Number":return yield*F(k,E,A);case"Object":return yield*j(k,E,A);case"Promise":return yield*P(k,E,A);case"Record":return yield*f(k,E,A);case"Ref":return yield*x(k,E,A);case"RegExp":return yield*q0(k,E,A);case"String":return yield*_0(k,E,A);case"Symbol":return yield*M0(k,E,A);case"TemplateLiteral":return yield*U0(k,E,A);case"This":return yield*$0(k,E,A);case"Tuple":return yield*m(k,E,A);case"Undefined":return yield*k0(k,E,A);case"Union":return yield*M$(k,E,A);case"Uint8Array":return yield*k8(k,E,A);case"Unknown":return yield*P8(k,E,A);case"Void":return yield*G0(k,E,A);default:if(!E0.Has(k[H]))throw new OW(G);return yield*$8(k,E,A)}}const y0={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function _8(G,C,A,y=!0){return`(${[...T8(G,C,A,y)].join(" && ")})`}function g(G){return`check_${jZ.Encode(G)}`}function K(G){const C=`local_${y0.variables.size}`;return y0.variables.set(C,`const ${C} = ${G}`),C}function V(G,C,A,y,E=!0){const[k,L0]=["\n",(o8)=>"".padStart(o8," ")],X8=o("value","any"),U$=j0("boolean"),g8=[...T8(C,A,y,E)].map((o8)=>`${L0(4)}${o8}`).join(` &&${k}`);return`function ${G}(${X8})${U$} {${k}${L0(2)}return (${k}${g8}${k}${L0(2)})\n}`}function o(G,C){const A=y0.language==="typescript"?`: ${C}`:"";return`${G}${A}`}function j0(G){return y0.language==="typescript"?`: ${G}`:""}function R$(G,C,A){const y=V("check",G,C,"value"),E=o("value","any"),k=j0("boolean"),L0=[...y0.functions.values()],X8=[...y0.variables.values()],U$=h(G.$id)?`return function check(${E})${k} {\n  return ${g(G.$id)}(value)\n}`:`return ${y}`;return[...X8,...L0,U$].join("\n")}function i8(...G){const C={language:"javascript"},[A,y,E]=G.length===2&&d(G[1])?[G[0],G[1],C]:G.length===2&&!d(G[1])?[G[0],[],G[1]]:G.length===3?[G[0],G[1],G[2]]:G.length===1?[G[0],[],C]:[null,[],C];if(y0.language=E.language,y0.variables.clear(),y0.functions.clear(),y0.instances.clear(),!p(A))throw new CZ(A);for(let k of y)if(!p(k))throw new CZ(k);return R$(A,y,E)}$.Code=i8;function YX(G,C=[]){const A=i8(G,C,{language:"javascript"}),y=globalThis.Function("kind","format","hash",A),E=new Map(y0.instances);function k(g8,o8,A6){if(!E0.Has(g8)||!E.has(o8))return!1;const s7=E0.Get(g8),r7=E.get(o8);return s7(r7,A6)}function L0(g8,o8){if(!R0.Has(g8))return!1;return R0.Get(g8)(o8)}function X8(g8){return E$(g8)}const U$=y(k,L0,X8);return new bZ(G,C,U$,A)}$.Compile=YX})(G1||(G1={}));var lM=function($,X){if(typeof $!=="string")throw new TypeError("argument str must be a string");var Z={},Q=X||{},W=Q.decode||tM,Y=0;while(Y<$.length){var J=$.indexOf("=",Y);if(J===-1)break;var z=$.indexOf(";",Y);if(z===-1)z=$.length;else if(z<J){Y=$.lastIndexOf(";",J-1)+1;continue}var B=$.slice(Y,J).trim();if(Z[B]===void 0){var M=$.slice(J+1,z).trim();if(M.charCodeAt(0)===34)M=M.slice(1,-1);Z[B]=aM(M,W)}Y=z+1}return Z},nM=function($,X,Z){var Q=Z||{},W=Q.encode||sM;if(typeof W!=="function")throw new TypeError("option encode is invalid");if(!f6.test($))throw new TypeError("argument name is invalid");var Y=W(X);if(Y&&!f6.test(Y))throw new TypeError("argument val is invalid");var J=$+"="+Y;if(Q.maxAge!=null){var z=Q.maxAge-0;if(isNaN(z)||!isFinite(z))throw new TypeError("option maxAge is invalid");J+="; Max-Age="+Math.floor(z)}if(Q.domain){if(!f6.test(Q.domain))throw new TypeError("option domain is invalid");J+="; Domain="+Q.domain}if(Q.path){if(!f6.test(Q.path))throw new TypeError("option path is invalid");J+="; Path="+Q.path}if(Q.expires){var B=Q.expires;if(!rM(B)||isNaN(B.valueOf()))throw new TypeError("option expires is invalid");J+="; Expires="+B.toUTCString()}if(Q.httpOnly)J+="; HttpOnly";if(Q.secure)J+="; Secure";if(Q.partitioned)J+="; Partitioned";if(Q.priority){var M=typeof Q.priority==="string"?Q.priority.toLowerCase():Q.priority;switch(M){case"low":J+="; Priority=Low";break;case"medium":J+="; Priority=Medium";break;case"high":J+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(Q.sameSite){var q=typeof Q.sameSite==="string"?Q.sameSite.toLowerCase():Q.sameSite;switch(q){case!0:J+="; SameSite=Strict";break;case"lax":J+="; SameSite=Lax";break;case"strict":J+="; SameSite=Strict";break;case"none":J+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return J},tM=function($){return $.indexOf("%")!==-1?decodeURIComponent($):$},sM=function($){return encodeURIComponent($)},rM=function($){return oM.call($)==="[object Date]"||$ instanceof Date},aM=function($,X){try{return X($)}catch(Z){return $}};/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var VZ=lM,EZ=nM;var oM=Object.prototype.toString,f6=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;var J7=G$(y6(),1),SU=function($){let X=$;while(X.endsWith("="))X=X.slice(0,-1);return X};var G7=G$(kZ(),1),w7=G$(y6(),1),h6=G$(kZ(),1);var fU=function($){return $%4===0&&($%100!==0||$%400===0)},N7=function($){const X=yU.exec($);if(!X)return!1;const Z=+X[1],Q=+X[2],W=+X[3];return Q>=1&&Q<=12&&W>=1&&W<=(Q===2&&fU(Z)?29:dU[Q])},mZ=function($){return function X(Z){const Q=vU.exec(Z);if(!Q)return!1;const W=+Q[1],Y=+Q[2],J=+Q[3],z=Q[4],B=Q[5]==="-"?-1:1,M=+(Q[6]||0),q=+(Q[7]||0);if(M>23||q>59||$&&!z)return!1;if(W<=23&&Y<=59&&J<60)return!0;const U=Y-q*B,O=W-M*B-(U<0?1:0);return(O===23||O===-1)&&(U===59||U===-1)&&J<61}},sW=function($){const X=mZ($);return function Z(Q){const W=Q.split(pU);return W.length===2&&N7(W[0])&&X(W[1])}},uU=function($){return mU.test($)&&hU.test($)},cU=function($){return rW.lastIndex=0,rW.test($)},lU=function($){return Number.isInteger($)&&$<=oU&&$>=iU},nU=function($){return Number.isInteger($)},aW=function(){return!0},sU=function($){if(tU.test($))return!1;try{return new RegExp($),!0}catch(X){return!1}};var w1=($,X)=>({part:$,store:null,inert:X!==void 0?new Map(X.map((Z)=>[Z.part.charCodeAt(0),Z])):null,params:null,wildcardStore:null}),gW=($,X)=>({...$,part:X}),fW=($)=>({paramName:$,store:null,inert:null}),TZ=class ${root={};history=[];static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g};add(X,Z,Q){let W;if(typeof Z!="string")throw TypeError("Route path must be a string");Z===""?Z="/":Z[0]!=="/"&&(Z=`/${Z}`),this.history.push([X,Z,Q]);let Y=Z[Z.length-1]==="*";Y&&(Z=Z.slice(0,-1));let J=Z.split($.regex.static),z=Z.match($.regex.params)||[];J[J.length-1]===""&&J.pop(),W=this.root[X]?this.root[X]:this.root[X]=w1("/");let B=0;for(let M=0;M<J.length;++M){let q=J[M];if(M>0){let U=z[B++].slice(1);if(W.params===null)W.params=fW(U);else if(W.params.paramName!==U)throw Error(`Cannot create route "${Z}" with parameter "${U}" because a route already exists with a different parameter name ("${W.params.paramName}") in the same location`);let O=W.params;if(O.inert===null){W=O.inert=w1(q);continue}W=O.inert}for(let U=0;;){if(U===q.length){if(U<W.part.length){let O=gW(W,W.part.slice(U));Object.assign(W,w1(q,[O]))}break}if(U===W.part.length){if(W.inert===null)W.inert=new Map;else if(W.inert.has(q.charCodeAt(U))){W=W.inert.get(q.charCodeAt(U)),q=q.slice(U),U=0;continue}let O=w1(q.slice(U));W.inert.set(q.charCodeAt(U),O),W=O;break}if(q[U]!==W.part[U]){let O=gW(W,W.part.slice(U)),_=w1(q.slice(U));Object.assign(W,w1(W.part.slice(0,U),[O,_])),W=_;break}++U}}if(B<z.length){let M=z[B],q=M.slice(1);if(W.params===null)W.params=fW(q);else if(W.params.paramName!==q)throw Error(`Cannot create route "${Z}" with parameter "${q}" because a route already exists with a different parameter name ("${W.params.paramName}") in the same location`);return W.params.store===null&&(W.params.store=Q),W.params.store}return Y?(W.wildcardStore===null&&(W.wildcardStore=Q),W.wildcardStore):(W.store===null&&(W.store=Q),W.store)}find(X,Z){let Q=this.root[X];return Q?pZ(Z,Z.length,Q,0):null}},pZ=($,X,Z,Q)=>{let W=Z?.part,Y=Q+W.length;if(W.length>1){if(Y>X)return null;if(W.length<15){for(let J=1,z=Q+1;J<W.length;++J,++z)if(W.charCodeAt(J)!==$.charCodeAt(z))return null}else if($.substring(Q,Y)!==W)return null}if(Y===X)return Z.store!==null?{store:Z.store,params:{}}:Z.wildcardStore!==null?{store:Z.wildcardStore,params:{"*":""}}:null;if(Z.inert!==null){let J=Z.inert.get($.charCodeAt(Y));if(J!==void 0){let z=pZ($,X,J,Y);if(z!==null)return z}}if(Z.params!==null){let J=Z.params,z=$.indexOf("/",Y);if(z!==Y){if(z===-1||z>=X){if(J.store!==null){let B={};return B[J.paramName]=$.substring(Y,X),{store:J.store,params:B}}}else if(J.inert!==null){let B=pZ($,X,J.inert,z);if(B!==null)return B.params[J.paramName]=$.substring(Y,z),B}}}return Z.wildcardStore!==null?{store:Z.wildcardStore,params:{"*":$.substring(Y,X)}}:null},d6=()=>{let $;return[new Promise((Z)=>{$=Z}),$]},k$=()=>{const[$,X]=d6(),[Z,Q]=d6(),W=[],Y=[];return{signal:$,consume:(J)=>{switch(J.type){case"begin":if(J.unit&&W.length===0)for(let z=0;z<J.unit;z++){const[B,M]=d6(),[q,U]=d6();W.push(B),Y.push([(O)=>{M({children:[],end:q,name:O.name??"",skip:!1,time:O.time})},(O)=>{U(O)}])}X({children:W,end:Z,name:J.name??"",skip:!1,time:J.time});break;case"end":Q(J.time);break}},consumeChild(J){switch(J.type){case"begin":if(!Y[0])return;const[z]=Y[0];z({children:[],end:Z,name:J.name??"",skip:!1,time:J.time});break;case"end":const B=Y.shift();if(!B)return;B[1](J.time)}},resolve(){X({children:[],end:new Promise((J)=>J(0)),name:"",skip:!0,time:0});for(let[J,z]of Y)J({children:[],end:new Promise((B)=>B(0)),name:"",skip:!0,time:0}),z(0);Q(0)}}},JU=($,X,Z)=>{if(typeof Z==="object")Z=Z.fn;return async function Q(Q){if(Q.event!=="request"||Q.type!=="begin")return;const W=Q.id,Y=$(),J=k$(),z=k$(),B=k$(),M=k$(),q=k$(),U=k$(),O=k$(),_=k$();J.consume(Q);const I=(b)=>{if(b.id===W)switch(b.event){case"request":J.consume(b);break;case"request.unit":J.consumeChild(b);break;case"parse":z.consume(b);break;case"parse.unit":z.consumeChild(b);break;case"transform":B.consume(b);break;case"transform.unit":B.consumeChild(b);break;case"beforeHandle":M.consume(b);break;case"beforeHandle.unit":M.consumeChild(b);break;case"handle":q.consume(b);break;case"afterHandle":U.consume(b);break;case"afterHandle.unit":U.consumeChild(b);break;case"error":O.consume(b);break;case"error.unit":O.consumeChild(b);break;case"response":if(b.type==="begin")J.resolve(),z.resolve(),B.resolve(),M.resolve(),q.resolve(),U.resolve(),O.resolve();else Y.off("event",I);_.consume(b);break;case"response.unit":_.consumeChild(b);break;case"exit":J.resolve(),z.resolve(),B.resolve(),M.resolve(),q.resolve(),U.resolve(),O.resolve();break}};Y.on("event",I),await Z({id:W,context:Q.ctx,set:Q.ctx?.set,store:Q.ctx?.store,time:Q.time,request:J.signal,parse:z.signal,transform:B.signal,beforeHandle:M.signal,handle:q.signal,afterHandle:U.signal,error:O.signal,response:_.signal}),Y.emit(`res${W}.${X}`,void 0)}},$7=($)=>{if($.startsWith("async"))$=$.slice(6);let X=-1;if($.charCodeAt(0)===40){if(X=$.indexOf(") => {\n"),X!==-1)return[$.slice(1,X),$.slice(X+5)];if(X=$.indexOf(") => "),X!==-1)return[$.slice(1,X),$.slice(X+5)]}if($.startsWith("function")){X=$.indexOf("(");const Q=$.indexOf(")");return[$.slice(X+1,Q),$.slice(Q+2)]}const Z=$.indexOf("(");if(Z!==-1){const[Q,W]=$.split("\n",2),Y=Q.lastIndexOf(")")+1;return[Q.slice(Z,Y),"{"+W]}return $.split("\n",2)},X7=($)=>{const X=$.indexOf("{");if(X===-1)return[-1,0];let Z=X+1,Q=1;for(;Z<$.length;Z++){const W=$.charCodeAt(Z);if(W===123)Q++;else if(W===125)Q--;if(Q===0)break}if(Q!==0)return[0,$.length];return[X,Z+1]},zU=($)=>{const X=$.lastIndexOf("}");if(X===-1)return[-1,0];let Z=X-1,Q=1;for(;Z>=0;Z--){const W=$.charCodeAt(Z);if(W===125)Q++;else if(W===123)Q--;if(Q===0)break}if(Q!==0)return[-1,0];return[Z,X+1]},n6=($)=>{if($.charCodeAt(0)===40)$=$.slice(1,-1);if($.charCodeAt(0)===123)$=$.slice(2,-2);while(!0){const[X,Z]=X7($);if(X===-1)break;$=$.slice(0,X-2)+$.slice(Z+1)}return $.replace(/:/g,"").trim()},BU=($,X)=>{const Z=n6($);if(!X.query&&Z.includes("query"))X.query=!0;if(!X.headers&&Z.includes("headers"))X.headers=!0;if(!X.body&&Z.includes("body"))X.body=!0;if(!X.cookie&&Z.includes("cookie"))X.cookie=!0;if(!X.set&&Z.includes("set"))X.set=!0;return Z},qU=($,X)=>{const Z=n6($);if(!X.request&&Z.includes("request"))X.request=!0;if(!X.parse&&Z.includes("parse"))X.parse=!0;if(!X.transform&&Z.includes("transform"))X.transform=!0;if(!X.handle&&Z.includes("handle"))X.handle=!0;if(!X.beforeHandle&&Z.includes("beforeHandle"))X.beforeHandle=!0;if(!X.afterHandle&&Z.includes("afterHandle"))X.afterHandle=!0;if(!X.error&&Z.includes("error"))X.error=!0;if(!X.context&&Z.includes("context"))X.context=!0;if(!X.store&&Z.includes("store"))X.store=!0;if(!X.set&&Z.includes("set"))X.set=!0;return Z},Z7=($,X,Z)=>{const Q=X.indexOf($+"\n",Z),W=X.indexOf($+"	",Z),Y=X.indexOf($+",",Z),J=X.indexOf($+";",Z),z=X.indexOf($+" ",Z);return[Q,W,Y,J,z].filter((B)=>B>0).sort((B,M)=>B-M)[0]||-1},MU=($,X,Z)=>{const Q=X.indexOf($+"]",Z),W=X.indexOf($+"'",Z),Y=X.indexOf($+'"',Z);return[Q,W,Y].filter((J)=>J>0).sort((J,z)=>J-z)[0]||-1},uZ=($,X,Z=0)=>{if(Z>5)return[];const Q=[];let W=X;while(!0){let Y=Z7(" = "+$,W);if(Y===-1){const B=W.indexOf(" = "+$);if(B+3+$.length!==W.length)break;Y=B}const J=W.slice(0,Y);let z=J.slice(J.lastIndexOf(" ")+1);if(z==="}"){const[B,M]=zU(J);Q.push(W.slice(B,M)),W=W.slice(Y+3+$.length);continue}while(z.charCodeAt(0)===44)z=z.slice(1);while(z.charCodeAt(0)===9)z=z.slice(1);Q.push(z),W=W.slice(Y+3+$.length)}for(let Y of Q){if(Y.charCodeAt(0)===123)continue;const J=uZ(Y,X);if(J.length>0)Q.push(...J)}return Q},Q7=($,X)=>[$+"."+X,$+'["'+X+'"]',$+"['"+X+"']"],W7=($)=>{if(!$)return;if(!$.includes(",")){if($.includes("..."))return $.slice($.indexOf("...")+3);return $}const Z=$.indexOf("...");if(Z===-1)return;return $.slice(Z+3).trimEnd()},yW=($,X,Z)=>{const Q=(W,Y)=>$.includes(Y+"."+W)||$.includes(Y+'["'+W+'"]')||$.includes(Y+"['"+W+"']");for(let W of X){if(!W)continue;if(W.charCodeAt(0)===123){if(W=n6(W),!Z.query&&W.includes("query"))Z.query=!0;if(!Z.headers&&W.includes("headers"))Z.headers=!0;if(!Z.body&&W.includes("body"))Z.body=!0;if(!Z.cookie&&W.includes("cookie"))Z.cookie=!0;if(!Z.set&&W.includes("set"))Z.set=!0;continue}if($.includes("("+W+")")){Z.query=!0,Z.headers=!0,Z.body=!0,Z.cookie=!0,Z.set=!0,Z.queries=[],Z.unknownQueries=!0;break}if(!Z.query&&Q("query",W))Z.query=!0;if($.includes("return "+W)||Q7("return "+W,"query").some((Y)=>$.includes(Y)))Z.query=!0,Z.unknownQueries=!0;if(Z.query&&!Z.unknownQueries)while(!0){let Y=W+".";if($.includes(Y+"query"))Y=W+".query";let J=!1,z=$.indexOf(Y);if(z===-1)J=!0,z=$.indexOf(W+'["');if(z===-1)J=!0,z=$.indexOf(W+"['");if(z===-1&&$.indexOf(W+"[")!==-1){Z.queries=[],Z.unknownQueries=!0;break}if(z!==-1){let B=J?MU("",$,z+Y.length+1):Z7("",$,z+Y.length+1);if(B===-1)B=void 0;const M=z+W.length+1;$=$.slice(z+W.length+1);let q=$.slice(0,B?B-M:B).trimEnd();while(z!==-1)if(z=q.indexOf("."),z!==-1)q=q.slice(z+1);if(q.charCodeAt(q.length-1)===59)q=q.slice(0,-1);if(q.charCodeAt(q.length-1)===44)q=q.slice(0,-1);if(q.charCodeAt(q.length-1)===93)q=q.slice(0,-1);if(q.charCodeAt(q.length-1)===41)q=q.slice(0,-1);if(J)q=q.replaceAll(/("|')/g,"");if(q&&!Z.queries.includes(q)){Z.queries.push(q);continue}}break}if(!Z.headers&&Q("headers",W))Z.headers=!0;if(!Z.body&&Q("body",W))Z.body=!0;if(!Z.cookie&&Q("cookie",W))Z.cookie=!0;if(!Z.set&&Q("set",W))Z.set=!0;if(Z.query&&Z.headers&&Z.body&&Z.cookie&&Z.set)break}return X},UU=($)=>{while(!0){const X=$.indexOf("=");if(X===-1)break;const Z=$.indexOf(",",X),Q=$.indexOf("}",X),W=[Z,Q].filter((Y)=>Y>0).sort((Y,J)=>Y-J)[0]||-1;if(W===-1){$=$.slice(0,X);break}$=$.slice(0,X)+$.slice(W)}return $.split(",").map((X)=>X.trim()).join(", ")},GU=($)=>{for(let X of $){if(X.charCodeAt(0)===123)return!1;if(X.indexOf("'")!==-1)return!1;if(X.indexOf('"')!==-1)return!1;if(X.indexOf("\n")!==-1)return!1;if(X.indexOf("	")!==-1)return!1}return!0},wU=($,X,Z)=>{const Q=(W,Y)=>$.includes(W+"."+Y)||$.includes(W+'["'+Y+'"]')||$.includes(W+"['"+Y+"']");for(let W of X){if(W.charCodeAt(0)===123){if(W=n6(W),!Z.request&&W.includes("request"))Z.request=!0;if(!Z.parse&&W.includes("parse"))Z.parse=!0;if(!Z.transform&&W.includes("transform"))Z.transform=!0;if(!Z.handle&&W.includes("handle"))Z.handle=!0;if(!Z.beforeHandle&&W.includes("beforeHandle"))Z.beforeHandle=!0;if(!Z.afterHandle&&W.includes("afterHandle"))Z.afterHandle=!0;if(!Z.error&&W.includes("error"))Z.error=!0;if(!Z.context&&W.includes("context"))Z.context=!0;if(!Z.store&&W.includes("store"))Z.store=!0;if(!Z.set&&W.includes("set"))Z.set=!0;continue}if($.includes("("+W+")")){Z.request=!0,Z.parse=!0,Z.transform=!0,Z.handle=!0,Z.beforeHandle=!0,Z.afterHandle=!0,Z.error=!0,Z.context=!0,Z.store=!0,Z.set=!0;break}if(!Z.request&&Q("request",W))Z.request=!0;if(!Z.parse&&Q("parse",W))Z.parse=!0;if(!Z.transform&&Q("transform",W))Z.transform=!0;if(!Z.handle&&Q("handle",W))Z.handle=!0;if(!Z.beforeHandle&&Q("beforeHandle",W))Z.beforeHandle=!0;if(!Z.afterHandle&&Q("afterHandle",W))Z.afterHandle=!0;if(!Z.error&&Q("error",W))Z.error=!0;if(!Z.context&&Q("context",W))Z.context=!0;if(!Z.store&&Q("store",W))Z.store=!0;if(!Z.set&&Q("set",W))Z.set=!0;if(Z.request&&Z.parse&&Z.transform&&Z.handle&&Z.beforeHandle&&Z.afterHandle&&Z.error&&Z.context&&Z.store&&Z.set)break}return X},Y7=($,X={queries:[],query:!1,headers:!1,body:!1,cookie:!1,set:!1,unknownQueries:!1})=>{const Z=[];if($.handler&&typeof $.handler==="function")Z.push($.handler);if($.beforeHandle?.length)Z.push(...$.beforeHandle);if($.parse?.length)Z.push(...$.parse);if($.error?.length)Z.push(...$.error);if($.transform?.length)Z.push(...$.transform);if($.afterHandle?.length)Z.push(...$.afterHandle);if($.mapResponse?.length)Z.push(...$.mapResponse);if($.request?.length)Z.push(...$.request);if($.onResponse?.length)Z.push(...$.onResponse);for(let Q of Z){if(!Q)continue;const W="fn"in Q?Q.fn:Q,[Y,J]=$7(W.toString()),z=BU(Y,X),B=W7(z);if(B){const q=uZ(B,J);q.splice(0,-1,B),yW(J,q,X)}const M=z||B;if(M&&["","return "].some((q)=>Q7(q+M,"query").some((U)=>J.includes(U))))X.query=!0,X.unknownQueries=!0;if(X.query){yW(J,["query"],X);const q=Y.indexOf("query: {");if(q!==-1){const U=Y.slice(q+7),[O,_]=X7(U),I=UU(U.slice(O,_));for(let b of I.slice(1,-1).split(",")){const D=b.indexOf(":");if(D!==-1)b=b.slice(0,D);if(b=b.trim(),b&&!X.queries.includes(b))X.queries.push(b.trim())}}}if(X.query&&X.headers&&X.body&&X.cookie&&X.set)break}if(!GU(X.queries))X.unknownQueries=!0,X.queries=[];return X},DU=($,X={request:!1,parse:!1,transform:!1,handle:!1,beforeHandle:!1,afterHandle:!1,error:!1,context:!1,store:!1,set:!1})=>{for(let Z of $){const[Q,W]=$7(Z.toString()),Y=qU(Q,X),J=W7(Y);if(J){const z=uZ(J,W);z.splice(0,-1,J),wU(W,z,X);continue}if(X.request&&X.parse&&X.transform&&X.handle&&X.beforeHandle&&X.afterHandle&&X.error&&X.context&&X.store&&X.set)break}return X},H1=class{constructor($,X,Z={}){this.name=$,this.jar=X,this.initial=Z}get cookie(){if(!(this.name in this.jar))return this.initial;return this.jar[this.name]}set cookie($){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=$}get value(){return this.cookie.value}set value($){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name].value=$}get expires(){return this.cookie.expires}set expires($){this.cookie.expires=$}get maxAge(){return this.cookie.maxAge}set maxAge($){this.cookie.maxAge=$}get domain(){return this.cookie.domain}set domain($){this.cookie.domain=$}get path(){return this.cookie.path}set path($){this.cookie.path=$}get secure(){return this.cookie.secure}set secure($){this.cookie.secure=$}get httpOnly(){return this.cookie.httpOnly}set httpOnly($){this.cookie.httpOnly=$}get sameSite(){return this.cookie.sameSite}set sameSite($){this.cookie.sameSite=$}get priority(){return this.cookie.priority}set priority($){this.cookie.priority=$}get secrets(){return this.cookie.secrets}set secrets($){this.cookie.secrets=$}update($){return this.cookie=Object.assign(this.cookie,typeof $==="function"?$(this.cookie):$),this}set($){return this.cookie=Object.assign({...this.initial,value:this.value},typeof $==="function"?$(this.cookie):$),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}},dW=($,X,Z)=>{if(!$.cookie)$.cookie={};return new Proxy(X,{get(Q,W){if(W in X)return new H1(W,$.cookie,Object.assign({},Z??{},X[W]));return new H1(W,$.cookie,Object.assign({},Z))}})},z7=async($,X,{secrets:Z,sign:Q,...W}={})=>{if(!X)return dW($,{},W);const Y=typeof Z==="string";if(Q&&Q!==!0&&!Array.isArray(Q))Q=[Q];const J={},z=VZ(X);for(let[B,M]of Object.entries(z)){let q=J7.default(M);if(Q===!0||Q?.includes(B)){if(!Z)throw new Error("No secret is provided to cookie plugin");if(Y){const O=await cW(q,Z);if(O===!1)throw new oW(B);q=O}else{let O=!0;for(let _=0;_<Z.length;_++){const I=await cW(q,Z[_]);if(I!==!1){O=!0,q=I;break}}if(!O)throw new oW(B)}}const U=q.charCodeAt(0);if(U===123||U===91)try{J[B]={value:JSON.parse(q)};continue}catch{}if(c6(q)){J[B]={value:parseInt(q)};continue}if(q==="true"){J[B]={value:!0};continue}if(q==="false"){J[B]={value:!1};continue}J[B]={value:q}}return dW($,J,W)},G6="toJSON"in new Headers,z$=($)=>{if(!$)return!1;for(let X in $)return!0;return!1},w6=($,X)=>{const Z=$.size;if(!X&&Z||Z&&X&&X.status!==206&&X.status!==304&&X.status!==412&&X.status!==416){if(X){if(X.headers instanceof Headers){if(G6)X.headers=X.headers.toJSON();else for(let[Q,W]of X.headers.entries())if(Q in X.headers)X.headers[Q]=W}return new Response($,{status:X.status,headers:Object.assign({"accept-ranges":"bytes","content-range":`bytes 0-${Z-1}/${Z}`},X.headers)})}return new Response($,{headers:{"accept-ranges":"bytes","content-range":`bytes 0-${Z-1}/${Z}`}})}return new Response($)},B7=($,X)=>{if(!$)return $;$.delete("Set-Cookie");for(let Z=0;Z<X.length;Z++){const Q=X[Z].indexOf("=");$.append("Set-Cookie",`${X[Z].slice(0,Q)}=${X[Z].slice(Q+1)||""}`)}return $},q7=($)=>{if(!$||!z$($))return;const X=[];for(let[Z,Q]of Object.entries($)){if(!Z||!Q)continue;const W=Q.value;if(W===void 0||W===null)continue;X.push(EZ(Z,typeof W==="object"?JSON.stringify(W):W+"",Q))}if(X.length===0)return;if(X.length===1)return X[0];return X},Y$=($,X,Z)=>{if($?.$passthrough)$=$?.[$.$passthrough];if($?.[B$])X.status=$[B$],$=$.response;if(z$(X.headers)||X.status!==200||X.redirect||X.cookie){if(typeof X.status==="string")X.status=t6[X.status];if(X.redirect){if(X.headers.Location=X.redirect,!X.status||X.status<300||X.status>=400)X.status=302}if(X.cookie&&z$(X.cookie))X.headers["Set-Cookie"]=q7(X.cookie);if(X.headers["Set-Cookie"]&&Array.isArray(X.headers["Set-Cookie"]))X.headers=B7(new Headers(X.headers),X.headers["Set-Cookie"]);switch($?.constructor?.name){case"String":return new Response($,X);case"Blob":return w6($,X);case"Object":case"Array":return Response.json($,X);case"ReadableStream":if(!X.headers["content-type"]?.startsWith("text/event-stream"))X.headers["content-type"]="text/event-stream; charset=utf-8";return Z?.signal.addEventListener("abort",{handleEvent(){if(!Z?.signal.aborted)$.cancel(Z)}},{once:!0}),new Response($,X);case void 0:if(!$)return new Response("",X);return Response.json($,X);case"Response":const Q={...X.headers};if(G6)X.headers=$.headers.toJSON();else for(let[W,Y]of $.headers.entries())if(W in X.headers)X.headers[W]=Y;for(let W in Q)$.headers.append(W,Q[W]);return $;case"Error":return J$($,X);case"Promise":return $.then((W)=>Y$(W,X));case"Function":return Y$($(),X);case"Number":case"Boolean":return new Response($.toString(),X);case"Cookie":if($ instanceof H1)return new Response($.value,X);return new Response($?.toString(),X);default:if($ instanceof Response){const W=Object.assign({},X.headers);if(G6)X.headers=$.headers.toJSON();else for(let[Y,J]of $.headers.entries())if(Y in X.headers)X.headers[Y]=J;for(let Y in W)$.headers.append(Y,W[Y]);return $}if($ instanceof Promise)return $.then((W)=>Y$(W,X));if($ instanceof Error)return J$($,X);if("charCodeAt"in $){const W=$.charCodeAt(0);if(W===123||W===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),X)}}return new Response($,X)}}else switch($?.constructor?.name){case"String":return new Response($);case"Blob":return w6($,X);case"Object":case"Array":return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"ReadableStream":return Z?.signal.addEventListener("abort",{handleEvent(){if(!Z?.signal.aborted)$.cancel(Z)}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":return $;case"Error":return J$($,X);case"Promise":return $.then((Q)=>{const W=t$(Q);if(W!==void 0)return W;return new Response("")});case"Function":return t$($());case"Number":case"Boolean":return new Response($.toString());case"Cookie":if($ instanceof H1)return new Response($.value,X);return new Response($?.toString(),X);default:if($ instanceof Response)return new Response($.body,{headers:{"Content-Type":"application/json"}});if($ instanceof Promise)return $.then((Q)=>Y$(Q,X));if($ instanceof Error)return J$($,X);if("charCodeAt"in $){const Q=$.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),X)}}return new Response($)}},W$=($,X,Z)=>{if($===void 0||$===null)return;if($?.$passthrough)$=$?.[$.$passthrough];if($?.[B$])X.status=$[B$],$=$.response;if(z$(X.headers)||X.status!==200||X.redirect||X.cookie){if(typeof X.status==="string")X.status=t6[X.status];if(X.redirect){if(X.headers.Location=X.redirect,!X.status||X.status<300||X.status>=400)X.status=302}if(X.cookie&&z$(X.cookie))X.headers["Set-Cookie"]=q7(X.cookie);if(X.headers["Set-Cookie"]&&Array.isArray(X.headers["Set-Cookie"]))X.headers=B7(new Headers(X.headers),X.headers["Set-Cookie"]);switch($?.constructor?.name){case"String":return new Response($,X);case"Blob":return w6($,X);case"Object":case"Array":return Response.json($,X);case"ReadableStream":if(!X.headers["content-type"]?.startsWith("text/event-stream"))X.headers["content-type"]="text/event-stream; charset=utf-8";return Z?.signal.addEventListener("abort",{handleEvent(){if(!Z?.signal.aborted)$.cancel(Z)}},{once:!0}),new Response($,X);case void 0:if(!$)return;return Response.json($,X);case"Response":const Q=Object.assign({},X.headers);if(G6)X.headers=$.headers.toJSON();else for(let[W,Y]of $.headers.entries())if(!(W in X.headers))X.headers[W]=Y;for(let W in Q)$.headers.append(W,Q[W]);if($.status!==X.status)X.status=$.status;return $;case"Promise":return $.then((W)=>{const Y=W$(W,X);if(Y!==void 0)return Y});case"Error":return J$($,X);case"Function":return W$($(),X);case"Number":case"Boolean":return new Response($.toString(),X);case"Cookie":if($ instanceof H1)return new Response($.value,X);return new Response($?.toString(),X);default:if($ instanceof Response){const W={...X.headers};if(G6)X.headers=$.headers.toJSON();else for(let[Y,J]of $.headers.entries())if(Y in X.headers)X.headers[Y]=J;for(let Y in W)$.headers.append(Y,W[Y]);return $}if($ instanceof Promise)return $.then((W)=>W$(W,X));if($ instanceof Error)return J$($,X);if("charCodeAt"in $){const W=$.charCodeAt(0);if(W===123||W===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),X)}}return new Response($,X)}}else switch($?.constructor?.name){case"String":return new Response($);case"Blob":return w6($,X);case"Object":case"Array":return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"ReadableStream":return Z?.signal.addEventListener("abort",{handleEvent(){if(!Z?.signal.aborted)$.cancel(Z)}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":return $;case"Promise":return $.then((Q)=>{const W=W$(Q,X);if(W!==void 0)return W});case"Error":return J$($,X);case"Function":return t$($());case"Number":case"Boolean":return new Response($.toString());case"Cookie":if($ instanceof H1)return new Response($.value,X);return new Response($?.toString(),X);default:if($ instanceof Response)return new Response($.body,{headers:{"Content-Type":"application/json"}});if($ instanceof Promise)return $.then((Q)=>W$(Q,X));if($ instanceof Error)return J$($,X);if("charCodeAt"in $){const Q=$.charCodeAt(0);if(Q===123||Q===91){if(!X.headers["Content-Type"])X.headers["Content-Type"]="application/json";return new Response(JSON.stringify($),X)}}return new Response($)}},t$=($,X)=>{if($?.$passthrough)$=$?.[$.$passthrough];if($?.[B$])return Y$($.response,{status:$[B$],headers:{}});switch($?.constructor?.name){case"String":return new Response($);case"Blob":return w6($);case"Object":case"Array":return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"ReadableStream":return X?.signal.addEventListener("abort",{handleEvent(){if(!X?.signal.aborted)$.cancel(X)}},{once:!0}),new Response($,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!$)return new Response("");return new Response(JSON.stringify($),{headers:{"content-type":"application/json"}});case"Response":return $;case"Error":return J$($);case"Promise":return $.then(t$);case"Function":return t$($());case"Number":case"Boolean":return new Response($.toString());default:if($ instanceof Response)return new Response($.body,{headers:{"Content-Type":"application/json"}});if($ instanceof Promise)return $.then(t$);if($ instanceof Error)return J$($);if("charCodeAt"in $){const Z=$.charCodeAt(0);if(Z===123||Z===91)return new Response(JSON.stringify($),{headers:{"Content-Type":"application/json"}})}return new Response($)}},J$=($,X)=>new Response(JSON.stringify({name:$?.name,message:$?.message,cause:$?.cause}),{status:X?.status!==200?X?.status??500:500,headers:X?.headers}),vW=($,X)=>{const Z=new URL($);return Z.pathname=X,Z.toString()},AU=($)=>typeof $==="function"&&/^\s*class\s+/.test($.toString())||$.toString().startsWith("[object ")||z$(Object.getPrototypeOf($)),gZ=($)=>$&&typeof $==="object"&&!Array.isArray($),x8=($,X,{skipKeys:Z}={})=>{if(gZ($)&&gZ(X))for(let[Q,W]of Object.entries(X)){if(Z?.includes(Q))continue;if(!gZ(W)||!(Q in $)||AU(W)){$[Q]=W;continue}$[Q]=x8($[Q],W)}return $},HU=($,X)=>{const{properties:Z,...Q}=$??{},{properties:W,...Y}=X??{};return x8(Q,Y)},p0=($=[],X=[])=>{if(!$)return[];if(!X)return $;const Z=[],Q=[];if(!Array.isArray($))$=[$];if(!Array.isArray(X))X=[X];for(let W of $)if(Z.push(W),W.checksum)Q.push(W.checksum);for(let W of X)if(!Q.includes(W.checksum))Z.push(W);return Z},NU=["start","request","parse","transform","resolve","beforeHandle","afterHandle","onResponse","mapResponse","trace","error","stop","body","headers","params","query","response","type","detail"],OU=NU.reduce(($,X)=>($[X]=!0,$),{}),LU=($,X)=>{const Z=(Q)=>typeof Q==="object"&&Object.keys(Q).every(c6);if(Z($)&&Z(X))return{...$,...X};return X??$},V8=($,X,{allowMacro:Z=!1}={})=>{return{...Z?{...$,...X}:void 0,body:X?.body??$?.body,headers:X?.headers??$?.headers,params:X?.params??$?.params,query:X?.query??$?.query,response:LU($?.response,X?.response),type:$?.type||X?.type,detail:x8(X?.detail??{},$?.detail??{}),parse:p0($?.parse,X?.parse),transform:p0($?.transform,X?.transform),beforeHandle:p0($?.beforeHandle,X?.beforeHandle),afterHandle:p0($?.afterHandle,X?.afterHandle),onResponse:p0($?.onResponse,X?.onResponse),mapResponse:p0($?.mapResponse,X?.mapResponse),trace:p0($?.trace,X?.trace),error:p0($?.error,X?.error)}},I8=($,{models:X={},dynamic:Z=!1,normalize:Q=!1,additionalProperties:W=Q})=>{if(!$)return;if(typeof $==="string"&&!($ in X))return;const Y=typeof $==="string"?X[$]:$;if(Y.type==="object"&&"additionalProperties"in Y===!1)Y.additionalProperties=W;const J=(B)=>w0.Clean(Y,B);if(Z){const B={schema:Y,references:"",checkFunc:()=>{},code:"",Check:(M)=>w0.Check(Y,M),Errors:(M)=>w0.Errors(Y,M),Code:()=>""};if(Q&&Y.additionalProperties===!0)B.Clean=J;if(Y.config){if(B.config=Y.config,B?.schema?.config)delete B.schema.config}return B}const z=G1.Compile(Y,Object.values(X));if(z.Clean=J,Y.config){if(z.config=Y.config,z?.schema?.config)delete z.schema.config}return z},pW=($,{models:X={},dynamic:Z=!1,normalize:Q=!1,additionalProperties:W=Q})=>{if(!$)return;if(typeof $==="string"&&!($ in X))return;const Y=typeof $==="string"?X[$]:$,J=(B,M)=>{const q=(O)=>w0.Clean(B,O);if(Z)return{schema:B,references:"",checkFunc:()=>{},code:"",Check:(O)=>w0.Check(B,O),Errors:(O)=>w0.Errors(B,O),Code:()=>""};const U=G1.Compile(B,M);if(Q&&B.additionalProperties===!0)U.Clean=q;return U};if(H in Y){if("additionalProperties"in Y===!1)Y.additionalProperties=W;return{200:J(Y,Object.values(X))}}const z={};return Object.keys(Y).forEach((B)=>{const M=Y[+B];if(typeof M==="string"){if(M in X){const q=X[M];q.type==="object"&&"additionalProperties"in q,z[+B]=H in q?J(q,Object.values(X)):q}return}if(M.type==="object"&&"additionalProperties"in M===!1)M.additionalProperties=W;z[+B]=H in M?J(M,Object.values(X)):M}),z},PU=typeof Bun!=="undefined",_U=PU&&typeof Bun.hash==="function",v6=($)=>{if(_U)return Bun.hash($);let X=9;for(let Z=0;Z<$.length;)X=Math.imul(X^$.charCodeAt(Z++),387420489);return X=X^X>>>9},M7=({validator:$,defaultConfig:X={},config:Z,dynamic:Q,models:W})=>{let Y=I8($,{dynamic:Q,models:W,additionalProperties:!0});if(z$(X))if(Y)Y.config=HU(Y.config,Z);else Y=I8(e.Cookie({}),{dynamic:Q,models:W,additionalProperties:!0}),Y.config=X;return Y},fZ=($,X,Z)=>{const Q=(W)=>{if(!W)return;if(!Array.isArray(W)){const J=W;if(Z&&!J.checksum)J.checksum=Z;if(J.scope==="scoped")J.scope="local";return J}const Y=[...W];for(let J of Y){if(Z&&!J.checksum)J.checksum=Z;if(J.scope==="scoped")J.scope="local"}return Y};return{start:p0($.start,Q(X?.start)),request:p0($.request,Q(X?.request)),parse:p0($.parse,Q(X?.parse)),transform:p0($.transform,Q(X?.transform)),beforeHandle:p0($.beforeHandle,Q(X?.beforeHandle)),afterHandle:p0($.afterHandle,Q(X?.afterHandle)),mapResponse:p0($.mapResponse,Q(X?.mapResponse)),onResponse:p0($.onResponse,Q(X?.onResponse)),trace:$.trace,error:p0($.error,Q(X?.error)),stop:p0($.stop,Q(X?.stop))}},FU=($,X,{skipIfHasType:Z=!1}={})=>{if(!$)return $;if(!Array.isArray($)){if(Z)$.scope??=X;else $.scope=X;return $}for(let Q of $)if(Z)Q.scope??=X;else Q.scope=X;return $},l$=($)=>{if(!$)return $;if(!Array.isArray($))switch($.scope){case"global":case"scoped":return{...$};default:return{fn:$}}const X=[];for(let Z of $)switch(Z.scope){case"global":case"scoped":X.push({...Z});break}return X},mW=($)=>{return{...$,type:$?.type,detail:$?.detail,parse:l$($?.parse),transform:l$($?.transform),beforeHandle:l$($?.beforeHandle),afterHandle:l$($?.afterHandle),onResponse:l$($?.onResponse),error:l$($?.error),mapResponse:l$($?.mapResponse)}},t6={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},hW=Object.fromEntries(Object.entries(t6).map(([$,X])=>[X,$])),uW=new TextEncoder,u6=async($,X)=>{if(typeof $!=="string")throw new TypeError("Cookie value must be provided as a string.");if(X===null)throw new TypeError("Secret key must be provided.");const Z=await crypto.subtle.importKey("raw",uW.encode(X),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),Q=await crypto.subtle.sign("HMAC",Z,uW.encode($));return $+"."+SU(Buffer.from(Q).toString("base64"))},cW=async($,X)=>{if(typeof $!=="string")throw new TypeError("Signed cookie string must be provided.");if(X===null)throw new TypeError("Secret key must be provided.");const Z=$.slice(0,$.lastIndexOf("."));return await u6(Z,X)===$?Z:!1},U7=($,X,Z=X)=>{if(!$||typeof $!=="object"||!X)return;for(let[Q,W]of Object.entries(X)){if(Q in OU||!(Q in $))continue;const Y=$[Q];if(typeof Y==="function")Y(W);else if(typeof Y==="object")U7(Y,W,Z)}},KU=({globalHook:$,localHook:X})=>(Z)=>(Q,W)=>{if(typeof Q==="function")Q={fn:Q};if("fn"in Q||Array.isArray(Q)){if(!X[Z])X[Z]=[];if(typeof X[Z]==="function")X[Z]=[X[Z]];if(Array.isArray(Q))X[Z]=X[Z].concat(Q);else X[Z].push(Q);return}const{insert:Y="after",stack:J="local"}=Q;if(typeof W==="function")W={fn:W};if(J==="global")if(!Array.isArray(W))if(Y==="before")$[Z].unshift(W);else $[Z].push(W);else if(Y==="before")$[Z]=W.concat($[Z]);else $[Z]=$[Z].concat(W);else{if(!X[Z])X[Z]=[];if(typeof X[Z]==="function")X[Z]=[X[Z]];if(!Array.isArray(W))if(Y==="before")X[Z].unshift(W);else X[Z].push(W);else if(Y==="before")X[Z]=W.concat(X[Z]);else X[Z]=X[Z].concat(W)}},c6=($)=>{if($.length<16)return $.trim().length!==0&&!Number.isNaN(Number($));if($.length===16){const X=Number($);if(X.toString()===$)return $.trim().length!==0&&!Number.isNaN(X)}return!1},jU=class{constructor($=console.error){this.onError=$,this.root=null,this.promises=[]}get size(){return this.promises.length}add($){return this.promises.push($),this.root||=this.drain(),$}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch($){this.onError($)}this.promises.shift()}this.root=null}then($,X){return(this.root??Promise.resolve()).then($,X)}},E8=($)=>{if(!$)return $;if(!Array.isArray($)){if(typeof $==="function")return{fn:$};else if("fn"in $)return $}const X=[];for(let Z of $)if(typeof Z==="function")X.push({fn:Z});else if("fn"in Z)X.push(Z);return X},RU=($)=>{return{...$,start:E8($?.start),request:E8($?.request),parse:E8($?.parse),transform:E8($?.transform),beforeHandle:E8($?.beforeHandle),afterHandle:E8($?.afterHandle),onResponse:E8($?.onResponse),mapResponse:E8($?.mapResponse),trace:E8($?.trace),error:E8($?.error),stop:E8($?.stop)}},CU=($)=>{return{...$,start:$.start?.map((X)=>X.fn),request:$.request?.map((X)=>X.fn),parse:$.parse?.map((X)=>X.fn),transform:$.transform?.map((X)=>X.fn),beforeHandle:$.beforeHandle?.map((X)=>X.fn),afterHandle:$.afterHandle?.map((X)=>X.fn),onResponse:$.onResponse?.map((X)=>X.fn),mapResponse:$.mapResponse?.map((X)=>X.fn),trace:$.trace?.map((X)=>X.fn),error:$.error?.map((X)=>X.fn),stop:$.stop?.map((X)=>X.fn)}},yZ=($)=>({event:{body:$.event.body,cookie:$.event.cookie,headers:$.event.headers,queries:[...$.event.queries],query:$.event.query,set:$.event.set,unknownQueries:$.event.unknownQueries},trace:{request:$.trace.request,parse:$.trace.parse,transform:$.trace.transform,handle:$.trace.handle,beforeHandle:$.trace.beforeHandle,afterHandle:$.trace.afterHandle,error:$.trace.error,context:$.trace.context,store:$.trace.store,set:$.trace.set}}),iW=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,i6=Symbol("ElysiaErrorCode"),B$=Symbol("ElysiaResponse"),o6=(iW?.NODE_ENV??iW?.ENV)==="production",bU=($,X)=>({[B$]:t6[$]??$,response:X??($ in hW?hW[$]:$),_type:void 0}),VU=class extends Error{constructor($){super($??"INTERNAL_SERVER_ERROR");this.code="INTERNAL_SERVER_ERROR",this.status=500}},s$=class extends Error{constructor($){super($??"NOT_FOUND");this.code="NOT_FOUND",this.status=404}},EU=class extends Error{constructor($,X){super($??"PARSE");this.body=X,this.code="PARSE",this.status=400}},oW=class extends Error{constructor($,X){super(X??`"${$}" has invalid cookie signature`);this.key=$,this.code="INVALID_COOKIE_SIGNATURE",this.status=400}},m0=class $ extends Error{constructor(X,Z,Q){if(typeof Q==="object"&&B$ in Q)Q=Q.response;const W=o6?void 0:("Errors"in Z)?Z.Errors(Q).First():w0.Errors(Z,Q).First(),Y=W?.schema.error?typeof W.schema.error==="function"?W.schema.error(X,Z,Q):W.schema.error:void 0,J=W?.path||"root";let z="";if(Y)z=typeof Y==="object"?JSON.stringify(Y):Y+"";else if(o6)z=JSON.stringify({type:"validation",on:X,message:W?.message,found:Q});else{const B=Z?.schema??Z,M="Errors"in Z?[...Z.Errors(Q)]:[...w0.Errors(Z,Q)];let q;try{q=w0.Create(B)}catch(U){q={type:"Could not create expected value",message:U?.message,error:U}}z=JSON.stringify({type:"validation",on:X,property:J,message:W?.message,expected:q,found:Q,errors:M},null,2)}super(z);this.type=X,this.validator=Z,this.value=Q,this.code="VALIDATION",this.status=422,Object.setPrototypeOf(this,$.prototype)}get all(){return[...this.validator.Errors(this.value)]}static simplifyModel(X){const Z="schema"in X?X.schema:X;try{return w0.Create(Z)}catch{return Z}}get model(){return $.simplifyModel(this.validator)}toResponse(X){return new Response(this.message,{status:400,headers:{...X,"content-type":"application/json"}})}},lW={open($){$.data.open?.($)},message($,X){$.data.message?.($,X)},drain($){$.data.drain?.($)},close($,X,Z){$.data.close?.($,X,Z)}},p6=class{constructor($,X){if(this.raw=$,this.data=X,this.validator=$.data.validator,$.data.id)this.id=$.data.id;else{const Z=new Uint32Array(1);crypto.getRandomValues(Z),this.id=Z[0].toString()}}get id(){return this.raw.data.id}set id($){this.raw.data.id=$}get publish(){return($,X=void 0,Z)=>{if(this.validator?.Check(X)===!1)throw new m0("message",this.validator,X);if(typeof X==="object")X=JSON.stringify(X);return this.raw.publish($,X,Z),this}}get send(){return($)=>{if(this.validator?.Check($)===!1)throw new m0("message",this.validator,$);if(Buffer.isBuffer($))return this.raw.send($),this;if(typeof $==="object")$=JSON.stringify($);return this.raw.send($),this}}get subscribe(){return($)=>{return this.raw.subscribe($),this}}get unsubscribe(){return($)=>{return this.raw.unsubscribe($),this}}get cork(){return($)=>{return this.raw.cork($),this}}get close(){return()=>{return this.raw.close(),this}}get terminate(){return this.raw.terminate.bind(this.raw)}get isSubscribed(){return this.raw.isSubscribed.bind(this.raw)}get remoteAddress(){return this.raw.remoteAddress}},IU=(new Headers()).toJSON,D7={value:0},A7=({hasTrace:$,hasTraceSet:X=!1,addFn:Z,condition:Q={}})=>{if($)return Z(`
const reporter = getReporter()
`),(W,{name:Y,attribute:J="",unit:z=0}={})=>{const B=W.indexOf("."),M=B===-1;if(W!=="request"&&W!=="response"&&!Q[M?W:W.slice(0,B)])return()=>{if(X&&W==="afterHandle")Z(`
await traceDone
`)};if(M)Y||=W;else Y||="anonymous";return Z("\n"+`reporter.emit('event', {
					id,
					event: '${W}',
					type: 'begin',
					name: '${Y}',
					time: performance.now(),
					${M?`unit: ${z},`:""}
					${J}
				})`.replace(/(\t| |\n)/g,"")+"\n"),()=>{if(Z("\n"+`reporter.emit('event', {
							id,
							event: '${W}',
							type: 'end',
							time: performance.now()
						})`.replace(/(\t| |\n)/g,"")+"\n"),X&&W==="afterHandle")Z(`
await traceDone
`)}};else return()=>()=>{}},U6=($)=>{const X=$.indexOf(")");if($.charCodeAt(X+2)===61&&$.charCodeAt(X+5)!==123)return!0;return $.includes("return")},xU=($,{injectResponse:X="",normalize:Z=!1}={})=>({composeValidation:(Q,W=`c.${Q}`)=>$?`c.set.status = 422; throw new ValidationError('${Q}', ${Q}, ${W})`:`c.set.status = 422; return new ValidationError('${Q}', ${Q}, ${W}).toResponse(c.set.headers)`,composeResponseValidation:(Q="r")=>{const W=$?`throw new ValidationError('response', response[c.set.status], ${Q})`:`return new ValidationError('response', response[c.set.status], ${Q}).toResponse(c.set.headers)`;let Y="\n"+X+"\n";if(Y+=`let er

		if(${Q} && typeof ${Q} === "object" && ELYSIA_RESPONSE in ${Q})
			er = ${Q}[ELYSIA_RESPONSE]
`,Z)Y+=`
			if(!er && response[c.set.status]?.Clean)
				${Q} = response[c.set.status]?.Clean(${Q})
			else if(response[er]?.Clean)
				${Q}.response = response[er]?.Clean(${Q}.response)`;return Y+=`
			if(er) {
				if(!(${Q} instanceof Response) && response[er]?.Check(${Q}.response) === false) {
					if(!(response instanceof Error)) {
						c.set.status = ${Q}[ELYSIA_RESPONSE]

						${W}
					}
				}
			} else if(!(${Q} instanceof Response) && response[c.set.status]?.Check(${Q}) === false) {
				if(!(response instanceof Error))
					${W}
			}
`,Y}}),D1=Symbol.for("TypeBox.Kind"),l6=($,X)=>{if(!X)return;if(D1 in X&&X[D1]===$)return!0;if(X.type==="object"){const Z=X.properties;for(let Q of Object.keys(Z)){const W=Z[Q];if(W.type==="object"){if(l6($,W))return!0}else if(W.anyOf){for(let Y=0;Y<W.anyOf.length;Y++)if(l6($,W.anyOf[Y]))return!0}if(D1 in W&&W[D1]===$)return!0}return!1}return X.properties&&D1 in X.properties&&X.properties[D1]===$},n$=($,X)=>{if(!X)return;if(X.type==="object"){const Z=X.properties;if(!Z)return!1;for(let Q of Object.keys(Z)){const W=Z[Q];if($ in W)return!0;if(W.type==="object"){if(n$($,W))return!0}else if(W.anyOf){for(let Y=0;Y<W.anyOf.length;Y++)if(n$($,W.anyOf[Y]))return!0}}return!1}return $ in X},dZ=Symbol.for("TypeBox.Transform"),A1=($)=>{if(!$)return;if($.type==="object"&&$.properties){const X=$.properties;for(let Z of Object.keys(X)){const Q=X[Z];if(Q.type==="object"){if(A1(Q))return!0}else if(Q.anyOf){for(let Y=0;Y<Q.anyOf.length;Y++)if(A1(Q.anyOf[Y]))return!0}if(dZ in Q)return!0}return!1}return dZ in $||$.properties&&dZ in $.properties},kU=($)=>{if(!$)return;const X=$?.schema;if(X&&"anyOf"in X){let Z=!1;const Q=X.anyOf[0].type;for(let W of X.anyOf)if(W.type!==Q){Z=!0;break}if(!Z)return Q}return $.schema?.type},TU=/(?:return|=>) \S+\(/g,o0=($)=>{const X="fn"in $?$.fn:$;if(X.constructor.name==="AsyncFunction")return!0;const Z=X.toString();if(Z.includes("=> response.clone("))return!1;if(Z.includes("await"))return!0;if(Z.includes("async"))return!0;return!!Z.match(TU)},vZ=({app:$,path:X,method:Z,localHook:Q,hooks:W,validator:Y,handler:J,allowMeta:z=!1,appInference:{event:B,trace:M}})=>{const q=typeof J==="function";if(!q)J=Y$(J,{headers:$.setHeaders??{}});const U=$.config.forceErrorEncapsulation&&(q||W.afterHandle.length>0||W.beforeHandle.length>0||W.transform.length>0)||W.error.length>0||$.event.error.length>0||typeof Bun==="undefined"||W.onResponse.length>0||W.onResponse.length>0||!!W.trace.length,O=q?"handler(c)":"handler",_=W.onResponse.length?`
;(async () => {${W.onResponse.map((g,K)=>`await res${K}(c)`).join(";")}})();
`:"",I=M,b=W.trace.length>0;let D="";const F=Y7(Object.assign(Q,{handler:J}),B),j=F.query||!!Y.query,P=Z!=="$INTERNALWS"&&Z!=="GET"&&Z!=="HEAD"&&W.type!=="none"&&(F.body||!!Y.body),f=$.setHeaders,x=f&&!!Object.keys(f).length,q0=F.headers||Y.headers,_0=F.cookie||!!Y.cookie,M0=_0?M7({validator:Y.cookie,defaultConfig:$.config.cookie,dynamic:!!$.config.aot,config:Y.cookie?.config??{},models:$.definitions.type}):void 0,U0=M0?.config;let $0="";if(U0?.sign){if(!U0.secrets)throw new Error(`t.Cookie required secret which is not set in (${Z}) ${X}.`);const g=!U0.secrets?void 0:typeof U0.secrets==="string"?U0.secrets:U0.secrets[0];if($0+=`const _setCookie = c.set.cookie
		if(_setCookie) {`,U0.sign===!0)$0+=`for(const [key, cookie] of Object.entries(_setCookie)) {
				c.set.cookie[key].value = await signCookie(cookie.value, '${g}')
			}`;else for(let K of U0.sign)$0+=`if(_setCookie['${K}']?.value) { c.set.cookie['${K}'].value = await signCookie(_setCookie['${K}'].value, '${g}') }
`;$0+="}\n"}const m=$.config.normalize,{composeValidation:k0,composeResponseValidation:M$}=xU(U,{normalize:m});if(q0)D+=IU?`c.headers = c.request.headers.toJSON()
`:`c.headers = {}
                for (const [key, value] of c.request.headers.entries())
					c.headers[key] = value
				`;if(_0){const g=(V,o)=>{const j0=U0?.[V]??o;if(!j0)return typeof o==="string"?`${V}: "${o}",`:`${V}: ${o},`;if(typeof j0==="string")return`${V}: '${j0}',`;if(j0 instanceof Date)return`${V}: new Date(${j0.getTime()}),`;return`${V}: ${j0},`},K=U0?`{
			secrets: ${U0.secrets!==void 0?typeof U0.secrets==="string"?`'${U0.secrets}'`:"["+U0.secrets.reduce((V,o)=>V+`'${o}',`,"")+"]":"undefined"},
			sign: ${U0.sign===!0?!0:U0.sign!==void 0?"["+U0.sign.reduce((V,o)=>V+`'${o}',`,"")+"]":"undefined"},
			${g("domain")}
			${g("expires")}
			${g("httpOnly")}
			${g("maxAge")}
			${g("path","/")}
			${g("priority")}
			${g("sameSite")}
			${g("secure")}
		}`:"undefined";if(q0)D+=`
c.cookie = await parseCookie(c.set, c.headers.cookie, ${K})
`;else D+=`
c.cookie = await parseCookie(c.set, c.request.headers.get('cookie'), ${K})
`}if(j){let g=[];if(Y.query&&Y.query.schema.type==="object")g=Object.keys(Y.query.schema.properties);else for(let K of F.queries)if(g.indexOf(K)===-1)g.push(K);if($.config.forceDynamicQuery===!0||F.unknownQueries===!0||!g.length)D+=`if(c.qi !== -1) {
				c.query = parseQuery(c.request.url.slice(c.qi + 1).replace(/\\+/g, ' '))

				for(const key of Object.keys(c.query))
					c.query[key] = decodeURIComponent(c.query[key])
			} else c.query = {}`;else D+=`if(c.qi !== -1) {
				let url = c.request.url.slice(c.qi).replace(/\\+/g, ' ')

				${g.map((K,V)=>`
						${V===0?"let":""} memory = url.indexOf('&${K}=')
						if(memory === -1) memory = url.indexOf('?${K}=')
						let a${V}

						if(memory !== -1) {
							const start = memory + ${K.length+2}
							memory = url.indexOf('&', start)

							if(memory === -1) a${V} = decodeURIComponent(url.slice(start))
							else a${V} = decodeURIComponent(url.slice(start, memory))
						}`).join("\n")}

				c.query = {
					${g.map((K,V)=>`'${K}': a${V}`).join(", ")}
				}
			} else {
				c.query = {}
			}`}const k8=M.set,P8=F.cookie||F.set||k8||q0||q&&x;if(b)D+="\nconst id = c.$$requestId\n";const G0=A7({hasTrace:b,hasTraceSet:k8,condition:I,addFn:(g)=>{D+=g}});if(D+=U?"\n try {\n":"",k8){D+=`
const traceDone = Promise.all([`;for(let g=0;g<W.trace.length;g++)D+=`new Promise(r => { reporter.once(\`res\${id}.${g}\`, r) }),`;D+=`])
`}const $8=typeof J==="function"&&o0(J),T8=_0||P||k8||$8||!!W.mapResponse.length||W.parse.length>0||W.afterHandle.some(o0)||W.beforeHandle.some(o0)||W.transform.some(o0),y0=G0("parse",{unit:W.parse.length});if(P){const g=kU(Y?.body);if(W.type&&!Array.isArray(W.type)){if(W.type)switch(W.type){case"json":case"application/json":if(U)D+=`const tempBody = await c.request.text()

							try {
								c.body = JSON.parse(tempBody)
							} catch {
								throw new ParseError('Failed to parse body as found: ' + (typeof body === "string" ? "'" + body + "'" : body), body)
							}`;else D+="c.body = await c.request.json()";break;case"text":case"text/plain":D+=`c.body = await c.request.text()
`;break;case"urlencoded":case"application/x-www-form-urlencoded":D+=`c.body = parseQuery(await c.request.text())
`;break;case"arrayBuffer":case"application/octet-stream":D+=`c.body = await c.request.arrayBuffer()
`;break;case"formdata":case"multipart/form-data":D+=`c.body = {}

						const form = await c.request.formData()
						for (const key of form.keys()) {
							if (c.body[key])
								continue

							const value = form.getAll(key)
							if (value.length === 1)
								c.body[key] = value[0]
							else c.body[key] = value
						}
`;break}if(W.parse.length)D+="}}"}else{const V=(()=>{if(W.parse.length&&g&&!Array.isArray(W.type)){const o=Y?.body?.schema;if(typeof o==="object"&&(l6("File",o)||l6("Files",o)))return`c.body = {}

								const form = await c.request.formData()
								for (const key of form.keys()) {
									if (c.body[key])
										continue

									const value = form.getAll(key)
									if (value.length === 1)
										c.body[key] = value[0]
									else c.body[key] = value
								}`}})();if(V)D+=V;else{if(D+="\n",D+=q0?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",D+=`
				if (contentType) {
					const index = contentType.indexOf(';')
					if (index !== -1) contentType = contentType.substring(0, index)
`,W.parse.length){D+=`let used = false
`;const o=G0("parse",{unit:W.parse.length});for(let j0=0;j0<W.parse.length;j0++){const R$=G0("parse.unit",{name:W.parse[j0].fn.name}),i8=`bo${j0}`;if(j0!==0)D+=`if(!used) {
`;if(D+=`let ${i8} = parse[${j0}](c, contentType)
`,D+=`if(${i8} instanceof Promise) ${i8} = await ${i8}
`,D+=`if(${i8} !== undefined) { c.body = ${i8}; used = true }
`,R$(),j0!==0)D+="}"}o()}if(W.parse.length)D+="if (!used)";D+=`
				switch (contentType) {
					case 'application/json':
						${U?`
						const tempBody = await c.request.text()

						try {
							c.body = JSON.parse(tempBody)
						} catch {
							throw new ParseError('Failed to parse body as found: ' + (typeof body === "string" ? "'" + body + "'" : body), body)
						}
						`:`c.body = await c.request.json()
`}
						break

					case 'text/plain':
						c.body = await c.request.text()
						break

					case 'application/x-www-form-urlencoded':
						c.body = parseQuery(await c.request.text())
						break

					case 'application/octet-stream':
						c.body = await c.request.arrayBuffer();
						break

					case 'multipart/form-data':
						c.body = {}

						const form = await c.request.formData()
						for (const key of form.keys()) {
							if (c.body[key])
								continue

							const value = form.getAll(key)
							if (value.length === 1)
								c.body[key] = value[0]
							else c.body[key] = value
						}

						break
					}
`,D+="}\n"}}D+="\n"}if(y0(),W?.transform){const g=G0("transform",{unit:W.transform.length});if(W.transform.length)D+="\nlet transformed\n";for(let K=0;K<W.transform.length;K++){const V=W.transform[K],o=G0("transform.unit",{name:V.fn.name});D+=o0(V)?`transformed = await transform[${K}](c)
`:`transformed = transform[${K}](c)
`,D+=`if(transformed?.[ELYSIA_RESPONSE])
				throw transformed
			else
				Object.assign(c, transformed)
`,o()}g()}if(Y){if(D+="\n",Y.headers){if(n$("default",Y.headers.params))for(let[g,K]of Object.entries(w0.Default(Y.headers.schema,{}))){const V=typeof K==="object"?JSON.stringify(K):`'${K}'`;if(V)D+=`c.headers['${g}'] ??= ${V}
`}if(D+=`if(headers.Check(c.headers) === false) {
				${k0("headers")}
			}`,A1(Y.headers.schema))D+=`
c.headers = headers.Decode(c.headers)
`}if(Y.params){if(n$("default",Y.params.schema))for(let[g,K]of Object.entries(w0.Default(Y.params.schema,{}))){const V=typeof K==="object"?JSON.stringify(K):`'${K}'`;if(V)D+=`c.params['${g}'] ??= ${V}
`}if(D+=`if(params.Check(c.params) === false) {
				${k0("params")}
			}`,A1(Y.params.schema))D+=`
c.params = params.Decode(c.params)
`}if(Y.query){if(m)D+="c.query = query.Clean(c.query);\n";if(n$("default",Y.query.schema))for(let[g,K]of Object.entries(w0.Default(Y.query.schema,{}))){const V=typeof K==="object"?JSON.stringify(K):`'${K}'`;if(V)D+=`c.query['${g}'] ??= ${V}
`}if(D+=`if(query.Check(c.query) === false) {
				${k0("query")}
			}`,A1(Y.query.schema))D+=`
c.query = query.Decode(Object.assign({}, c.query))
`}if(Y.body){if(m)D+="c.body = body.Clean(c.body);\n";if(n$("default",Y.body.schema))D+=`if(body.Check(c.body) === false) {
    				c.body = Object.assign(${JSON.stringify(w0.Default(Y.body.schema,null)??{})}, c.body)

    				if(body.Check(c.query) === false) {
        				${k0("body")}
     			}
            }`;else D+=`if(body.Check(c.body) === false) {
			${k0("body")}
		}`;if(A1(Y.body.schema))D+=`
c.body = body.Decode(c.body)
`}if(z$(M0?.schema.properties??{})){if(D+=`const cookieValue = {}
    			for(const [key, value] of Object.entries(c.cookie))
    				cookieValue[key] = value.value
`,n$("default",M0.schema))for(let[g,K]of Object.entries(w0.Default(M0.schema,{})))D+=`cookieValue['${g}'] = ${typeof K==="object"?JSON.stringify(K):K}
`;D+=`if(cookie.Check(cookieValue) === false) {
				${k0("cookie","cookieValue")}
			}`}}if(W?.beforeHandle){const g=G0("beforeHandle",{unit:W.beforeHandle.length});let K=!1;for(let V=0;V<W.beforeHandle.length;V++){const o=W.beforeHandle[V],j0=G0("beforeHandle.unit",{name:o.fn.name}),R$=U6(o.fn.toString());if(o.subType==="resolve"){if(!K)K=!0,D+="\nlet resolved\n";D+=o0(o)?`resolved = await beforeHandle[${V}](c);
`:`resolved = beforeHandle[${V}](c);
`,D+=`if(resolved[ELYSIA_RESPONSE])
						throw resolved
					else
						Object.assign(c, resolved)
`}else if(!R$)D+=o0(o)?`await beforeHandle[${V}](c);
`:`beforeHandle[${V}](c);
`,j0();else{D+="Object.assign(c, be);",D+=o0(o)?`be = await beforeHandle[${V}](c);
`:`be = beforeHandle[${V}](c);
`,j0(),D+=`if(be !== undefined) {
`,g();const YX=G0("afterHandle",{unit:W.transform.length});if(W.afterHandle){G0("handle",{name:q?J.name:void 0})();for(let G=0;G<W.afterHandle.length;G++){const C=W.afterHandle[G],A=U6(C.fn.toString()),y=G0("afterHandle.unit",{name:C.fn.name});if(D+=`c.response = be
`,!A)D+=o0(C.fn)?`await afterHandle[${G}](c, be)
`:`afterHandle[${G}](c, be)
`;else D+=o0(C.fn)?`af = await afterHandle[${G}](c)
`:`af = afterHandle[${G}](c)
`,D+=`if(af !== undefined) { c.response = be = af }
`;y()}}if(YX(),Y.response)D+=M$("be");if(W.mapResponse.length){D+="c.response = be";for(let G=0;G<W.mapResponse.length;G++)D+=`
if(mr === undefined) {
							mr = onMapResponse[${G}](c)
							if(mr instanceof Promise) mr = await mr
							if(mr !== undefined) c.response = mr
						}
`}D+=$0,D+=`return mapEarlyResponse(be, c.set, c.request)}
`}}g()}if(W?.afterHandle.length){const g=G0("handle",{name:q?J.name:void 0});if(W.afterHandle.length)D+=$8?`let r = c.response = await ${O};
`:`let r = c.response = ${O};
`;else D+=$8?`let r = await ${O};
`:`let r = ${O};
`;g();const K=G0("afterHandle",{unit:W.afterHandle.length});for(let V=0;V<W.afterHandle.length;V++){const o=W.afterHandle[V],j0=U6(o.fn.toString()),R$=G0("afterHandle.unit",{name:o.fn.name});if(!j0)D+=o0(o.fn)?`await afterHandle[${V}](c)
`:`afterHandle[${V}](c)
`,R$();else if(D+=o0(o.fn)?`af = await afterHandle[${V}](c)
`:`af = afterHandle[${V}](c)
`,R$(),Y.response)D+="if(af !== undefined) {",K(),D+=M$("af"),D+="c.response = af }";else D+="if(af !== undefined) {",K(),D+=`c.response = af}
`}if(K(),D+=`r = c.response
`,Y.response)D+=M$();if(D+=$0,W.mapResponse.length)for(let V=0;V<W.mapResponse.length;V++)D+=`
mr = onMapResponse[${V}](c)
				if(mr instanceof Promise) mr = await mr
				if(mr !== undefined) c.response = mr
`;if(P8)D+=`return mapResponse(r, c.set, c.request)
`;else D+=`return mapCompactResponse(r, c.request)
`}else{const g=G0("handle",{name:q?J.name:void 0});if(Y.response||W.mapResponse.length){if(D+=$8?`let r = await ${O};
`:`let r = ${O};
`,g(),Y.response)D+=M$();if(G0("afterHandle")(),W.mapResponse.length){D+="c.response = r";for(let K=0;K<W.mapResponse.length;K++)D+=`
if(mr === undefined) {
						mr = onMapResponse[${K}](c)
						if(mr instanceof Promise) mr = await mr
    					if(mr !== undefined) r = c.response = mr
					}
`}if(D+=$0,J instanceof Response)D+=F.set?`if(
					isNotEmpty(c.set.headers) ||
					c.set.status !== 200 ||
					c.set.redirect ||
					c.set.cookie
				)
					return mapResponse(${O}.clone(), c.set, c.request)
				else
					return ${O}.clone()`:`return ${O}.clone()`,D+="\n";else if(P8)D+=`return mapResponse(r, c.set, c.request)
`;else D+=`return mapCompactResponse(r, c.request)
`}else if(I.handle||_0){if(D+=$8?`let r = await ${O};
`:`let r = ${O};
`,g(),G0("afterHandle")(),W.mapResponse.length){D+="c.response = r";for(let K=0;K<W.mapResponse.length;K++)D+=`
if(mr === undefined) {
							mr = onMapResponse[${K}](c)
							if(mr instanceof Promise) mr = await mr
    						if(mr !== undefined) r = c.response = mr
						}
`}if(D+=$0,P8)D+=`return mapResponse(r, c.set, c.request)
`;else D+=`return mapCompactResponse(r, c.request)
`}else{g();const K=$8?`await ${O}`:O;if(G0("afterHandle")(),J instanceof Response)D+=F.set?`if(
					isNotEmpty(c.set.headers) ||
					c.set.status !== 200 ||
					c.set.redirect ||
					c.set.cookie
				)
					return mapResponse(${O}.clone(), c.set, c.request)
				else
					return ${O}.clone()`:`return ${O}.clone()`,D+="\n";else if(P8)D+=`return mapResponse(${K}, c.set, c.request)
`;else D+=`return mapCompactResponse(${K}, c.request)
`}}if(U||_){if(D+=`
} catch(error) {`,!T8)D+="return (async () => {";D+=`const set = c.set
if (!set.status || set.status < 300) set.status = error?.status || 500
`;const g=G0("error",{unit:W.error.length});if(W.error.length){D+=`
				c.error = error
				c.code = error.code ?? error[ERROR_CODE] ?? "UNKNOWN"
			`;for(let K=0;K<W.error.length;K++){const V=`er${K}`,o=G0("error.unit",{name:W.error[K].fn.name});if(D+=`
let ${V} = handleErrors[${K}](c)
`,o0(W.error[K]))D+=`if (${V} instanceof Promise) ${V} = await ${V}
`;o(),D+=`${V} = mapEarlyResponse(${V}, set, c.request)
`,D+=`if (${V}) {`,D+=`return ${V} }
`}}if(g(),D+=`return handleError(c, error, true)

`,!T8)D+="})()";if(D+="}",_||b){D+=" finally { ";const K=G0("response",{unit:W.onResponse.length});D+=_,K(),D+="}"}}return D=`const {
		handler,
		handleError,
		hooks: {
			transform,
			resolve,
			beforeHandle,
			afterHandle,
			mapResponse: onMapResponse,
			parse,
			error: handleErrors,
			onResponse
		},
		validator: {
			body,
			headers,
			params,
			query,
			response,
			cookie
		},
		utils: {
			mapResponse,
			mapCompactResponse,
			mapEarlyResponse,
			parseQuery,
			isNotEmpty
		},
		error: {
			NotFoundError,
			ValidationError,
			InternalServerError,
			ParseError
		},
		schema,
		definitions,
		ERROR_CODE,
		getReporter,
		requestId,
		parseCookie,
		signCookie,
		decodeURIComponent,
		ELYSIA_RESPONSE
	} = hooks

	${W.onResponse.length?`const ${W.onResponse.map((g,K)=>`res${K} = onResponse[${K}]`).join(",")}`:""}

	return ${T8?"async":""} function handle(c) {
		${W.beforeHandle.length?"let be":""}
		${W.afterHandle.length?"let af":""}
		${W.mapResponse.length?"let mr":""}

		${z?"c.schema = schema; c.defs = definitions":""}
		${D}
	}`,Function("hooks",D)({handler:J,hooks:CU(W),validator:Y,handleError:$.handleError,utils:{mapResponse:Y$,mapCompactResponse:t$,mapEarlyResponse:W$,parseQuery:G7.parse,isNotEmpty:z$},error:{NotFoundError:s$,ValidationError:m0,InternalServerError:VU,ParseError:EU},schema:$.router.history,definitions:$.definitions.type,ERROR_CODE:i6,getReporter:()=>$.reporter,requestId:D7,parseCookie:z7,signCookie:u6,decodeURIComponent:w7.default,ELYSIA_RESPONSE:B$})},nW=($)=>{const X={event:{...$.inference.event,queries:[...$.inference.event.queries]},trace:{...$.inference.trace}};let Z="",Q="";const W=$.setHeaders;for(let D of Object.keys($.singleton.decorator))Z+=`,${D}: app.singleton.decorator.${D}`;const Y=$.router,J=$.event.trace.length>0;let z=`
	const route = router.find(request.method, path) ${Y.http.root.ALL?'?? router.find("ALL", path)':""}

	if (route === null)
		return ${$.event.error.length?"app.handleError(ctx, notFound)":$.event.request.length?`new Response(error404Message, {
					status: ctx.set.status === 200 ? 404 : ctx.set.status,
					headers: ctx.set.headers
				})`:"error404.clone()"}

	ctx.params = route.params
`;if(!($.config.precompile===!0||typeof $.config.precompile==="object"&&$.config.precompile.compose===!0))z+=`
			if(route.store.composed)
				return route.store.composed(ctx)

			if(route.store.compose)
				return (route.store.compose())(ctx)`;else z+="return route.store(ctx)";z+="\n";let M="";for(let[D,{code:F,all:j}]of Object.entries(Y.static.http.map))M+=`case '${D}':
switch(request.method) {
${F}
${j??"default: break map"}}

`;const q=$.event.request.some(o0),U=`

	const url = request.url
	const s = url.indexOf('/', 11)
	const qi = url.indexOf('?', s + 1)
	let path
	if(qi === -1)
		path = url.substring(s)
	else
		path = url.substring(s, qi)
`;if(Q+=`const {
		app,
		mapEarlyResponse,
		NotFoundError,
		requestId,
		getReporter,
		handleError,
		error
	} = data

	const store = app.singleton.store
	const staticRouter = app.router.static.http
	const wsRouter = app.router.ws
	const router = app.router.http

	const notFound = new NotFoundError()

	${$.event.request.length?"const onRequest = app.event.request.map(x => x.fn)":""}
	${Y.static.http.variables}
	${$.event.error.length?"":`
	const error404Message = notFound.message.toString()
	const error404 = new Response(error404Message, { status: 404 });
	`}

	return ${q?"async":""} function map(request) {
`,$.event.request.length)Q+="let re";const O=A7({hasTrace:J,hasTraceSet:X.trace.set,condition:{request:X.trace.request},addFn:(D)=>{Q+=D}});if($.event.request.length){Q+=`
			${J?"const id = +requestId.value++":""}

			const ctx = {
				request,
				store,
				set: {
					headers: ${Object.keys(W??{}).length?"Object.assign({}, app.setHeaders)":"{}"},
					status: 200
				},
				error
				${J?",$$requestId: +id":""}
				${Z}
			}
		`;const D=O("request",{attribute:"ctx",unit:$.event.request.length});Q+=`
 try {
`;for(let F=0;F<$.event.request.length;F++){const j=$.event.request[F],P=U6(j.fn.toString()),f=o0(j),x=O("request.unit",{name:$.event.request[F].fn.name});if(P)Q+=`re = mapEarlyResponse(
					${f?"await":""} onRequest[${F}](ctx),
					ctx.set,
					request
				)
`,x(),Q+=`if(re !== undefined) return re
`;else Q+=`${f?"await":""} onRequest[${F}](ctx)
`,x()}Q+=`} catch (error) {
			return app.handleError(ctx, error)
		}`,D(),Q+=U,Q+=`
ctx.qi = qi
 ctx.path = path
`}else Q+=U,Q+=`${J?"const id = +requestId.value++":""}
		const ctx = {
			request,
			store,
			qi,
			path,
			set: {
				headers: ${Object.keys(W??{}).length?"Object.assign({}, app.setHeaders)":"{}"},
				status: 200
			},
			error
			${J?",$$requestId: id":""}
			${Z}
		}`,O("request",{unit:$.event.request.length,attribute:X.trace.context||X.trace.store||X.trace.set?"ctx":""})();const _=$.router.static.ws,I=$.router.ws;if(Object.keys(_).length||I.history.length){Q+=`
			if(request.method === 'GET') {
				switch(path) {`;for(let[D,F]of Object.entries(_))Q+=`
					case '${D}':
						if(request.headers.get('upgrade') === 'websocket')
							return st${F}(ctx)

						break`;Q+=`
				default:
					if(request.headers.get('upgrade') === 'websocket') {
						const route = wsRouter.find('ws', path)

						if(route) {
							ctx.params = route.params

							return route.store(ctx)
						}
					}

					break
			}
		}
`}Q+=`
		map: switch(path) {
			${M}

			default:
				break
		}

		${z}
	}`;const b=H7($);return $.handleError=b,Function("data",Q)({app:$,mapEarlyResponse:W$,NotFoundError:s$,getReporter:()=>$.reporter,requestId:D7,handleError:b,error:bU})},H7=($)=>{let X=`const {
		app: { event: { error: onErrorContainer, onResponse: resContainer } },
		mapResponse,
		ERROR_CODE,
		ELYSIA_RESPONSE
	} = inject

	const onError = onErrorContainer.map(x => x.fn)
	const res = resContainer.map(x => x.fn)

	return ${$.event.error.find(o0)?"async":""} function(context, error, skipGlobal) {
		let r

		const { set } = context

		context.code = error.code
		context.error = error

		if(typeof error === "object" && ELYSIA_RESPONSE in error) {
			error.status = error[ELYSIA_RESPONSE]
			error.message = error.response
		}
`;for(let Z=0;Z<$.event.error.length;Z++){const Q=$.event.error[Z],W=`${o0(Q)?"await ":""}onError[${Z}](context)`;if(X+="\nif(skipGlobal !== true) {\n",U6(Q.fn.toString()))X+=`r = ${W}; if(r !== undefined) {
				if(r instanceof Response) return r

				if(r[ELYSIA_RESPONSE]) {
					error.status = error[ELYSIA_RESPONSE]
					error.message = error.response
				}

				if(set.status === 200) set.status = error.status
				return mapResponse(r, set, context.request)
			}
`;else X+=W+"\n";X+="\n}\n"}return X+=`if(error.constructor.name === "ValidationError" || error.constructor.name === "TransformDecodeError") {
		set.status = error.status ?? 422
		return new Response(
			error.message,
			{
				headers: Object.assign(
					{ 'content-type': 'application/json'},
					set.headers
				),
				status: set.status
			}
		)
	} else {
		if(error.code && typeof error.status === "number")
			return new Response(
				error.message,
				{ headers: set.headers, status: error.status }
			)

		return mapResponse(error, set, context.request)
	}
}`,Function("inject",X)({app:$,mapResponse:Y$,ERROR_CODE:i6,ELYSIA_RESPONSE:B$})},m6=($)=>`if(stc${$}) return stc${$}(ctx)
if(st${$}.compose) return (stc${$} = st${$}.compose())(ctx)

return st${$}(ctx)`,tW=($)=>async(X)=>{const Z=X.url,Q=Z.indexOf("/",11),W=Z.indexOf("?",Q+1),Y=W===-1?Z.substring(Q):Z.substring(Q,W),J={cookie:{},status:200,headers:{}},z=Object.assign({},$.singleton.decorator,{set:J,store:$.singleton.store,request:X,path:Y,qi:W});try{for(let F=0;F<$.event.request.length;F++){const j=$.event.request[F].fn;let P=j(z);if(P instanceof Promise)P=await P;if(P=W$(P,J),P)return P}const B=$.router.dynamic.find(X.method,Y)??$.router.dynamic.find("ALL",Y);if(!B)throw new s$;const{handle:M,hooks:q,validator:U,content:O}=B.store;let _;if(X.method!=="GET"&&X.method!=="HEAD")if(O)switch(O){case"application/json":_=await X.json();break;case"text/plain":_=await X.text();break;case"application/x-www-form-urlencoded":_=h6.parse(await X.text());break;case"application/octet-stream":_=await X.arrayBuffer();break;case"multipart/form-data":_={};const F=await X.formData();for(let j of F.keys()){if(_[j])continue;const P=F.getAll(j);if(P.length===1)_[j]=P[0];else _[j]=P}break}else{let F=X.headers.get("content-type");if(F){const j=F.indexOf(";");if(j!==-1)F=F.slice(0,j);for(let P=0;P<q.parse.length;P++){const f=q.parse[P].fn;let x=f(z,F);if(x instanceof Promise)x=await x;if(x){_=x;break}}if(_===void 0)switch(F){case"application/json":_=await X.json();break;case"text/plain":_=await X.text();break;case"application/x-www-form-urlencoded":_=h6.parse(await X.text());break;case"application/octet-stream":_=await X.arrayBuffer();break;case"multipart/form-data":_={};const P=await X.formData();for(let f of P.keys()){if(_[f])continue;const x=P.getAll(f);if(x.length===1)_[f]=x[0];else _[f]=x}break}}}z.body=_,z.params=B?.params||void 0,z.query=W===-1?{}:h6.parse(Z.substring(W+1)),z.headers={};for(let[F,j]of X.headers.entries())z.headers[F]=j;const I=Object.assign({},$.config?.cookie,U?.cookie?.config),b=X.headers.get("cookie");z.cookie=await z7(z.set,b,I?{secrets:I.secrets!==void 0?typeof I.secrets==="string"?I.secrets:I.secrets.join(","):void 0,sign:I.sign===!0?!0:I.sign!==void 0?typeof I.sign==="string"?I.sign:I.sign.join(","):void 0}:void 0);for(let F=0;F<q.transform.length;F++){const j=q.transform[F],P=j.fn(z);if(j.subType==="derive")if(P instanceof Promise)Object.assign(z,await P);else Object.assign(z,P);else if(P instanceof Promise)await P}if(U){if(U.headers){const F={};for(let j in X.headers)F[j]=X.headers.get(j);if(U.headers.Check(F)===!1)throw new m0("header",U.headers,F)}if(U.params?.Check(z.params)===!1)throw new m0("params",U.params,z.params);if(U.query?.Check(z.query)===!1)throw new m0("query",U.query,z.query);if(U.cookie){const F={};for(let[j,P]of Object.entries(z.cookie))F[j]=P.value;if(U.cookie?.Check(F)===!1)throw new m0("cookie",U.cookie,F)}if(U.body?.Check(_)===!1)throw new m0("body",U.body,_)}for(let F=0;F<q.beforeHandle.length;F++){let j=q.beforeHandle[F].fn(z);if(j instanceof Promise)j=await j;if(j!==void 0){z.response=j;for(let f=0;f<q.afterHandle.length;f++){let x=q.afterHandle[f].fn(z);if(x instanceof Promise)x=await x;if(x)j=x}const P=W$(j,z.set);if(P)return P}}let D=M(z);if(D instanceof Promise)D=await D;if(!q.afterHandle.length){const F=U?.response?.[D.status];if(F?.Check(D)===!1)throw new m0("response",F,D)}else{z.response=D;for(let F=0;F<q.afterHandle.length;F++){let j=q.afterHandle[F].fn(z);if(j instanceof Promise)j=await j;const P=W$(j,z.set);if(P!==void 0){const f=U?.response?.[D.status];if(f?.Check(P)===!1)throw new m0("response",f,P);return P}}}if(z.set.cookie&&I?.sign){const F=!I.secrets?void 0:typeof I.secrets==="string"?I.secrets:I.secrets[0];if(I.sign===!0)for(let[j,P]of Object.entries(z.set.cookie))z.set.cookie[j].value=await u6(P.value,"${secret}");else{const j=U?.cookie?.schema?.properties;for(let P of I.sign){if(!(P in j))continue;if(z.set.cookie[P]?.value)z.set.cookie[P].value=await u6(z.set.cookie[P].value,F)}}}return Y$(D,z.set)}catch(B){if(B.status)J.status=B.status;return $.handleError(z,B)}finally{for(let B of $.event.onResponse)await B.fn(z)}},gU=($)=>async(X,Z)=>{const Q=Object.assign(X,{error:Z,code:Z.code});Q.set=X.set;for(let W=0;W<$.event.error.length;W++){let J=$.event.error[W].fn(Q);if(J instanceof Promise)J=await J;if(J!==void 0&&J!==null)return Y$(J,X.set)}return new Response(typeof Z.cause==="string"?Z.cause:Z.message,{headers:X.set.headers,status:Z.status??500})},cZ={date:N7,time:mZ(!0),"date-time":sW(!0),"iso-time":mZ(!1),"iso-date-time":sW(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:uU,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:sU,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:cU,int32:{type:"number",validate:lU},int64:{type:"number",validate:nU},float:{type:"number",validate:aW},double:{type:"number",validate:aW},password:!0,binary:!0},yU=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,dU=[0,31,28,31,30,31,30,31,31,30,31,30,31],vU=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i,pU=/t|\s/i,mU=/\/|:/,hU=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,rW=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm,iU=-2147483648,oU=2147483647,tU=/[^\\]\\Z/,O7=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,L7=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,P7=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,rU=cZ.date,aU=cZ["date-time"];t8.Format("date",($)=>{const X=$.replace(/"/g,"");if(O7.test(X)||L7.test(X)||P7.test(X)||rU(X)){const Z=new Date(X);if(!Number.isNaN(Z.getTime()))return!0}return!1});t8.Format("date-time",($)=>{const X=$.replace(/"/g,"");if(O7.test(X)||L7.test(X)||P7.test(X)||aU(X)){const Z=new Date(X);if(!Number.isNaN(Z.getTime()))return!0}return!1});Object.entries(cZ).forEach(($)=>{const[X,Z]=$;if(!R0.Has(X)){if(Z instanceof RegExp)t8.Format(X,(Q)=>Z.test(Q));else if(typeof Z==="function")t8.Format(X,Z)}});var e=Object.assign({},U1),eW=($)=>{if(typeof $==="string")switch($.slice(-1)){case"k":return+$.slice(0,$.length-1)*1024;case"m":return+$.slice(0,$.length-1)*1048576;default:return+$}return $},hZ=($,X)=>{if(!(X instanceof Blob))return!1;if($.minSize&&X.size<eW($.minSize))return!1;if($.maxSize&&X.size>eW($.maxSize))return!1;if($.extension)if(typeof $.extension==="string"){if(!X.type.startsWith($.extension))return!1}else{for(let Z=0;Z<$.extension.length;Z++)if(X.type.startsWith($.extension[Z]))return!0;return!1}return!0},eU=E0.Get("Files")??t8.Type("File",hZ),$G=E0.Get("Files")??t8.Type("Files",($,X)=>{if(!Array.isArray(X))return hZ($,X);if($.minItems&&X.length<$.minItems)return!1;if($.maxItems&&X.length>$.maxItems)return!1;for(let Z=0;Z<X.length;Z++)if(!hZ($,X[Z]))return!1;return!0});if(!R0.Has("numeric"))R0.Set("numeric",($)=>!!$&&!isNaN(+$));if(!R0.Has("boolean"))R0.Set("boolean",($)=>$==="true"||$==="false");if(!R0.Has("ObjectString"))R0.Set("ObjectString",($)=>{let X=$.charCodeAt(0);if(X===9||X===10||X===32)X=$.trimStart().charCodeAt(0);if(X!==123&&X!==91)return!1;try{return JSON.parse($),!0}catch{return!1}});var K$={Numeric:($)=>{const X=U1.Number($);return e.Transform(e.Union([e.String({format:"numeric",default:0}),e.Number($)],$)).Decode((Z)=>{const Q=+Z;if(isNaN(Q))return Z;if($&&!w0.Check(X,Q))throw new m0("property",X,Q);return Q}).Encode((Z)=>Z)},Date:($)=>{const X=U1.Date($);return e.Transform(e.Union([U1.Date($),e.String({format:"date",default:(new Date()).toISOString()}),e.String({format:"date-time",default:(new Date()).toISOString()})],$)).Decode((Z)=>{if(Z instanceof Date)return Z;const Q=new Date(Z);if(!w0.Check(X,Q))throw new m0("property",X,Q);return Q}).Encode((Z)=>{if(typeof Z==="string")return new Date(Z);return Z})},BooleanString:($)=>{const X=U1.Boolean($);return e.Transform(e.Union([e.String({format:"boolean",default:!1}),e.Boolean($)],$)).Decode((Z)=>{if(typeof Z==="string")return Z==="true";if($&&!w0.Check(X,Z))throw new m0("property",X,Z);return Z}).Encode((Z)=>Z)},ObjectString:($={},X)=>{const Z=e.Object($,X),Q=JSON.stringify(w0.Create(Z));return e.Transform(e.Union([e.String({format:"ObjectString",default:Q}),Z])).Decode((W)=>{if(typeof W==="string"){try{W=JSON.parse(W)}catch{throw new m0("property",Z,W)}if(!w0.Check(Z,W))throw new m0("property",Z,W);return W}return W}).Encode((W)=>{if(typeof W==="string")try{W=JSON.parse(W)}catch{throw new m0("property",Z,W)}if(!w0.Check(Z,W))throw new m0("property",Z,W);return JSON.stringify(W)})},File:eU,Files:($={})=>e.Transform($G($)).Decode((X)=>{if(Array.isArray(X))return X;return[X]}).Encode((X)=>X),Nullable:($)=>e.Union([e.Null(),$]),MaybeEmpty:($)=>e.Union([e.Null(),e.Undefined(),$]),Cookie:($,{domain:X,expires:Z,httpOnly:Q,maxAge:W,path:Y,priority:J,sameSite:z,secure:B,secrets:M,sign:q,...U}={})=>{const O=e.Object($,U);return O.config={domain:X,expires:Z,httpOnly:Q,maxAge:W,path:Y,priority:J,sameSite:z,secure:B,secrets:M,sign:q},O}};e.BooleanString=K$.BooleanString;e.ObjectString=K$.ObjectString;e.Numeric=K$.Numeric;e.File=($={})=>K$.File({default:"File",...$,extension:$?.type,type:"string",format:"binary"});e.Files=($={})=>K$.Files({...$,elysiaMeta:"Files",default:"Files",extension:$?.type,type:"array",items:{...$,default:"Files",type:"string",format:"binary"}});e.Nullable=($)=>K$.Nullable($);e.MaybeEmpty=K$.MaybeEmpty;e.Cookie=K$.Cookie;e.Date=K$.Date;var N1=class ${constructor(X){if(this.server=null,this.dependencies={},this.reporter=new ZQ,this._routes={},this._types={Prefix:"",Scoped:!1,Singleton:{},Definitions:{},Metadata:{}},this._ephemeral={},this._volatile={},this.singleton={decorator:{},store:{},derive:{},resolve:{}},this.definitions={type:{},error:{}},this.extender={macros:[]},this.validator=null,this.event={start:[],request:[],parse:[],transform:[],beforeHandle:[],afterHandle:[],mapResponse:[],onResponse:[],trace:[],error:[],stop:[]},this.telemetry={stack:void 0},this.router={http:new TZ,ws:new TZ,dynamic:new TZ,static:{http:{handlers:[],variables:"",map:{},all:""},ws:{}},history:[]},this.inference={event:{body:!1,cookie:!1,headers:!1,queries:[],query:!1,set:!1,unknownQueries:!1},trace:{request:!1,parse:!1,transform:!1,handle:!1,beforeHandle:!1,afterHandle:!1,error:!1,context:!1,store:!1,set:!1}},this.promisedModules=new jU,this.routeTree=new Map,this.handle=async(Z)=>this.fetch(Z),this.fetch=(Z)=>{return(this.fetch=this.config.aot?nW(this):tW(this))(Z)},this.handleError=async(Z,Q)=>(this.handleError=this.config.aot?H7(this):gU(this))(Z,Q),this.outerErrorHandler=(Z)=>new Response(Z.message||Z.name||"Error",{status:Z?.status??500}),this.listen=(Z,Q)=>{if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if(this.compile(),typeof Z==="string"){if(!c6(Z))throw new Error("Port must be a numeric value");Z=parseInt(Z)}const W=this.fetch,Y=typeof Z==="object"?{development:!o6,reusePort:!0,...this.config.serve||{},...Z||{},websocket:{...this.config.websocket||{},...lW||{}},fetch:W,error:this.outerErrorHandler}:{development:!o6,reusePort:!0,...this.config.serve||{},websocket:{...this.config.websocket||{},...lW||{}},port:Z,fetch:W,error:this.outerErrorHandler};this.server=Bun?.serve(Y);for(let J=0;J<this.event.start.length;J++)this.event.start[J].fn(this);if(Q)Q(this.server);return process.on("beforeExit",()=>{if(this.server){this.server.stop(),this.server=null;for(let J=0;J<this.event.stop.length;J++)this.event.stop[J].fn(this)}}),this.promisedModules.then(()=>{Bun?.gc(!1)}),this},this.stop=async()=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");if(this.server){if(this.server.stop(),this.server=null,this.event.stop.length)for(let Z=0;Z<this.event.stop.length;Z++)this.event.stop[Z].fn(this)}},X?.tags)if(!X.detail)X.detail={tags:X.tags};else X.detail.tags=X.tags;if(this.config={forceErrorEncapsulation:!0,prefix:"",aot:!0,strictPath:!1,global:!1,cookie:{},analytic:!1,...X,experimental:X?.experimental??{},seed:X?.seed===void 0?"":X?.seed},X?.analytic&&(X?.name||X?.seed!==void 0))this.telemetry.stack=new Error().stack}get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}get _scoped(){return this.config.scoped}getServer(){return this.server}get routes(){return this.router.history}applyMacro(X){if(this.extender.macros.length){const Z=KU({globalHook:this.event,localHook:X}),Q={events:{global:this.event,local:X},onParse:Z("parse"),onTransform:Z("transform"),onBeforeHandle:Z("beforeHandle"),onAfterHandle:Z("afterHandle"),onResponse:Z("onResponse"),mapResponse:Z("mapResponse"),onError:Z("error")};for(let W of this.extender.macros)U7(W.fn(Q),X)}}add(X,Z,Q,W,{allowMeta:Y=!1,skipPrefix:J=!1}={allowMeta:!1,skipPrefix:!1}){if(W=RU(W),Z!==""&&Z.charCodeAt(0)!==47)Z="/"+Z;if(this.config.prefix&&!J&&!this.config.scoped)Z=this.config.prefix+Z;if(W?.type)switch(W.type){case"text":W.type="text/plain";break;case"json":W.type="application/json";break;case"formdata":W.type="multipart/form-data";break;case"urlencoded":W.type="application/x-www-form-urlencoded";break;case"arrayBuffer":W.type="application/octet-stream";break;default:break}const z=this.definitions.type;let B,M,q,U,O,_;const I=!this.config.aot,b={body:W?.body??this.validator?.body,headers:W?.headers??this.validator?.headers,params:W?.params??this.validator?.params,query:W?.query??this.validator?.query,cookie:W?.cookie??this.validator?.cookie,response:W?.response??this.validator?.response},D=()=>b.cookie?M7({validator:b.cookie,defaultConfig:this.config.cookie,config:b.cookie?.config??{},dynamic:I,models:z}):void 0,F=this.config.normalize,j=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.schema===!0?{body:I8(b.body,{dynamic:I,models:z,normalize:F}),headers:I8(b.headers,{dynamic:I,models:z,additionalProperties:!0}),params:I8(b.params,{dynamic:I,models:z}),query:I8(b.query,{dynamic:I,models:z,normalize:F}),cookie:D(),response:pW(b.response,{dynamic:I,models:z,normalize:F})}:{get body(){if(B)return B;return B=I8(b.body,{dynamic:I,models:z,normalize:F})},get headers(){if(M)return M;return I8(b.headers,{dynamic:I,models:z,additionalProperties:!0})},get params(){if(q)return q;return q=I8(b.params,{dynamic:I,models:z})},get query(){if(U)return U;return U=I8(b.query,{dynamic:I,models:z})},get cookie(){if(O)return O;return O=D()},get response(){if(_)return _;return _=pW(b.response,{dynamic:I,models:z,normalize:F})}},P=Z.endsWith("/")?Z.slice(0,Z.length-1):Z+"/";if(W=V8(W,{},{allowMacro:!0}),W.tags)if(!W.detail)W.detail={tags:W.tags};else W.detail.tags=W.tags;if(z$(this.config.detail))W.detail=x8(Object.assign({},this.config.detail),W.detail);this.applyMacro(W);const f=V8(this.event,W);if(this.config.aot===!1){if(this.router.dynamic.add(X,Z,{validator:j,hooks:f,content:W?.type,handle:Q}),this.config.strictPath===!1)this.router.dynamic.add(X,P,{validator:j,hooks:f,content:W?.type,handle:Q});this.router.history.push({method:X,path:Z,composed:null,handler:Q,hooks:f});return}let x=void 0;const q0=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,_0=yZ(this.inference),M0=q0?vZ({app:this,path:Z,method:X,localHook:V8(W),hooks:f,validator:j,handler:Q,allowMeta:Y,appInference:_0}):(m)=>{if(x)return x(m);return(x=vZ({app:this,path:Z,method:X,localHook:V8(W),hooks:f,validator:j,handler:Q,allowMeta:Y,appInference:_0}))(m)};if(!q0)M0.compose=()=>{return M0.composed=vZ({app:this,path:Z,method:X,localHook:V8(W),hooks:f,validator:j,handler:Q,allowMeta:Y,appInference:_0})};let U0=this.router.history.length;if(this.routeTree.has(X+Z)){if(U0=this.router.history.findIndex((m)=>m.path===Z&&m.method===X),U0!==-1){const m=this.router.history.splice(U0,1)[0];if(m&&this.routeTree.has(m?.method+m?.path))this.routeTree.delete(m.method+m.path)}}this.routeTree.set(X+Z,U0),this.router.history.push({method:X,path:Z,composed:M0,handler:Q,hooks:f});const $0=this.router.static.http;if(X==="$INTERNALWS"){const m=this.config.strictPath?void 0:Z.endsWith("/")?Z.slice(0,Z.length-1):Z+"/";if(Z.indexOf(":")===-1&&Z.indexOf("*")===-1){const k0=$0.handlers.length;if($0.handlers.push(M0),$0.variables+=`const st${k0} = staticRouter.handlers[${k0}]
`,this.router.static.ws[Z]=k0,m)this.router.static.ws[m]=k0}else if(this.router.ws.add("ws",Z,M0),m)this.router.ws.add("ws",m,M0);return}if(Z.indexOf(":")===-1&&Z.indexOf("*")===-1){const m=$0.handlers.length;if($0.handlers.push(M0),$0.variables+=q0?`const st${m} = staticRouter.handlers[${m}]
`:`let st${m} = staticRouter.handlers[${m}]
let stc${m}
`,!$0.map[Z])$0.map[Z]={code:""};if(X==="ALL")$0.map[Z].all=q0?`default: return st${m}(ctx)
`:`default: ${m6(m)}
`;else $0.map[Z].code=q0?`case '${X}': return st${m}(ctx)
${$0.map[Z].code}`:`case '${X}': ${m6(m)}
${$0.map[Z].code}`;if(!this.config.strictPath){if(!$0.map[P])$0.map[P]={code:""};if(X==="ALL")$0.map[P].all=q0?`default: return st${m}(ctx)
`:`default: ${m6(m)}
`;else $0.map[P].code=q0?`case '${X}': return st${m}(ctx)
${$0.map[P].code}`:`case '${X}': ${m6(m)}
${$0.map[P].code}`}}else if(this.router.http.add(X,Z,M0),!this.config.strictPath)this.router.http.add(X,Z.endsWith("/")?Z.slice(0,Z.length-1):Z+"/",M0)}headers(X){if(!X)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=x8(this.setHeaders,X),this}onStart(X){return this.on("start",X),this}onRequest(X){return this.on("request",X),this}onParse(X,Z){if(!Z)return this.on("parse",X);return this.on(X,"parse",Z)}onTransform(X,Z){if(!Z)return this.on("transform",X);return this.on(X,"transform",Z)}resolve(X,Z){if(!Z)Z=X,X={as:"local"};const Q={subType:"resolve",fn:Z};return this.onBeforeHandle(X,Q)}mapResolve(X,Z){if(!Z)Z=X,X={as:"local"};const Q={subType:"resolve",fn:Z};return this.onBeforeHandle(X,Q)}onBeforeHandle(X,Z){if(!Z)return this.on("beforeHandle",X);return this.on(X,"beforeHandle",Z)}onAfterHandle(X,Z){if(!Z)return this.on("afterHandle",X);return this.on(X,"afterHandle",Z)}mapResponse(X,Z){if(!Z)return this.on("mapResponse",X);return this.on(X,"mapResponse",Z)}onResponse(X,Z){if(!Z)return this.on("response",X);return this.on(X,"response",Z)}trace(X,Z){if(!Z)Z=X,X={as:"local"};if(!Array.isArray(Z))Z=[Z];for(let Q of Z)this.reporter.on("event",JU(()=>this.reporter,this.event.trace.length,Q));return this.on(X,"trace",Z),this}error(X,Z){switch(typeof X){case"string":return Z.prototype[i6]=X,this.definitions.error[X]=Z,this;case"function":return this.definitions.error=X(this.definitions.error),this}for(let[Q,W]of Object.entries(X))W.prototype[i6]=Q,this.definitions.error[Q]=W;return this}onError(X,Z){if(!Z)return this.on("error",X);return this.on(X,"error",Z)}onStop(X){return this.on("stop",X),this}on(X,Z,Q){let W;switch(typeof X){case"string":W=X,Q=Z;break;case"object":W=Z;break}if(W==="response")W="onResponse";if(Array.isArray(Q))Q=E8(Q);else if(typeof Q==="function")Q=[{fn:Q}];else Q=[Q];const Y=Q;for(let J of Y)J.scope=typeof X==="string"?"local":X?.as??"local";if(W==="trace")DU(Y.map((J)=>J.fn),this.inference.trace);else Y7({[W]:Y.map((J)=>J.fn)},this.inference.event);for(let J of Y){const z=FU(J,"global",{skipIfHasType:!0});switch(W){case"start":this.event.start.push(z);break;case"request":this.event.request.push(z);break;case"parse":this.event.parse.push(z);break;case"transform":this.event.transform.push(z);break;case"beforeHandle":this.event.beforeHandle.push(z);break;case"afterHandle":this.event.afterHandle.push(z);break;case"mapResponse":this.event.mapResponse.push(z);break;case"onResponse":this.event.onResponse.push(z);break;case"trace":this.event.trace.push(z);break;case"error":this.event.error.push(z);break;case"stop":this.event.stop.push(z);break}}return this}propagate(){const X=(Z)=>{for(let Q of Z)if("scope"in Q&&Q.scope==="local")Q.scope="scoped"};return X(this.event.parse),X(this.event.transform),X(this.event.beforeHandle),X(this.event.afterHandle),X(this.event.mapResponse),X(this.event.onResponse),X(this.event.trace),X(this.event.error),this}group(X,Z,Q){const W=new $({...this.config,prefix:""});W.singleton={...this.singleton},W.definitions={...this.definitions},W.getServer=()=>this.server,W.inference=yZ(this.inference);const Y=typeof Z==="object",J=(Y?Q:Z)(W);if(this.singleton=x8(this.singleton,W.singleton),this.definitions=x8(this.definitions,W.definitions),J.event.request.length)this.event.request=[...this.event.request||[],...J.event.request||[]];if(J.event.onResponse.length)this.event.onResponse=[...this.event.onResponse||[],...J.event.onResponse||[]];return this.model(J.definitions.type),Object.values(W.router.history).forEach(({method:z,path:B,handler:M,hooks:q})=>{if(B=(Y?"":this.config.prefix)+X+B,Y){const U=Z,O=q;this.add(z,B,M,V8(U,{...O||{},error:!O.error?J.event.error:Array.isArray(O.error)?[...O.error||{},...J.event.error||{}]:[O.error,...J.event.error||{}]}))}else this.add(z,B,M,V8(q,{error:J.event.error}),{skipPrefix:!0})}),this}guard(X,Z){if(!Z){if(typeof X==="object"){if(this.applyMacro(X),this.event=fZ(this.event,X),this.validator={body:X.body??this.validator?.body,headers:X.headers??this.validator?.headers,params:X.params??this.validator?.params,query:X.query??this.validator?.query,response:X.response??this.validator?.response,cookie:X.cookie??this.validator?.cookie},X.detail)if(this.config.detail)this.config.detail=x8(Object.assign({},this.config.detail),X.detail);else this.config.detail=X.detail;if(X?.tags)if(!this.config.detail)this.config.detail={tags:X.tags};else this.config.detail.tags=X.tags;return this}return this.guard({},X)}const Q=new $({...this.config,prefix:""});Q.singleton={...this.singleton},Q.definitions={...this.definitions},Q.inference=yZ(this.inference);const W=Z(Q);if(this.singleton=x8(this.singleton,Q.singleton),this.definitions=x8(this.definitions,Q.definitions),W.getServer=()=>this.server,W.event.request.length)this.event.request=[...this.event.request||[],...W.event.request||[]];if(W.event.onResponse.length)this.event.onResponse=[...this.event.onResponse||[],...W.event.onResponse||[]];return this.model(W.definitions.type),Object.values(Q.router.history).forEach(({method:Y,path:J,handler:z,hooks:B})=>{this.add(Y,J,z,V8(X,{...B||{},error:!B.error?W.event.error:Array.isArray(B.error)?[...B.error||{},...W.event.error||[]]:[B.error,...W.event.error||[]]},{allowMacro:!0}))}),this}use(X,Z){if(Z?.scoped)return this.guard({},(Q)=>Q.use(X));if(Array.isArray(X)){let Q=this;for(let W of X)Q=this.use(W);return Q}if(X instanceof Promise)return this.promisedModules.add(X.then((Q)=>{if(typeof Q==="function")return Q(this);if(Q instanceof $)return this._use(Q);if(typeof Q.default==="function")return Q.default(this);if(Q.default instanceof $)return this._use(Q.default);throw new Error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.')}).then((Q)=>Q.compile())),this;return this._use(X)}_use(X){if(typeof X==="function"){const Y=X(this);if(Y instanceof Promise)return this.promisedModules.add(Y.then((J)=>{if(J instanceof $){this.compile();for(let{method:z,path:B,handler:M,hooks:q}of Object.values(J.router.history))this.add(z,B,M,V8(q,{error:J.event.error}));return J}if(typeof J==="function")return J(this);if(typeof J.default==="function")return J.default(this);return this._use(J)}).then((J)=>J.compile())),this;return Y}if(X.promisedModules.size)return this.promisedModules.add(X.modules.then(()=>this._use(X)).then((Y)=>Y.compile())),this;const{name:Z,seed:Q}=X.config;X.getServer=()=>this.getServer(),X.model(this.definitions.type),X.error(this.definitions.error);const W=X.config.scoped;if(W){if(Z){if(!(Z in this.dependencies))this.dependencies[Z]=[];const J=Q!==void 0?v6(Z+JSON.stringify(Q)):0;if(this.dependencies[Z].some(({checksum:z})=>J===z))return this;this.dependencies[Z].push(!this.config?.analytic?{name:X.config.name,seed:X.config.seed,checksum:J,dependencies:X.dependencies}:{name:X.config.name,seed:X.config.seed,checksum:J,dependencies:X.dependencies,stack:X.telemetry.stack,routes:X.router.history,decorators:X.singleton.decorator,store:X.singleton.store,type:X.definitions.type,error:X.definitions.error,derive:X.event.transform.filter((z)=>z.subType==="derive").map((z)=>({fn:z.fn.toString(),stack:new Error().stack??""})),resolve:X.event.transform.filter((z)=>z.subType==="derive").map((z)=>({fn:z.fn.toString(),stack:new Error().stack??""}))})}X.extender.macros=this.extender.macros.concat(X.extender.macros);const Y=[];for(let J=0;J<X.extender.macros.length;J++){const z=this.extender.macros[J];if(Y.includes(z.checksum))X.extender.macros.splice(J,1),J--;Y.push(z.checksum)}if(X.onRequest((J)=>{Object.assign(J,this.singleton.decorator),Object.assign(J.store,this.singleton.store)}),X.event.trace.length)X.event.trace.push(...X.event.trace);if(!X.config.prefix)console.warn("It's recommended to use scoped instance with a prefix to prevent collision routing with other instance.");if(X.event.error.length)X.event.error.push(...this.event.error);if(X.config.aot)X.compile();if(W===!0&&X.config.prefix){this.mount(X.config.prefix+"/",X.fetch);for(let J of X.router.history)this.routeTree.set(J.method+`${X.config.prefix}${J.path}`,this.router.history.length),this.router.history.push({...J,path:`${X.config.prefix}${J.path}`,hooks:V8(J.hooks,{error:this.event.error})})}else{this.mount(X.fetch);for(let J of X.router.history)this.routeTree.set(J.method+`${X.config.prefix}${J.path}`,this.router.history.length),this.router.history.push({...J,path:`${X.config.prefix}${J.path}`,hooks:V8(J.hooks,{error:this.event.error})})}return this}else{this.headers(X.setHeaders),X.reporter=this.reporter;for(let J of X.event.trace)if(J.scope&&J.scope!=="local")this.trace(J);if(Z){if(!(Z in this.dependencies))this.dependencies[Z]=[];const J=Q!==void 0?v6(Z+JSON.stringify(Q)):0;if(!this.dependencies[Z].some(({checksum:z})=>J===z))this.extender.macros=this.extender.macros.concat(X.extender.macros)}else this.extender.macros=this.extender.macros.concat(X.extender.macros);const Y=[];for(let J=0;J<this.extender.macros.length;J++){const z=this.extender.macros[J];if(z.checksum){if(Y.includes(z.checksum))this.extender.macros.splice(J,1),J--;Y.push(z.checksum)}}this.inference={event:{body:this.inference.event.body||X.inference.event.body,cookie:this.inference.event.cookie||X.inference.event.cookie,headers:this.inference.event.headers||X.inference.event.headers,queries:[...this.inference.event.queries,...X.inference.event.queries],query:this.inference.event.query||X.inference.event.query,set:this.inference.event.set||X.inference.event.set,unknownQueries:this.inference.event.unknownQueries||X.inference.event.unknownQueries},trace:{request:this.inference.trace.request||X.inference.trace.request,parse:this.inference.trace.parse||X.inference.trace.parse,transform:this.inference.trace.transform||X.inference.trace.transform,handle:this.inference.trace.handle||X.inference.trace.handle,beforeHandle:this.inference.trace.beforeHandle||X.inference.trace.beforeHandle,afterHandle:this.inference.trace.afterHandle||X.inference.trace.afterHandle,error:this.inference.trace.error||X.inference.trace.error,context:this.inference.trace.context||X.inference.trace.context,store:this.inference.trace.store||X.inference.trace.store,set:this.inference.trace.set||X.inference.trace.set}}}this.decorate(X.singleton.decorator),this.state(X.singleton.store),this.model(X.definitions.type),this.error(X.definitions.error);for(let{method:Y,path:J,handler:z,hooks:B}of Object.values(X.router.history))this.add(Y,J,z,V8(B,{error:X.event.error}));if(!W)if(Z){if(!(Z in this.dependencies))this.dependencies[Z]=[];const Y=Q!==void 0?v6(Z+JSON.stringify(Q)):0;if(this.dependencies[Z].some(({checksum:J})=>Y===J))return this;this.dependencies[Z].push(!this.config?.analytic?{name:X.config.name,seed:X.config.seed,checksum:Y,dependencies:X.dependencies}:{name:X.config.name,seed:X.config.seed,checksum:Y,dependencies:X.dependencies,stack:X.telemetry.stack,routes:X.router.history,decorators:X.singleton,store:X.singleton.store,type:X.definitions.type,error:X.definitions.error,derive:X.event.transform.filter((J)=>J?.subType==="derive").map((J)=>({fn:J.toString(),stack:new Error().stack??""})),resolve:X.event.transform.filter((J)=>J?.subType==="resolve").map((J)=>({fn:J.toString(),stack:new Error().stack??""}))}),this.event=fZ(this.event,mW(X.event),Y)}else this.event=fZ(this.event,mW(X.event));return this}macro(X){const Z={checksum:v6(JSON.stringify({name:this.config.name,seed:this.config.seed,content:X.toString()})),fn:X};return this.extender.macros.push(Z),this}mount(X,Z){if(X instanceof $||typeof X==="function"||X.length===0||X==="/"){const Y=typeof X==="function"?X:X instanceof $?X.compile().fetch:Z instanceof $?Z.compile().fetch:Z,J=async({request:z,path:B})=>Y(new Request(vW(z.url,B||"/"),z));return this.all("/*",J,{type:"none"}),this}const Q=X.length;if(Z instanceof $)Z=Z.compile().fetch;const W=async({request:Y,path:J})=>Z(new Request(vW(Y.url,J.slice(Q)||"/"),Y));return this.all(X,W,{type:"none"}),this.all(X+(X.endsWith("/")?"*":"/*"),W,{type:"none"}),this}get(X,Z,Q){return this.add("GET",X,Z,Q),this}post(X,Z,Q){return this.add("POST",X,Z,Q),this}put(X,Z,Q){return this.add("PUT",X,Z,Q),this}patch(X,Z,Q){return this.add("PATCH",X,Z,Q),this}delete(X,Z,Q){return this.add("DELETE",X,Z,Q),this}options(X,Z,Q){return this.add("OPTIONS",X,Z,Q),this}all(X,Z,Q){return this.add("ALL",X,Z,Q),this}head(X,Z,Q){return this.add("HEAD",X,Z,Q),this}connect(X,Z,Q){return this.add("CONNECT",X,Z,Q),this}route(X,Z,Q,W){return this.add(X.toUpperCase(),Z,Q,W,W?.config),this}ws(X,Z){const Q=Z.transformMessage?Array.isArray(Z.transformMessage)?Z.transformMessage:[Z.transformMessage]:void 0;let W=null;const Y=I8(Z?.body,{models:this.definitions.type,normalize:this.config.normalize}),J=I8(Z?.response,{models:this.definitions.type,normalize:this.config.normalize}),z=(B)=>{if(typeof B==="string"){const M=B?.charCodeAt(0);if(M===47||M===123)try{B=JSON.parse(B)}catch{}else if(c6(B))B=+B}if(Q?.length)for(let M=0;M<Q.length;M++){const q=Q[M](B);if(q!==void 0)B=q}return B};return this.route("$INTERNALWS",X,(B)=>{const{set:M,path:q,qi:U,headers:O,query:_,params:I}=B;if(W===null)W=this.getServer();if(W?.upgrade(B.request,{headers:typeof Z.upgrade==="function"?Z.upgrade(B):Z.upgrade,data:{validator:J,open(b){Z.open?.(new p6(b,B))},message:(b,D)=>{const F=z(D);if(Y?.Check(F)===!1)return void b.send(new m0("message",Y,F).message);Z.message?.(new p6(b,B),F)},drain(b){Z.drain?.(new p6(b,B))},close(b,D,F){Z.close?.(new p6(b,B),D,F)}}}))return;return M.status=400,"Expected a websocket connection"},{beforeHandle:Z.beforeHandle,transform:Z.transform,headers:Z.headers,params:Z.params,query:Z.query}),this}state(X,Z){switch(typeof X){case"object":return this.singleton.store=x8(this.singleton.store,X),this;case"function":return this.singleton.store=X(this.singleton.store),this}if(!(X in this.singleton.store))this.singleton.store[X]=Z;return this}decorate(X,Z){switch(typeof X){case"object":return this.singleton.decorator=x8(this.singleton.decorator,X),this;case"function":return this.singleton.decorator=X(this.singleton.decorator),this}if(!(X in this.singleton.decorator))this.singleton.decorator[X]=Z;return this}derive(X,Z){if(!Z)Z=X,X={as:"local"};const Q={subType:"derive",fn:Z};return this.onTransform(X,Q)}model(X,Z){switch(typeof X){case"object":return Object.entries(X).forEach(([Q,W])=>{if(!(Q in this.definitions.type))this.definitions.type[Q]=W}),this;case"function":return this.definitions.type=X(this.definitions.type),this}return this.definitions.type[X]=Z,this}mapDerive(X,Z){if(!Z)Z=X,X={as:"local"};const Q={subType:"derive",fn:Z};return this.onTransform(X,Q)}affix(X,Z,Q){if(Q==="")return this;const W=["_","-"," "],Y=(M)=>M[0].toUpperCase()+M.slice(1),J=X==="prefix"?(M,q)=>W.includes(M.at(-1)??"")?M+q:M+Y(q):W.includes(Q.at(-1)??"")?(M,q)=>q+M:(M,q)=>q+Y(M),z=(M)=>{const q={};switch(M){case"decorator":for(let U in this.singleton.decorator)q[J(Q,U)]=this.singleton.decorator[U];this.singleton.decorator=q;break;case"state":for(let U in this.singleton.store)q[J(Q,U)]=this.singleton.store[U];this.singleton.store=q;break;case"model":for(let U in this.definitions.type)q[J(Q,U)]=this.definitions.type[U];this.definitions.type=q;break;case"error":for(let U in this.definitions.error)q[J(Q,U)]=this.definitions.error[U];this.definitions.error=q;break}},B=Array.isArray(Z)?Z:[Z];for(let M of B.some((q)=>q==="all")?["decorator","state","model","error"]:B)z(M);return this}prefix(X,Z){return this.affix("prefix",X,Z)}suffix(X,Z){return this.affix("suffix",X,Z)}compile(){if(this.fetch=this.config.aot?nW(this):tW(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}get modules(){return Promise.all(this.promisedModules.promises)}};var j$={};y8(j$,{isTagHtml:()=>{{return L1}},isHtml:()=>{{return r$}},html:()=>{{return $X}},createElement:()=>{{return e6}},Suspense:()=>{{return E7}},Html:()=>{{return g7.Html}},ErrorBoundary:()=>{{return T7}}});var C7={};y8(C7,{createElement:()=>{{return e6}}});var R7=G$(O1(),1),e6=($,X,...Z)=>{const{$elysia:Q,...W}=X??{};return R7.createElement($,W,...Z)};var x7={};y8(x7,{html:()=>{{return $X}}});import{Readable as UG} from"stream";var zG=function($){if(!SUSPENSE_ROOT.enabled)throw new Error("Cannot use Suspense outside of a `renderToStream` call.");if(!$.rid)throw new Error("Suspense requires a `rid` to be specified.");const X=b7([$.fallback]);if(!$.children)return"";const Z=b7([$.children]);if(typeof Z==="string")return Z;let Q=SUSPENSE_ROOT.requests.get($.rid);if(!Q)throw new Error("Request data was deleted before all suspense components were resolved.");const W=++Q.running;if(Z.then(Y).catch(function J(z){if(!$.catch)throw z;let B;if(typeof $.catch==="function")B=$.catch(z);else B=$.catch;if(typeof B==="string")return Y(B);return B.then(Y)}).catch(function J(z){if(Q){const B=Q.stream.deref();if(B&&B.emit("error",z))return}console.error(z)}).finally(function J(){if(Q=SUSPENSE_ROOT.requests.get($.rid),!Q)return;if(Q.running>1)Q.running-=1;else{const z=Q.stream.deref();if(z&&!z.closed)z.end();SUSPENSE_ROOT.requests.delete($.rid)}}),typeof X==="string")return'<div id="B:'+W+'" data-sf>'+X+"</div>";return X.then(function J(z){return'<div id="B:'+W+'" data-sf>'+z+"</div>"});function Y(J){if(Q=SUSPENSE_ROOT.requests.get($.rid),!Q)return;const z=Q.stream.deref();if(!z||z.closed)return;if(SUSPENSE_ROOT.autoScript&&Q.sent===!1)z.write(JG),Q.sent=!0;z.write('<template id="N:'+W+'" data-sr>'+J+'</template><script id="S:'+W+'" data-ss>$KITA_RC('+W+")</script>")}},BG=function($,X,Z){if(typeof $==="string"){X.write($);const Q=SUSPENSE_ROOT.requests.get(Z);if(!Q||Q.running===0)X.end(),SUSPENSE_ROOT.requests.delete(Z);return}$.then(function Q(W){X.write(W)}).catch(function Q(W){if(X.emit("error",W)===!1)console.error(W)}).finally(function Q(){const W=SUSPENSE_ROOT.requests.get(Z);if(!W||W.running===0)X.end(),SUSPENSE_ROOT.requests.delete(Z)})},qG=function($,X){if(SUSPENSE_ROOT.enabled===!1)SUSPENSE_ROOT.enabled=!0;if(!X)X=SUSPENSE_ROOT.requestCounter++;else if(SUSPENSE_ROOT.requests.has(X))throw new Error(`The provided Request Id is already in use: ${X}.`);const Z=new YG;SUSPENSE_ROOT.requests.set(X,{stream:new WeakRef(Z),running:0,sent:!1});try{const Q=$(X);return BG(Q,Z,X),Z}catch(Q){throw Z.end(),SUSPENSE_ROOT.requests.delete(X),Q}};var{contentsToString:b7}=O1(),{PassThrough:YG,Writable:pE}=import.meta.require("stream");if(!globalThis.SUSPENSE_ROOT)globalThis.SUSPENSE_ROOT={requests:new Map,requestCounter:1,enabled:!1,autoScript:!0};var JG=`
      <script id="kita-html-suspense">
        /*! Apache-2.0 https://kita.js.org */
        function \$KITA_RC(i){
          // simple aliases
          var d=document,q=d.querySelector.bind(d),
            // div sent as the fallback wrapper
            v=q('div[id="B:'+i+'"][data-sf]'),
            // template and script sent after promise finishes
            t=q('template[id="N:'+i+'"][data-sr]'),s=q('script[id="S:'+i+'"][data-ss]'),
            // fragment created to avoid inserting element one by one
            f=d.createDocumentFragment(),
            // used by iterators
            c,j,
            // all pending hydrations
            r;

          // if div or template is not found, let this hydration as pending
          if(t&&v&&s){
            // appends into the fragment
            while(c=t.content.firstChild)
              f.appendChild(c);

            // replaces the div and removes the script and template
            v.parentNode.replaceChild(f,v);
            t.remove();
            s.remove();

            // looks for pending templates
            r=d.querySelectorAll('template[id][data-sr]');

            do{
              // resets j from previous loop
              j=0;

              // loops over every found pending template and 
              for(c=0;c<r.length;c++)
                if(r[c]!=t)
                  // let j as true while at least on \$KITA_RC call returns true
                  j=\$KITA_RC(r[c].id.slice(2))?!0:j;
            }while(j)

            // we know at least the original template was substituted
            return!0;
          }
        }
      </script>
    `.replace(/^\s*\/\/.*/gm,"").replace(/\n\s*/g,"");var E7=zG;var nZ=qG;import{Readable as MG} from"stream";var I7={};y8(I7,{isTagHtml:()=>{{return L1}},isHtml:()=>{{return r$}}});function r$($){if(typeof $!=="string")return!1;$=$.trim();const X=$.length;return X>=7&&$[0]==="<"&&$[X-1]===">"}function L1($){return $.trimStart().slice(0,5).startsWith("<html")}function D6($,X,Z){if($ instanceof Promise)return $.then((W)=>D6(W,X,Z));if(typeof $==="string"){if(X.autoDoctype&&r$($)&&L1($))$="<!doctype html>"+$;return new Response($,Z?void 0:{headers:{"content-type":X.contentType}})}let Q=MG.toWeb($);if(X.autoDoctype){let W=!0;Q=Q.pipeThrough(new TransformStream({transform(Y,J){let z=Y.toString();if(W&&L1(z)&&L1(z))W=!1,z="<!doctype html>"+z;J.enqueue(z)}}))}return new Response(Q,Z?void 0:{headers:{"content-type":X.contentType}})}function $X($={}){$.contentType??="text/html; charset=utf8",$.autoDetect??=!0,$.isHtml??=r$,$.autoDoctype??=!0;const X=new N1({name:"@elysiajs/html",seed:$}).derive({as:"global"},({set:Z})=>{return{html(Q){return D6(Q,$,"content-type"in Z.headers)},stream(Q,W){return D6(nZ((Y)=>Q({...W,id:Y})),$,"content-type"in Z.headers)}}});if($.autoDetect)return X.mapResponse({as:"global"},async function Z({response:Q,set:W}){if(r$(Q)||Q instanceof UG&&"rid"in Q){const Y=await D6(Q,$,"content-type"in W.headers);if(Y instanceof Response)return Y;return W.headers["content-type"]=$.contentType,new Response(Y)}return});return X}var GG={};C$(j$,G$(k7(),1));var HG=function($){let X=wG([$.children]);if(typeof X==="string")return X;if($.timeout)X=Promise.race([X,DG($.timeout).then(function Z(){const Q=new Error("Children timed out.");throw Q[AG]=!0,Q})]);return X.catch(function Z(Q){if(typeof $.catch==="function")return $.catch(Q);return $.catch})},{contentsToString:wG}=O1(),{setTimeout:DG}=import.meta.require("timers/promises"),AG=Symbol.for("kHtmlTimeout");var T7=HG;var g7=G$(O1(),1);Html.createElement=e6;var WX=G$(h7(),1);import{readdir as PG,stat as aZ} from"fs/promises";import{resolve as _G,resolve as sZ,join as u7,sep as q$} from"path";import{stat as LG} from"fs/promises";async function ZX($,X,Z){if($["cache-control"]&&$["cache-control"].indexOf("no-cache")!==-1)return!1;if("if-none-match"in $){const Q=$["if-none-match"];if(Q==="*")return!0;if(Q===null)return!1;if(typeof X!=="string")return!1;if(Q===X)return!0;return!1}if($["if-modified-since"]){const Q=$["if-modified-since"];let W;try{W=(await LG(Z)).mtime}catch{}if(W!==void 0&&W.getTime()<=Date.parse(Q))return!0}return!1}async function tZ($){const X=new Bun.CryptoHasher("md5");return X.update(await $.arrayBuffer()),X.digest("base64")}var QX="/",FG=($)=>aZ($).then(()=>!0,()=>!1),c7=new WX.default({useClones:!1,checkperiod:300,stdTTL:10800,maxKeys:250}),i7=new WX.default({useClones:!1,checkperiod:300,stdTTL:10800,maxKeys:250}),rZ=new WX.default({useClones:!1,checkperiod:300,stdTTL:10800,maxKeys:250}),o7=async($)=>{const X=await PG($);return(await Promise.all(X.map(async(Q)=>{const W=$+q$+Q,Y=await aZ(W);return Y&&Y.isDirectory()?await o7(W):[_G($,W)]}))).flat()},l7=async({assets:$="public",prefix:X="/public",staticLimit:Z=1024,alwaysStatic:Q=!1,ignorePatterns:W=[".DS_Store",".git",".env"],noExtension:Y=!1,enableDecodeURI:J=!1,resolve:z=sZ,headers:B={},noCache:M=!1,maxAge:q=86400,directive:U="public",indexHTML:O=!0}={assets:"public",prefix:"/public",staticLimit:1024,alwaysStatic:!1,ignorePatterns:[],noExtension:!1,enableDecodeURI:!1,resolve:sZ,headers:{},noCache:!1,indexHTML:!0})=>{const _=await o7(sZ($)),I=q$!==QX;if(X===QX)X="";const b=(F)=>{if(!W.length)return!1;return W.find((j)=>{if(typeof j==="string")return j.includes(F);else return j.test(F)})},D=new N1({name:"static",seed:{assets:$,prefix:X,staticLimit:Z,alwaysStatic:Q,ignorePatterns:W,noExtension:Y,enableDecodeURI:J,resolve:z.toString(),headers:B,noCache:M,maxAge:q,directive:U,indexHTML:O}});if(Q||process.env.ENV==="production"&&_.length<=Z)for(let F=0;F<_.length;F++){const j=_[F];if(!j||b(j))continue;let P=j.replace(z(),"").replace(`${$}${q$}`,"");if(Y){const _0=P.split(".");_0.splice(-1),P=_0.join(".")}const f=Bun.file(j),x=await tZ(f),q0=I?X+P.split(q$).join(QX):u7(X,P);if(D.get(q0,M?new Response(f,{headers:B}):async({headers:_0})=>{if(await ZX(_0,x,j))return new Response(null,{status:304,headers:B});if(B.Etag=x,B["Cache-Control"]=U,q!==null)B["Cache-Control"]+=`, max-age=${q}`;return new Response(f,{headers:B})}),O&&q0.endsWith("/index.html"))D.get(u7(X,q0.replace("/index.html","")),M?new Response(f,{headers:B}):async({headers:_0})=>{if(await ZX(_0,x,q0))return new Response(null,{status:304,headers:B});if(B.Etag=x,B["Cache-Control"]=U,q!==null)B["Cache-Control"]+=`, max-age=${q}`;return new Response(f,{headers:B})})}else if(!D.router.history.find(({method:F,path:j})=>j===`${X}/*`&&F==="GET"))D.onError(()=>{}).get(`${X}/*`,async({params:F,headers:j})=>{let P=J?decodeURI(`${$}/${decodeURI(F["*"])}`):`${$}/${F["*"]}`;if(I)P=P.replace(QX,q$);if(b(P))throw new s$;try{let f=c7.get(P);if(!f)f=await aZ(P),c7.set(P,f);let x=i7.get(P);if(!x){if(f.isDirectory()){let _0=!1;if(O&&(_0=rZ.get(`${P}${q$}index.html`)??await FG(`${P}${q$}index.html`))){if(_0===void 0)rZ.set(`${P}${q$}index.html`,!0);x=Bun.file(`${P}${q$}index.html`)}else{if(O&&_0===void 0)rZ.set(`${P}${q$}index.html`,!1);throw new s$}}x??=Bun.file(P),i7.set(P,x)}if(M)return new Response(x,{headers:B});const q0=await tZ(x);if(await ZX(j,q0,P))return new Response(null,{status:304,headers:B});if(B.Etag=q0,B["Cache-Control"]=U,q!==null)B["Cache-Control"]+=`, max-age=${q}`;return new Response(x,{headers:B})}catch(f){throw new s$}});return D};import{readdir as SG} from"fs/promises";import KG from"path";var jG=function($){return{fileName:$["File Name"],createDate:$["Create Date"],createSecondsEpoc:$["Create Seconds Epoch"],trigger:$.Trigger,subjectDistance:$["Subject Distance"],exposureTime:$["Exposure Time"],ISO:$.ISO}};async function RG($){const Z=await Bun.file($).json(),Q=jG(Z);return Q.fileName=$.replace(".json",".jpg"),Q}async function t7($){const X=await SG($,{recursive:!0}),Z=await Promise.all(X.filter((Q)=>Q.endsWith(".json")).map((Q)=>KG.join($,Q)).map((Q)=>RG(Q)));return Z.sort((Q,W)=>W.createSecondsEpoc-Q.createSecondsEpoc),Z}var n7=($)=>{return $.reduce((X,Z)=>{const[Q]=Z.createDate.split(" ");if(!X[Q])X[Q]=[];return X[Q].push(Z),X},{})};var e$="static";console.log(e$);var CG=({children:$})=>Html.createElement("html",{lang:"en"},Html.createElement("head",null,Html.createElement("meta",{charset:"utf-8"}),Html.createElement("meta",{name:"color-scheme",content:"light dark"}),Html.createElement("link",{rel:"stylesheet",href:`${e$}/css/pico.slate.min.css`}),Html.createElement("link",{rel:"stylesheet",href:`${e$}/css/main.css`}),Html.createElement("title",null,"Hello World")),Html.createElement("body",null,Html.createElement("header",null,Html.createElement(bG,null)),Html.createElement("main",{class:"container"},$))),bG=()=>Html.createElement("nav",{class:"container-fluid"},Html.createElement("ul",null,Html.createElement("li",null,Html.createElement("strong",null,"Drone Corp"))),Html.createElement("ul",null,Html.createElement("li",null,Html.createElement("a",{href:"#",class:"contrast"},"About")),Html.createElement("li",null,Html.createElement("a",{href:"#",class:"contrast"},"Services")),Html.createElement("li",null,Html.createElement("a",{href:"/",class:"contrast"},"Photos")))),VG=({config:$})=>{const[X,Z]=$.createDate.split(" ");return Html.createElement(Html.Fragment,null,Html.createElement("table",null,Html.createElement("tr",null,Html.createElement("td",null,"Date"),Html.createElement("td",null,X)),Html.createElement("tr",null,Html.createElement("td",null,"Time"),Html.createElement("td",null,Z)),Html.createElement("tr",null,Html.createElement("td",null,"Time since epoch"),Html.createElement("td",null,$.createSecondsEpoc)),Html.createElement("tr",null,Html.createElement("td",null,"Exposure time"),Html.createElement("td",null,$.exposureTime)),Html.createElement("tr",null,Html.createElement("td",null,"Distance to subject"),Html.createElement("td",null,$.subjectDistance)),Html.createElement("tr",null,Html.createElement("td",null,"ISO"),Html.createElement("td",null,$.ISO)),Html.createElement("tr",null,Html.createElement("td",null,"Trigger method"),Html.createElement("td",null,$.trigger))))},EG=({config:$})=>{return Html.createElement(Html.Fragment,null,Html.createElement("img",{src:$.fileName,onclick:"this.nextElementSibling.showModal()"}),Html.createElement("dialog",null,Html.createElement("article",null,Html.createElement("header",null,Html.createElement("button",{"aria-label":"Close",rel:"prev",onclick:"this.closest('dialog').close()"}),Html.createElement("p",null,Html.createElement("strong",null,"Picture"))),Html.createElement(VG,{config:$}))))};new N1().use(l7({assets:e$,prefix:`/${e$}`})).use($X()).get("/favicon.ico",()=>Bun.file(`${e$}/favicon.ico`)).get("/",async()=>{const $=await t7(`${e$}/photos/`),X=n7($);return Html.createElement(CG,null,Object.entries(X).map(([Z,Q])=>Html.createElement("hgroup",null,Html.createElement("h2",null,Z),Html.createElement("div",{class:"grid-fluid"},Q.map((W)=>Html.createElement(Html.Fragment,null,Html.createElement(EG,{config:W})))))))}).listen(3000);export{e$ as staticAssetsFolder,VG as PhotoConfigTable,EG as Photo,bG as Navbar,CG as BaseHtml};
